"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3235],{93235:(yn,Wt,Q)=>{Q.d(Wt,{A:()=>Or,D:()=>qs,L:()=>U,T:()=>Ms,W:()=>Ye,a:()=>Yr,b:()=>dr,c:()=>pr,d:()=>to,e:()=>Qi,f:()=>hr,g:()=>Er,u:()=>qn});var p=Q(2784),Se=Q(64279),ue=Q(60885),L=Q(12053),G=Q(95544),ke=Q(79692),Ie=Q(60905),xt=Q(90436),ht=Q(4614),wt=Q(97136),Je=Q(27556),vt=Q(77277),et=Q(91256),gt=Q(37390),hi=Q(58987),li=Q(89571),ge=Q(15584),ot=Q(97485),Jt=Q(82113),pi=Q(27616),Oi=Q(8284),At=Q(70660),si=Q(94339),Ut=Q(11776),ii=Q(12231),ct=Q(86136),St=Q(49378),Dt=Q(80030),Mi=Q(61837),mi=Q(85256),wi=Q(72779),Ue=Q.n(wi),Tt=Q(38016),Ve=Q(84905),oe=Q(30705),Te=Q(30204),ve=Q(49558),tt=Q(7089),Me=Q(89883),it=Q(64304),Ot=Q(47603),ci=Q(56881),Et=Q(26228),Lt=Q(75951),Nt=Q.n(Lt),Pt=Q(34520),gi=Q(25417),Vi=Q(24579),Xi=Q(82726),re=Q(12420),b=Q(87685),D=Q(49423),I=Q(96401),N=Q(77120),Z=Q(42123),_=Q(65329),ce=Q(78887),ye=function(V){return(V+1)%Number.MAX_SAFE_INTEGER};function We(){var V=(0,ce.F)(0),H=V[1];return(0,p.useCallback)(function(){H(ye)},[])}var Ee=Q(51967),Xe=Q(77246),qe=Q(29862),ft=Q(16303),Qt=function(V,H,Y){if(Y||arguments.length===2)for(var te=0,he=H.length,me;te<he;te++)(me||!(te in H))&&(me||(me=Array.prototype.slice.call(H,0,te)),me[te]=H[te]);return V.concat(me||Array.prototype.slice.call(H))};function kt(V){for(var H=[],Y=1;Y<arguments.length;Y++)H[Y-1]=arguments[Y];var te=(0,qe.t)(),he=(0,Xe.x)(H[1]),me=(0,p.useMemo)(function(){return function(){for(var xe=[],Le=0;Le<arguments.length;Le++)xe[Le]=arguments[Le];te()&&(typeof he.current=="function"?he.current.apply(this,xe):typeof he.current.handleEvent=="function"&&he.current.handleEvent.apply(this,xe))}},[]);(0,p.useEffect)(function(){var xe=V&&(0,ft.nr)(V,"current")?V.current:V;if(xe){var Le=H.slice(2);return ft.on.apply(void 0,Qt([xe,H[0],me],Le,!1)),function(){return ft.S1.apply(void 0,Qt([xe,H[0],me],Le,!1))}}},[V,H[0]])}var Gt=Q(24947),Ht=function(V){return typeof V=="function"?V:typeof V=="string"?function(H){return H.key===V}:V?ft.cI:ft.Vp},_t=Gt.jU?window:null;function Ft(V,H,Y,te){te===void 0&&(te={});var he=te.event,me=he===void 0?"keydown":he,xe=te.target,Le=xe===void 0?_t:xe,$t=te.eventOptions,dt=(0,Xe.x)(H),Ne=(0,p.useMemo)(function(){var we=Ht(V);return function(nt){we(nt)&&dt.current.call(this,nt)}},Y);kt(Le,me,Ne,$t)}function Xt(V){var H=(0,p.useRef)();return(0,p.useEffect)(function(){H.current=V}),H.current}var Ge=Q(2552),jt=Q(10921),je=Q(38402),yt=Q(9520),ut=Q(49166),Rt=Q(98281),rt=Q(22983),st=Q(28113),Vt=Q(6487),Qe=Q(99152),Yt=Q(7896),Pi=Q(96234),Ri=Q(59740),oi=Q(6277),Yi=Q(15459),ei=Q(24514),Si=p.createContext({});const ki=Si;var nn={root:{padding:0,margin:0,listStyle:"none"}};function Ni(V,H){if(V.length!==H.length)return!0;for(var Y=0;Y<V.length;Y+=1)if(V[Y]!==H[Y])return!0;return!1}var Bi=function(H,Y,te){for(var he=Y;he<H.length;he+=1)if(te===H[he])return he;return-1},Fi=[],vn=[],Li=p.forwardRef(function(H,Y){var te=H.children,he=H.classes,me=H.className,xe=H.defaultCollapseIcon,Le=H.defaultEndIcon,$t=H.defaultExpanded,dt=$t===void 0?Fi:$t,Ne=H.defaultExpandIcon,we=H.defaultParentIcon,He=H.defaultSelected,nt=He===void 0?vn:He,pt=H.disableSelection,Mt=pt===void 0?!1:pt,bt=H.multiSelect,ji=bt===void 0?!1:bt,Zi=H.expanded,Ei=H.onNodeSelect,Wi=H.onNodeToggle,rn=H.selected,qt=(0,Ri.Z)(H,["children","classes","className","defaultCollapseIcon","defaultEndIcon","defaultExpanded","defaultExpandIcon","defaultParentIcon","defaultSelected","disableSelection","multiSelect","expanded","onNodeSelect","onNodeToggle","selected"]),pn=p.useState(null),ai=pn[0],vi=pn[1],_i=p.useState(null),kn=_i[0],Tn=_i[1],Ci=p.useRef({}),en=p.useRef({}),Ai=p.useRef([]),ts=(0,ei.Z)({controlled:Zi,default:dt,name:"TreeView",state:"expanded"}),mr=(0,Pi.Z)(ts,2),Cn=mr[0],Rn=mr[1],gr=(0,ei.Z)({controlled:rn,default:nt,name:"TreeView",state:"selected"}),yr=(0,Pi.Z)(gr,2),ni=yr[0],mn=yr[1],hn=p.useCallback(function(Pe){return Array.isArray(Cn)?Cn.indexOf(Pe)!==-1:!1},[Cn]),Qn=p.useCallback(function(Pe){return Array.isArray(ni)?ni.indexOf(Pe)!==-1:ni===Pe},[ni]),vr=function(Ce){return ai===Ce},cn=function(Ce){return kn===Ce},Bn=function(Ce){var Ae=Ai.current.indexOf(Ce);return Ae!==-1&&Ae+1<Ai.current.length?Ai.current[Ae+1]:null},_n=function(Ce){var Ae=Ai.current.indexOf(Ce);return Ae!==-1&&Ae-1>=0?Ai.current[Ae-1]:null},er=function(){return Ai.current[Ai.current.length-1]},Fn=function(){return Ai.current[0]},br=function(Ce){return Ci.current[Ce].parent},fs=function(Ce,Ae){var Fe=Ai.current.indexOf(Ce),lt=Ai.current.indexOf(Ae),It=Math.min(Fe,lt),bi=Math.max(Fe,lt);return Ai.current.slice(It,bi+1)},Mn=function(Ce){Ce&&(vi(Ce),Tn(Ce))},Ki=function(Ce){return Mn(Bn(Ce))},Wn=function(Ce){return Mn(_n(Ce))},Ln=function(){return Mn(Fn())},xr=function(){return Mn(er())},is=function(Ce,Ae){var Fe,lt,It=Ae.toLowerCase(),bi=[],xi=[];Object.keys(en.current).forEach(function(An){var rs=en.current[An],Ls=Ci.current[An],ps=Ls.parent?hn(Ls.parent):!0;ps&&(bi.push(An),xi.push(rs))}),Fe=bi.indexOf(Ce)+1,Fe===Ci.current.length&&(Fe=0),lt=Bi(xi,Fe,It),lt===-1&&(lt=Bi(xi,0,It)),lt>-1&&Mn(bi[lt])},tr=function(Ce){var Ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:kn,Fe;Cn.indexOf(Ae)!==-1?(Fe=Cn.filter(function(lt){return lt!==Ae}),vi(function(lt){var It=Ci.current[lt];return lt&&(It&&It.parent?It.parent.id:null)===Ae?Ae:lt})):Fe=[Ae].concat(Cn),Wi&&Wi(Ce,Fe),Rn(Fe)},Hn=function(Ce,Ae){var Fe=Ci.current[Ae],lt=Ci.current[Fe.parent],It;if(lt)It=lt.children.filter(function(An){return!hn(An)});else{var bi=Ci.current[-1].children;It=bi.filter(function(An){return!hn(An)})}var xi=Cn.concat(It);It.length>0&&(Rn(xi),Wi&&Wi(Ce,xi))},Ji=p.useRef(null),Vn=p.useRef(!1),ze=p.useRef([]),Nr=function(Ce,Ae){var Fe=ni,lt=Ae.start,It=Ae.next,bi=Ae.current;!It||!bi||(ze.current.indexOf(bi)===-1&&(ze.current=[]),Vn.current?ze.current.indexOf(It)!==-1?(Fe=Fe.filter(function(xi){return xi===lt||xi!==bi}),ze.current=ze.current.filter(function(xi){return xi===lt||xi!==bi})):(Fe.push(It),ze.current.push(It)):(Fe.push(It),ze.current.push(bi,It)),Ei&&Ei(Ce,Fe),mn(Fe))},Fr=function(Ce,Ae){var Fe=ni,lt=Ae.start,It=Ae.end;Vn.current&&(Fe=ni.filter(function(An){return ze.current.indexOf(An)===-1}));var bi=fs(lt,It);ze.current=bi;var xi=Fe.concat(bi);xi=xi.filter(function(An,rs){return xi.indexOf(An)===rs}),Ei&&Ei(Ce,xi),mn(xi)},wr=function(Ce,Ae){var Fe=[];ni.indexOf(Ae)!==-1?Fe=ni.filter(function(lt){return lt!==Ae}):Fe=[Ae].concat(ni),Ei&&Ei(Ce,Fe),mn(Fe)},Sr=function(Ce,Ae){var Fe=ji?[Ae]:Ae;Ei&&Ei(Ce,Fe),mn(Fe)},Wr=function(Ce,Ae){var Fe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return Ae?(Fe?wr(Ce,Ae):Sr(Ce,Ae),Ji.current=Ae,Vn.current=!1,ze.current=[],!0):!1},tn=function(Ce,Ae){var Fe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,lt=Ae.start,It=lt===void 0?Ji.current:lt,bi=Ae.end,xi=Ae.current;return Fe?Nr(Ce,{start:It,next:bi,current:xi}):Fr(Ce,{start:It,end:bi}),Vn.current=!0,!0},Oe=function(Ce,Ae){Ji.current||(Ji.current=Ae);var Fe=Vn.current?Ji.current:Ae;return tn(Ce,{start:Fe,end:Fn()})},di=function(Ce,Ae){Ji.current||(Ji.current=Ae);var Fe=Vn.current?Ji.current:Ae;return tn(Ce,{start:Fe,end:er()})},zn=function(Ce,Ae){return tn(Ce,{end:Bn(Ae),current:Ae},!0)},gn=function(Ce,Ae){return tn(Ce,{end:_n(Ae),current:Ae},!0)},Hr=function(Ce){return tn(Ce,{start:Fn(),end:er()})},io=function(Ce,Ae){var Fe=Ci.current[Ce];Ci.current[Ce]=(0,Yt.Z)({},Fe,{children:Ae,id:Ce}),Ae.forEach(function(lt){var It=Ci.current[lt];Ci.current[lt]=(0,Yt.Z)({},It,{parent:Ce,id:lt})})},En=p.useCallback(function(Pe){var Ce=Ci.current[Pe],Ae=[];return Ce&&(Ae.push(Pe),Ce.children&&(Ae.concat(Ce.children),Ce.children.forEach(function(Fe){Ae.concat(En(Fe))}))),Ae},[]),us=p.useCallback(function(Pe){var Ce=(0,Yt.Z)({},en.current);Pe.forEach(function(Ae){Ce[Ae]&&delete Ce[Ae]}),en.current=Ce},[]),no=p.useCallback(function(Pe){var Ce=En(Pe);us(Ce);var Ae=(0,Yt.Z)({},Ci.current);Ce.forEach(function(Fe){var lt=Ae[Fe];if(lt){if(lt.parent){var It=Ae[lt.parent];if(It&&It.children){var bi=It.children.filter(function(xi){return xi!==Fe});Ae[lt.parent]=(0,Yt.Z)({},It,{children:bi})}}delete Ae[Fe]}}),Ci.current=Ae,Tn(function(Fe){return Fe===Pe?null:Fe})},[En,us]),ns=function(Ce,Ae){en.current[Ce]=Ae},Ii=p.useRef([]),$n=p.useState(!1),ds=$n[0],Bs=$n[1];p.useEffect(function(){var Pe=[];p.Children.forEach(te,function(Ce){p.isValidElement(Ce)&&Ce.props.nodeId&&Pe.push(Ce.props.nodeId)}),Ni(Ii.current,Pe)&&(Ci.current[-1]={parent:null,children:Pe},Pe.forEach(function(Ce,Ae){Ae===0&&vi(Ce)}),Ai.current=Ci.current[-1].children,Ii.current=Pe,Bs(!0))},[te]),p.useEffect(function(){var Pe=function Ce(Ae){for(var Fe=[],lt=0;lt<Ae.length;lt+=1){var It=Ae[lt];Fe.push(It);var bi=Ci.current[It].children;hn(It)&&bi&&(Fe=Fe.concat(Ce(bi)))}return Fe};ds&&(Ai.current=Pe(Ci.current[-1].children))},[Cn,ds,hn,te]);var In=function(){return!1};return p.createElement(ki.Provider,{value:{icons:{defaultCollapseIcon:xe,defaultExpandIcon:Ne,defaultParentIcon:we,defaultEndIcon:Le},focus:Mn,focusFirstNode:Ln,focusLastNode:xr,focusNextNode:Ki,focusPreviousNode:Wn,focusByFirstCharacter:is,expandAllSiblings:Hn,toggleExpansion:tr,isExpanded:hn,isFocused:cn,isSelected:Qn,selectNode:Mt?In:Wr,selectRange:Mt?In:tn,selectNextNode:Mt?In:zn,selectPreviousNode:Mt?In:gn,rangeSelectToFirst:Mt?In:Oe,rangeSelectToLast:Mt?In:di,selectAllNodes:Mt?In:Hr,isTabbable:vr,multiSelect:ji,getParent:br,mapFirstChar:ns,addNodeToNodeMap:io,removeNodeFromNodeMap:no}},p.createElement("ul",(0,Yt.Z)({role:"tree","aria-multiselectable":ji,className:(0,oi.default)(he.root,me),ref:Y},qt),te))});const qi=(0,Yi.Z)(nn,{name:"MuiTreeView"})(Li);var fi=Q(51209),fn=Q(41128),lr=Q(60364),Kn=Q(85974),bn=function(H){return{root:{listStyle:"none",margin:0,padding:0,outline:0,WebkitTapHighlightColor:"transparent","&:focus > $content $label":{backgroundColor:H.palette.action.hover},"&$selected > $content $label":{backgroundColor:(0,fn.Fq)(H.palette.primary.main,H.palette.action.selectedOpacity)},"&$selected > $content $label:hover, &$selected:focus > $content $label":{backgroundColor:(0,fn.Fq)(H.palette.primary.main,H.palette.action.selectedOpacity+H.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},expanded:{},selected:{},group:{margin:0,padding:0,marginLeft:17},content:{width:"100%",display:"flex",alignItems:"center",cursor:"pointer"},iconContainer:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},label:{width:"100%",paddingLeft:4,position:"relative","&:hover":{backgroundColor:H.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}}},R=function(H){return H&&H.length===1&&H.match(/\S/)},c=p.forwardRef(function(H,Y){var te=H.children,he=H.classes,me=H.className,xe=H.collapseIcon,Le=H.endIcon,$t=H.expandIcon,dt=H.icon,Ne=H.label,we=H.nodeId,He=H.onClick,nt=H.onLabelClick,pt=H.onIconClick,Mt=H.onFocus,bt=H.onKeyDown,ji=H.onMouseDown,Zi=H.TransitionComponent,Ei=Zi===void 0?Jt.Z:Zi,Wi=H.TransitionProps,rn=(0,Ri.Z)(H,["children","classes","className","collapseIcon","endIcon","expandIcon","icon","label","nodeId","onClick","onLabelClick","onIconClick","onFocus","onKeyDown","onMouseDown","TransitionComponent","TransitionProps"]),qt=p.useContext(ki),pn=qt.icons,ai=qt.focus,vi=qt.focusFirstNode,_i=qt.focusLastNode,kn=qt.focusNextNode,Tn=qt.focusPreviousNode,Ci=qt.focusByFirstCharacter,en=qt.selectNode,Ai=qt.selectRange,ts=qt.selectNextNode,mr=qt.selectPreviousNode,Cn=qt.rangeSelectToFirst,Rn=qt.rangeSelectToLast,gr=qt.selectAllNodes,yr=qt.expandAllSiblings,ni=qt.toggleExpansion,mn=qt.isExpanded,hn=qt.isFocused,Qn=qt.isSelected,vr=qt.isTabbable,cn=qt.multiSelect,Bn=qt.getParent,_n=qt.mapFirstChar,er=qt.addNodeToNodeMap,Fn=qt.removeNodeFromNodeMap,br=p.useRef(null),fs=p.useRef(null),Mn=(0,Kn.Z)(br,Y),Ki=dt,Wn=Boolean(Array.isArray(te)?te.length:te),Ln=mn?mn(we):!1,xr=hn?hn(we):!1,is=vr?vr(we):!1,tr=Qn?Qn(we):!1,Hn=pn||{},Ji=(0,lr.Z)();Ki||(Wn?(Ln?Ki=xe||Hn.defaultCollapseIcon:Ki=$t||Hn.defaultExpandIcon,Ki||(Ki=Hn.defaultParentIcon)):Ki=Le||Hn.defaultEndIcon);var Vn=function(Oe){xr||ai(we);var di=cn&&(Oe.shiftKey||Oe.ctrlKey||Oe.metaKey);Wn&&!Oe.defaultPrevented&&!(di&&mn(we))&&ni(Oe,we),di?Oe.shiftKey?Ai(Oe,{end:we}):en(Oe,we,!0):en(Oe,we),He&&He(Oe)},ze=function(Oe){(Oe.shiftKey||Oe.ctrlKey||Oe.metaKey)&&Oe.preventDefault(),ji&&ji(Oe)},Nr=function(Oe){return Wn&&(Ln?kn(we):ni(Oe)),!0},Fr=function(Oe){if(Ln)return ni(Oe,we),!0;var di=Bn(we);return di?(ai(di),!0):!1},wr=function(Oe){var di=!1,zn=Oe.key;if(!(Oe.altKey||Oe.currentTarget!==Oe.target)){var gn=Oe.ctrlKey||Oe.metaKey;switch(zn){case" ":br.current===Oe.currentTarget&&(cn&&Oe.shiftKey?di=Ai(Oe,{end:we}):cn?di=en(Oe,we,!0):di=en(Oe,we)),Oe.stopPropagation();break;case"Enter":br.current===Oe.currentTarget&&Wn&&(ni(Oe),di=!0),Oe.stopPropagation();break;case"ArrowDown":cn&&Oe.shiftKey&&ts(Oe,we),kn(we),di=!0;break;case"ArrowUp":cn&&Oe.shiftKey&&mr(Oe,we),Tn(we),di=!0;break;case"ArrowRight":Ji.direction==="rtl"?di=Fr(Oe):di=Nr(Oe);break;case"ArrowLeft":Ji.direction==="rtl"?di=Nr(Oe):di=Fr(Oe);break;case"Home":cn&&gn&&Oe.shiftKey&&Cn(Oe,we),vi(),di=!0;break;case"End":cn&&gn&&Oe.shiftKey&&Rn(Oe,we),_i(),di=!0;break;default:zn==="*"?(yr(Oe,we),di=!0):cn&&gn&&zn.toLowerCase()==="a"?di=gr(Oe):!gn&&!Oe.shiftKey&&R(zn)&&(Ci(we,zn),di=!0)}di&&(Oe.preventDefault(),Oe.stopPropagation()),bt&&bt(Oe)}},Sr=function(Oe){!xr&&Oe.currentTarget===Oe.target&&ai(we),Mt&&Mt(Oe)};p.useEffect(function(){if(er){var tn=[];p.Children.forEach(te,function(Oe){p.isValidElement(Oe)&&Oe.props.nodeId&&tn.push(Oe.props.nodeId)}),er(we,tn)}},[te,we,er]),p.useEffect(function(){if(Fn)return function(){Fn(we)}},[we,Fn]),p.useEffect(function(){_n&&Ne&&_n(we,fs.current.textContent.substring(0,1).toLowerCase())},[_n,we,Ne]),p.useEffect(function(){xr&&br.current.focus()},[xr]);var Wr;return cn?Wr=tr:tr&&(Wr=!0),p.createElement("li",(0,Yt.Z)({className:(0,oi.default)(he.root,me,Ln&&he.expanded,tr&&he.selected),role:"treeitem",onKeyDown:wr,onFocus:Sr,"aria-expanded":Wn?Ln:null,"aria-selected":Wr,ref:Mn,tabIndex:is?0:-1},rn),p.createElement("div",{className:he.content,onClick:Vn,onMouseDown:ze,ref:fs},p.createElement("div",{onClick:pt,className:he.iconContainer},Ki),p.createElement(xt.Z,{onClick:nt,component:"div",className:he.label},Ne)),te&&p.createElement(Ei,(0,Yt.Z)({unmountOnExit:!0,className:he.group,in:Ln,component:"ul",role:"group"},Wi),te))});const u=(0,Yi.Z)(bn,{name:"MuiTreeItem"})(c);var v=Q(52160),w=Q(31377),E=Q(34546),M=Q(31625),z=Q(16874),j=Q(19126),ie=Q.n(j),fe=Q(73557),be=Q(70218);const Be=({error:V})=>{const H=(0,p.useRef)("");return(0,p.useEffect)(()=>{H.current=String(Math.random())},[V]),V?p.createElement(G.Z,null,p.createElement(ve.SX,{id:H.current,variant:"warning",message:V.message})):null},De=(0,ke.Z)({svgIcon:{display:"inline-block","& svg":{display:"inline-block",fontSize:"inherit",verticalAlign:"baseline"}}}),Zt=V=>{const{href:H,text:Y,Icon:te,...he}=V,me=De();return p.createElement(Ie.Z,{container:!0,direction:"row",spacing:1},p.createElement(Ie.Z,{item:!0},p.createElement(xt.Z,{component:"div",className:me.svgIcon},te?p.createElement(te,null):p.createElement(v.Z,null))),p.createElement(Ie.Z,{item:!0},p.createElement(ve.rU,{to:H,...he},Y||H)))},ui=({output:V})=>{const{links:H=[]}=V,Y=(0,oe.qD)(),te=(0,oe.tg)(it.wi),he=me=>{var xe;return me&&(xe=Y.getSystemIcon(me))!=null?xe:v.Z};return p.createElement(G.Z,{px:3,pb:3},H.filter(({url:me,entityRef:xe})=>me||xe).map(({url:me,entityRef:xe,title:Le,icon:$t})=>{if(xe){const dt=(0,Pt.of)(xe,{defaultKind:"<unknown>",defaultNamespace:"<unknown>"}),Ne=te(dt);return{title:Le,icon:$t,url:Ne}}return{title:Le,icon:$t,url:me}}).map(({url:me,title:xe,icon:Le},$t)=>p.createElement(Zt,{key:`output-link-${$t}`,href:me,text:xe!=null?xe:me,Icon:he(Le),target:"_blank"})))},yi=(0,ke.Z)(V=>(0,re.Z)({root:{width:"100%"},button:{marginBottom:V.spacing(2),marginLeft:V.spacing(2)},actionsContainer:{marginBottom:V.spacing(2)},resetContainer:{padding:V.spacing(3)},labelWrapper:{display:"flex",flex:1,flexDirection:"row",justifyContent:"space-between"},stepWrapper:{width:"100%"}})),Jn=({step:V})=>{const[H,Y]=(0,p.useState)("");return(0,be.Z)(()=>{if(!V.startedAt){Y("");return}const te=V.endedAt?Et.ou.fromISO(V.endedAt):Et.ou.local(),he=Et.ou.fromISO(V.startedAt),me=Et.Xp.fromDateTimes(he,te).toDuration().valueOf();Y(Nt()(me,{round:!0}))},1e3),p.createElement(xt.Z,{variant:"caption"},H)},xn=(0,ke.Z)(V=>(0,re.Z)({root:{color:V.palette.text.disabled,display:"flex",height:22,alignItems:"center"},completed:{color:V.palette.status.ok},error:{color:V.palette.status.error}}));function ar(V){const H=xn(),{active:Y,completed:te,error:he}=V,me=()=>Y?p.createElement(ht.Z,{size:"24px"}):te?p.createElement(Rt.Z,null):he?p.createElement(ut.Z,null):p.createElement(z.Z,null);return p.createElement("div",{className:Ue()(H.root,{[H.completed]:te,[H.error]:he})},me())}const zt=(0,p.memo)(V=>{const{steps:H,currentStepId:Y,onUserStepChange:te}=V,he=yi(V);return p.createElement("div",{className:he.root},p.createElement(M.Z,{activeStep:H.findIndex(me=>me.id===Y),orientation:"vertical",nonLinear:!0},H.map((me,xe)=>{const Le=me.status==="cancelled",$t=me.status==="processing",dt=me.status==="completed",Ne=me.status==="failed",we=me.status==="skipped";return p.createElement(w.Z,{key:String(xe),expanded:!0},p.createElement(wt.Z,{onClick:()=>te(me.id)},p.createElement(E.Z,{StepIconProps:{completed:dt,error:Ne||Le,active:$t},StepIconComponent:ar,className:he.stepWrapper},p.createElement("div",{className:he.labelWrapper},p.createElement(xt.Z,{variant:"subtitle2"},me.name),we?p.createElement(xt.Z,{variant:"caption"},"Skipped"):p.createElement(Jn,{step:me})))))})))}),Ur=({links:V=[]})=>V.length>0,Er=V=>{const{loadingText:H}=V,Y=yi(),te=(0,fe.s0)(),he=(0,oe.tg)(Me.r),me=(0,Te.u)(ue.s),xe=(0,oe.tg)(Me.o),[Le,$t]=(0,p.useState)(void 0),[dt,Ne]=(0,p.useState)(!1),[we,He]=(0,p.useState)(void 0),{taskId:nt}=(0,oe.Oi)(Me.w),pt=(0,L.WQ)(nt),Mt=pt.completed,bt=pt.cancelled,ji=(0,p.useMemo)(()=>{var ai,vi;return(vi=(ai=pt.task)==null?void 0:ai.spec.steps.map(_i=>{var kn;return{..._i,...(kn=pt==null?void 0:pt.steps)==null?void 0:kn[_i.id]}}))!=null?vi:[]},[pt]);(0,p.useEffect)(()=>{var ai;const vi=ji.find(_i=>["failed","processing"].includes(_i.status));if(Mt&&!vi){He((ai=ji[ji.length-1])==null?void 0:ai.id);return}He(vi==null?void 0:vi.id)},[ji,Mt]);const Zi=Le!=null?Le:we,Ei=(0,p.useMemo)(()=>{if(!Zi)return H||"Loading...";const ai=pt.stepLogs[Zi];return ai!=null&&ai.length?ai.join(`
`):"Waiting for logs..."},[pt.stepLogs,Zi,H]),Wi=pt.completed&&!pt.loading&&!pt.task,{output:rn}=pt,qt=()=>{var ai,vi,_i;if(!pt.task||!((vi=(ai=pt.task)==null?void 0:ai.spec.templateInfo)!=null&&vi.entityRef)){te(he());return}const kn=pt.task.spec.parameters,{name:Tn,namespace:Ci}=(0,Pt.of)((_i=pt.task.spec.templateInfo)==null?void 0:_i.entityRef);te(`${xe({templateName:Tn,namespace:Ci})}?${ie().stringify({formData:JSON.stringify(kn)})}`)},pn=async()=>{Ne(!0),await me.cancelTask(nt)};return p.createElement(ve.T3,{themeId:"home"},p.createElement(ve.h4,{pageTitleOverride:`Task ${nt}`,title:"Task Activity",subtitle:`Activity for task: ${nt}`}),p.createElement(ve.VY,null,Wi?p.createElement(ve.mf,{status:"404",statusMessage:"Task not found",additionalInfo:"No task found with this ID"}):p.createElement("div",null,p.createElement(Ie.Z,{container:!0},p.createElement(Ie.Z,{item:!0,xs:3},p.createElement(Je.Z,null,p.createElement(zt,{steps:ji,currentStepId:Zi,onUserStepChange:$t}),rn&&Ur(rn)&&p.createElement(ui,{output:rn}),p.createElement(vt.Z,{className:Y.button,onClick:qt,disabled:!Mt,variant:"contained",color:"primary"},"Start Over"),p.createElement(vt.Z,{className:Y.button,onClick:pn,disabled:Mt||bt||dt,variant:"outlined",color:"secondary"},(bt||dt)&&!Mt?"Cancelling...":"Cancel"))),p.createElement(Ie.Z,{item:!0,xs:9},!Zi&&p.createElement(ve.Ex,null),p.createElement("div",{style:{height:"80vh"}},p.createElement(Be,{error:pt.error}),p.createElement(ve.nU,{text:Ei})))))))},Dr=(0,ke.Z)(V=>({code:{fontFamily:"Menlo, monospace",padding:V.spacing(1),backgroundColor:V.palette.type==="dark"?V.palette.grey[700]:V.palette.grey[300],display:"inline-block",borderRadius:5,border:`1px solid ${V.palette.grey[500]}`,position:"relative"},codeRequired:{"&::after":{position:"absolute",content:'"*"',top:0,right:V.spacing(.5),fontWeight:"bolder",color:V.palette.error.light}}})),Un=V=>p.createElement(Ie.Z,{container:!0},V.examples.map((H,Y)=>p.createElement(p.Fragment,{key:`example-${Y}`},p.createElement(Ie.Z,{item:!0,lg:3},p.createElement(G.Z,{padding:4},p.createElement(xt.Z,null,H.description))),p.createElement(Ie.Z,{item:!0,lg:9},p.createElement(G.Z,{padding:1},p.createElement(ve.Oi,{text:H.example,showLineNumbers:!0,showCopyCodeButton:!0,language:"yaml"})))))),Or=()=>{const V=(0,Te.u)(ue.s),H=Dr(),{loading:Y,value:te,error:he}=(0,Se.default)(async()=>V.listActions()),[me,xe]=(0,p.useState)({});if(Y)return p.createElement(ve.Ex,null);if(he)return p.createElement(ve.mf,{statusMessage:"Failed to load installed actions",status:"500"});const Le=He=>!He||He.length<1?p.createElement(xt.Z,null,"No schema defined"):p.createElement(et.Z,{component:Je.Z},p.createElement(gt.Z,{size:"small"},p.createElement(hi.Z,null,p.createElement(li.Z,null,p.createElement(ge.Z,null,"Name"),p.createElement(ge.Z,null,"Title"),p.createElement(ge.Z,null,"Description"),p.createElement(ge.Z,null,"Type"))),p.createElement(ot.Z,null,He))),$t=He=>{var nt,pt;return He.type?He.type!=="array"?[He.type].flat():[`${He.type}(${(pt=(nt=He.items)==null?void 0:nt.type)!=null?pt:"unknown"})`]:["unknown"]},dt=(He,nt)=>{const pt=nt==null?void 0:nt.properties;if(pt)return Object.entries(pt).map(Mt=>{var bt,ji,Zi;const[Ei]=Mt,Wi=`${He}.${Ei}`,rn=Mt[1],qt=Ue()(H.code,{[H.codeRequired]:(bt=nt.required)==null?void 0:bt.includes(Ei)}),pn=$t(rn);return p.createElement(p.Fragment,{key:Wi},p.createElement(li.Z,{key:Wi},p.createElement(ge.Z,null,p.createElement("div",{className:qt},Ei)),p.createElement(ge.Z,null,rn.title),p.createElement(ge.Z,null,rn.description),p.createElement(ge.Z,null,pn.map(ai=>ai.includes("object")?p.createElement(tt.Z,{label:ai,key:ai,icon:me[Wi]?p.createElement(Ve.Z,null):p.createElement(Tt.Z,null),variant:"outlined",onClick:()=>xe(vi=>{const _i={...vi};return _i[Wi]=!vi[Wi],_i})}):p.createElement(tt.Z,{label:ai,key:ai,variant:"outlined"})))),p.createElement(li.Z,null,p.createElement(ge.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6},p.createElement(Jt.Z,{in:me[Wi],timeout:"auto",unmountOnExit:!0},p.createElement(G.Z,{sx:{margin:1}},p.createElement(xt.Z,{variant:"h6",component:"div"},Ei),Le(dt(Wi,rn.type==="array"?{properties:(Zi=(ji=rn.items)==null?void 0:ji.properties)!=null?Zi:{}}:rn)))))))})},Ne=(He,nt,pt)=>{if(pt)return p.createElement(p.Fragment,null,p.createElement(xt.Z,{variant:"h6",component:"h4"},He),pt.map((Mt,bt)=>p.createElement("div",{key:bt},Le(dt(`${nt}.${bt}`,Mt)))))},we=te==null?void 0:te.map(He=>{var nt,pt,Mt,bt,ji,Zi;if(He.id.startsWith("legacy:"))return;const Ei=Ne("oneOf",`${He.id}.input`,(pt=(nt=He.schema)==null?void 0:nt.input)==null?void 0:pt.oneOf);return p.createElement(G.Z,{pb:4,key:He.id},p.createElement(xt.Z,{variant:"h4",component:"h2",className:H.code},He.id),He.description&&p.createElement(ve.SA,{content:He.description}),((Mt=He.schema)==null?void 0:Mt.input)&&p.createElement(G.Z,{pb:2},p.createElement(xt.Z,{variant:"h5",component:"h3"},"Input"),Le(dt(`${He.id}.input`,(bt=He==null?void 0:He.schema)==null?void 0:bt.input)),Ei),((ji=He.schema)==null?void 0:ji.output)&&p.createElement(G.Z,{pb:2},p.createElement(xt.Z,{variant:"h5",component:"h3"},"Output"),Le(dt(`${He.id}.output`,(Zi=He==null?void 0:He.schema)==null?void 0:Zi.output))),He.examples&&p.createElement(pi.Z,null,p.createElement(Oi.Z,{expandIcon:p.createElement(Tt.Z,null)},p.createElement(xt.Z,{variant:"h5",component:"h3"},"Examples")),p.createElement(At.Z,null,p.createElement(G.Z,{pb:2},p.createElement(Un,{examples:He.examples})))))});return p.createElement(ve.T3,{themeId:"home"},p.createElement(ve.h4,{pageTitleOverride:"Create a New Component",title:"Installed actions",subtitle:"This is the collection of all installed actions"}),p.createElement(ve.VY,null,we))},hr=[{component:Me.y,name:"EntityPicker",schema:Me.z},{component:Me.A,name:"EntityNamePicker",validation:Me.B,schema:Me.C},{component:Me.D,name:"EntityTagsPicker",schema:Me.F},{component:Me.G,name:"RepoUrlPicker",validation:Me.i,schema:Me.H},{component:Me.I,name:"OwnerPicker",schema:Me.J},{component:Me.K,name:"OwnedEntityPicker",schema:Me.N},{component:Me.P,name:"MyGroupsPicker",schema:Me.l}],Pr=(0,ke.Z)(V=>({root:{backgroundColor:"rgba(0, 0, 0, .11)",boxShadow:"none",margin:V.spacing(1,0,1,0)},title:{margin:V.spacing(1,0,0,1),textTransform:"uppercase",fontSize:12,fontWeight:"bold"},listIcon:{minWidth:30,color:V.palette.text.primary},menuItem:{minHeight:V.spacing(6)},groupWrapper:{margin:V.spacing(1,1,2,1)}}),{name:"ScaffolderReactOwnerListPicker"});function Gr(){return[{name:"Task Owner",items:[{id:"owned",label:"Owned",icon:Ot.Z},{id:"all",label:"All",icon:ci.Z}]}]}const O=V=>{const{filter:H,onSelectOwner:Y}=V,te=Pr(),he=Gr();return p.createElement(si.Z,{className:te.root},he.map(me=>p.createElement(p.Fragment,{key:me.name},p.createElement(xt.Z,{variant:"subtitle2",component:"span",className:te.title},me.name),p.createElement(si.Z,{className:te.groupWrapper},p.createElement(Ut.Z,{disablePadding:!0,dense:!0,role:"menu"},me.items.map(xe=>p.createElement(ii.Z,{key:xe.id,divider:!0,ContainerProps:{role:"menuitem"},onClick:()=>Y(xe.id),selected:xe.id===H,className:te.menuItem,"data-testid":`owner-picker-${xe.id}`},xe.icon&&p.createElement(ct.Z,{className:te.listIcon},p.createElement(xe.icon,{fontSize:"small"})),p.createElement(St.Z,null,p.createElement(xt.Z,{variant:"body1"},xe.label)))))))))},g=({createdAt:V})=>{const H=Et.ou.fromISO(V),Y=Et.Xp.fromDateTimes(H,Et.ou.local()).toDuration().valueOf();return p.createElement(xt.Z,{paragraph:!0},Nt()(Y,{round:!0})," ago")},S=({entityRef:V})=>{var H,Y,te;const he=(0,Te.u)(it.Ah),{value:me,loading:xe,error:Le}=(0,Se.default)(()=>he.getEntityByRef(V||""),[he,V]);return V?xe||Le?null:p.createElement(it.dx,{entityRef:(0,Pt.of)(V),title:(te=(Y=(H=me==null?void 0:me.spec)==null?void 0:H.profile)==null?void 0:Y.displayName)!=null?te:me==null?void 0:me.metadata.name}):p.createElement(xt.Z,{paragraph:!0},"Unknown")},P=({status:V})=>{switch(V){case"processing":return p.createElement(ve.wA,null,V);case"completed":return p.createElement(ve.Kq,null,V);case"error":default:return p.createElement(ve.vK,null,V)}},F=({entityRef:V})=>{const H=(0,Te.u)(ue.s),{value:Y,loading:te,error:he}=(0,Se.default)(()=>H.getTemplateParameterSchema(V||""),[H,V]);return te||he||!V?null:p.createElement(it.dx,{entityRef:(0,Pt.of)(V),title:Y==null?void 0:Y.title})},K=V=>{var H;const{initiallySelectedFilter:Y="owned"}=V,te=(0,Te.u)(ue.s),he=(0,oe.tg)(Me.r),[me,xe]=(0,p.useState)(Y),{value:Le,loading:$t,error:dt}=(0,Se.default)(()=>{var Ne;return te.listTasks?(Ne=te.listTasks)==null?void 0:Ne.call(te,{filterByOwnership:me}):(console.warn("listTasks is not implemented in the scaffolderApi, please make sure to implement this method."),Promise.resolve({tasks:[]}))},[te,me]);return $t?p.createElement(ve.Ex,null):dt?p.createElement(p.Fragment,null,p.createElement(ve.yu,{error:dt}),p.createElement(ve.ub,{missing:"info",title:"No information to display",description:"There is no Tasks or there was an issue communicating with backend."})):p.createElement(it._i,null,p.createElement(it._i.Filters,null,p.createElement(O,{filter:me,onSelectOwner:Ne=>xe(Ne)})),p.createElement(it._i.Content,null,p.createElement(ve.iA,{data:(H=Le==null?void 0:Le.tasks)!=null?H:[],title:"Tasks",columns:[{title:"Task ID",field:"id",render:Ne=>p.createElement(ve.rU,{to:`${he()}/tasks/${Ne.id}`},Ne.id)},{title:"Template",render:Ne=>{var we;return p.createElement(F,{entityRef:(we=Ne.spec.templateInfo)==null?void 0:we.entityRef})}},{title:"Created",field:"createdAt",render:Ne=>p.createElement(g,{createdAt:Ne.createdAt})},{title:"Owner",field:"createdBy",render:Ne=>{var we,He;return p.createElement(S,{entityRef:(He=(we=Ne.spec)==null?void 0:we.user)==null?void 0:He.ref})}},{title:"Status",field:"status",render:Ne=>p.createElement(P,{status:Ne.status})}]})))},U=V=>p.createElement(ve.T3,{themeId:"home"},p.createElement(ve.h4,{pageTitleOverride:"Templates Tasks",title:p.createElement(p.Fragment,null,"List template tasks ",p.createElement(ve.Fw,{shorthand:!0,alpha:!0})),subtitle:"All tasks that have been started"}),p.createElement(ve.VY,null,p.createElement(K,{...V}))),se=window.showDirectoryPicker;class ae{constructor(H,Y){this.path=H,this.handle=Y}file(){return this.handle.getFile()}async save(H){const Y=await this.handle.createWritable();await Y.write(H),await Y.close()}}class Ze{constructor(H){this.handle=H}async listFiles(){const H=[];for await(const Y of this.listDirectoryContents(this.handle))H.push(Y);return H}async*listDirectoryContents(H,Y=[]){for await(const te of H.values())if(te.kind==="file")yield new ae([...Y,te.name].join("/"),te);else if(te.kind==="directory"){if(te.name===".git")continue;yield*this.listDirectoryContents(te,[...Y,te.name])}}}class Ye{static isSupported(){return Boolean(se)}static async requestDirectoryAccess(){if(!se)throw new Error("File system access is not supported");const H=await se();return new Ze(H)}constructor(){}}const Kt=(0,ke.Z)(V=>({introText:{textAlign:"center",marginTop:V.spacing(2)},card:{position:"relative",maxWidth:340,marginTop:V.spacing(4),margin:V.spacing(0,2)},infoIcon:{position:"absolute",top:V.spacing(1),right:V.spacing(1)}}));function Qi(V){const H=Kt(),Y=Ye.isSupported(),te=p.createElement(si.Z,{className:H.card,elevation:4},p.createElement(gi.Z,{disabled:!Y,onClick:()=>{var xe;return(xe=V.onSelect)==null?void 0:xe.call(V,"local")}},p.createElement(Vi.Z,null,p.createElement(xt.Z,{variant:"h4",component:"h3",gutterBottom:!0,color:Y?void 0:"textSecondary",style:{display:"flex",flexFlow:"row nowrap"}},"Load Template Directory"),p.createElement(xt.Z,{variant:"body1",color:Y?void 0:"textSecondary"},"Load a local template directory, allowing you to both edit and try executing your own template."))),!Y&&p.createElement("div",{className:H.infoIcon},p.createElement(Dt.ZP,{placement:"top",title:"Only supported in some Chromium-based browsers"},p.createElement(Xi.Z,null)))),he=p.createElement(si.Z,{className:H.card,elevation:4},p.createElement(gi.Z,{onClick:()=>{var xe;return(xe=V.onSelect)==null?void 0:xe.call(V,"form")}},p.createElement(Vi.Z,null,p.createElement(xt.Z,{variant:"h4",component:"h3",gutterBottom:!0},"Edit Template Form"),p.createElement(xt.Z,{variant:"body1"},"Preview and edit a template form, either using a sample template or by loading a template from the catalog.")))),me=p.createElement(si.Z,{className:H.card,elevation:4},p.createElement(gi.Z,{onClick:()=>{var xe;return(xe=V.onSelect)==null?void 0:xe.call(V,"field-explorer")}},p.createElement(Vi.Z,null,p.createElement(xt.Z,{variant:"h4",component:"h3",gutterBottom:!0},"Custom Field Explorer"),p.createElement(xt.Z,{variant:"body1"},"View and play around with available installed custom field extensions."))));return p.createElement("div",{style:V.style},p.createElement(xt.Z,{variant:"h4",component:"h2",className:H.introText},"Get started by choosing one of the options below"),p.createElement("div",{style:{display:"flex",flexFlow:"row wrap",alignItems:"flex-start",justifyContent:"center",alignContent:"flex-start"}},Y&&te,he,!Y&&te,me))}var zi=Object.defineProperty,wn=(V,H,Y)=>H in V?zi(V,H,{enumerable:!0,configurable:!0,writable:!0,value:Y}):V[H]=Y,ln=(V,H,Y)=>(wn(V,typeof H!="symbol"?H+"":H,Y),Y),cr=(V,H,Y)=>{if(!H.has(V))throw TypeError("Cannot "+Y)},Bt=(V,H,Y)=>(cr(V,H,"read from private field"),Y?Y.call(V):H.get(V)),Sn=(V,H,Y)=>{if(H.has(V))throw TypeError("Cannot add the same private member more than once");H instanceof WeakSet?H.add(V):H.set(V,Y)},un=(V,H,Y,te)=>(cr(V,H,"write to private field"),te?te.call(V,Y):H.set(V,Y),Y),Gn,Nn,an,Rr,fr,Br,Pn,Xn,Yn;const Xr=1024*1024,Lr="This file is too large to be displayed";class Ss{constructor(H,Y){Sn(this,Gn,void 0),Sn(this,Nn,void 0),Sn(this,an,void 0),Sn(this,Rr,void 0),un(this,Gn,H),un(this,Nn,Y)}get path(){return Bt(this,Gn).path}get content(){var H;return(H=Bt(this,an))!=null?H:Lr}updateContent(H){Bt(this,an)!==void 0&&(un(this,an,H),Bt(this,Nn).call(this))}get dirty(){return Bt(this,an)!==Bt(this,Rr)}async save(){Bt(this,an)!==void 0&&(await Bt(this,Gn).save(Bt(this,an)),un(this,Rr,Bt(this,an)),Bt(this,Nn).call(this))}async reload(){const H=await Bt(this,Gn).file();if(H.size>Xr){Bt(this,an)!==void 0&&(un(this,an,void 0),un(this,Rr,void 0),Bt(this,Nn).call(this));return}const Y=await H.text();Bt(this,an)!==Y&&(un(this,an,Y),un(this,Rr,Y),Bt(this,Nn).call(this))}}Gn=new WeakMap,Nn=new WeakMap,an=new WeakMap,Rr=new WeakMap;class Ys{constructor(H){Sn(this,fr,void 0),Sn(this,Br,new Set),Sn(this,Pn,[]),Sn(this,Xn,void 0),ln(this,"setSelectedFile",Y=>{const te=Bt(this,Xn),he=Bt(this,Pn).find(me=>me.path===Y);te!==he&&(un(this,Xn,he),Bt(this,Yn).call(this))}),Sn(this,Yn,()=>{Bt(this,Br).forEach(Y=>Y())}),un(this,fr,H)}get files(){return Bt(this,Pn)}get selectedFile(){return Bt(this,Xn)}get dirty(){return Bt(this,Pn).some(H=>H.dirty)}async save(){await Promise.all(Bt(this,Pn).map(H=>H.save()))}async reload(){var H;const Y=(H=Bt(this,Xn))==null?void 0:H.path,te=await Bt(this,fr).listFiles(),he=await Promise.all(te.map(async me=>{const xe=new Ss(me,Bt(this,Yn));return await xe.reload(),xe}));Bt(this,Pn).length=0,Bt(this,Pn).push(...he),this.setSelectedFile(Y),Bt(this,Yn).call(this)}subscribe(H){return Bt(this,Br).add(H),()=>{Bt(this,Br).delete(H)}}}fr=new WeakMap,Br=new WeakMap,Pn=new WeakMap,Xn=new WeakMap,Yn=new WeakMap;const ks=(0,p.createContext)(void 0);function Yr(){const V=(0,p.useContext)(ks),H=We();if((0,p.useEffect)(()=>V==null?void 0:V.subscribe(H),[V,H]),!V)throw new Error("must be used within a DirectoryEditorProvider");return V}function qs(V){const{directory:H}=V,[{result:Y,error:te},{execute:he}]=(0,Ee.r)(async me=>{const xe=new Ys(me);await xe.reload();const Le=xe.files.find($t=>$t.path.match(/\.ya?ml$/));return Le&&xe.setSelectedFile(Le.path),xe});return(0,p.useEffect)(()=>{he(H)},[he,H]),te?p.createElement(ve.yu,{error:te}):Y?p.createElement(ks.Provider,{value:Y},V.children):p.createElement(ve.Ex,null)}const Cs=64*1024,ti=32*1024,ur=(0,p.createContext)(void 0);function As(V){if(V.length>Cs)return window.btoa("<file too large>");try{return window.btoa(V)}catch{const Y=new TextEncoder().encode(V),te=new Array;for(let he=0;he<Y.length;he+=ti)te.push(String.fromCharCode(...Y.slice(he,he+ti)));return window.btoa(te.join(""))}}function dr(V){const H=(0,Te.u)(ue.s),[Y,te]=(0,p.useState)({results:[],selectedResult:void 0}),he=(0,p.useRef)(1),me=(0,p.useCallback)(dt=>{te(Ne=>{const we=Ne.results.find(He=>He.id===dt);return we===Ne.selectedResult?Ne:{results:Ne.results,selectedResult:we}})},[]),xe=(0,p.useCallback)(dt=>{te(Ne=>{var we;const He=Ne.results.findIndex(Mt=>Mt.id===dt);if(He===-1)return Ne;const nt=Ne.results.slice(),[pt]=nt.splice(He,1);return{results:nt,selectedResult:((we=Ne.selectedResult)==null?void 0:we.id)===pt.id?nt[0]:Ne.selectedResult}})},[]),Le=(0,p.useCallback)(async dt=>{if(!H.dryRun)throw new Error("Scaffolder API does not support dry-run");const Ne=jt.ZP.parse(dt.templateContent),He={...await H.dryRun({template:Ne,values:dt.values,secrets:{},directoryContents:dt.files.map(nt=>({path:nt.path,base64Content:As(nt.content)}))}),id:he.current++};te(nt=>{var pt;return{results:[...nt.results,He],selectedResult:(pt=nt.selectedResult)!=null?pt:He}})},[H]),$t=(0,p.useMemo)(()=>({...Y,selectResult:me,deleteResult:xe,execute:Le}),[Y,me,xe,Le]);return p.createElement(ur.Provider,{value:$t},V.children)}function qn(){const V=(0,p.useContext)(ur);if(!V)throw new Error("must be used within a DryRunProvider");return V}const as=(0,ke.Z)({root:{whiteSpace:"nowrap",overflowY:"auto"}});function Ts(V){const H={type:"directory",name:"",path:"",children:[]};for(const Y of V.slice().sort()){const te=Y.split("/");let he=H;for(let me=0;me<te.length;me++){const xe=te[me];if(xe==="")throw new Error("Invalid path part: ''");const Le=te.slice(0,me+1).join("/"),$t=he.children.find(dt=>dt.name===xe);if(($t==null?void 0:$t.type)==="file")throw new Error(`Duplicate filename at '${Le}'`);if($t)he=$t;else if(me<te.length-1){const dt={type:"directory",name:xe,path:Le,children:[]},Ne=he.children.findIndex(we=>we.type==="file");he.children.splice(Ne,0,dt),he=dt}else he.children.push({type:"file",name:xe,path:Le})}}return H.children}function qr({entry:V}){return V.type==="file"?p.createElement(u,{nodeId:V.path,label:V.name}):p.createElement(u,{nodeId:V.path,label:V.name},V.children.map(H=>p.createElement(qr,{key:H.path,entry:H})))}function $i(V){const H=as(),Y=(0,p.useMemo)(()=>Ts(V.filePaths),[V.filePaths]);return p.createElement(qi,{selected:V.selected,className:H.root,defaultCollapseIcon:p.createElement(Tt.Z,null),defaultExpandIcon:p.createElement(fi.Z,null),onNodeSelect:(te,he)=>{V.onSelect&&V.filePaths.includes(he)&&V.onSelect(he)}},Y.map(te=>p.createElement(qr,{key:te.path,entry:te})))}const dn=(0,ke.Z)(V=>({button:{padding:V.spacing(1)},buttons:{display:"flex",flexFlow:"row nowrap",alignItems:"center",justifyContent:"flex-start"},buttonsGap:{flex:"1 1 auto"},buttonsDivider:{marginBottom:V.spacing(1)}}));function Ms(V){var H,Y;const te=dn(),he=Yr(),me=he.files.filter(Le=>Le.dirty),xe=()=>{V.onClose&&(me.length>0&&!window.confirm("Are you sure? Unsaved changes will be lost")||V.onClose())};return p.createElement(p.Fragment,null,p.createElement("div",{className:te.buttons},p.createElement(Dt.ZP,{title:"Save all files"},p.createElement(Mi.Z,{className:te.button,disabled:he.files.every(Le=>!Le.dirty),onClick:()=>he.save()},p.createElement(I.Z,null))),p.createElement(Dt.ZP,{title:"Reload directory"},p.createElement(Mi.Z,{className:te.button,onClick:()=>he.reload()},p.createElement(D.Z,null))),p.createElement("div",{className:te.buttonsGap}),p.createElement(Dt.ZP,{title:"Close directory"},p.createElement(Mi.Z,{className:te.button,onClick:xe},p.createElement(b.Z,null)))),p.createElement(mi.Z,{className:te.buttonsDivider}),p.createElement($i,{selected:(Y=(H=he.selectedFile)==null?void 0:H.path)!=null?Y:"",onSelect:he.setSelectedFile,filePaths:he.files.map(Le=>Le.path)}))}const Qr=(0,ke.Z)(V=>({container:{position:"relative",width:"100%",height:"100%"},codeMirror:{position:"absolute",top:0,bottom:0,left:0,right:0},errorPanel:{color:V.palette.error.main,lineHeight:2,margin:V.spacing(0,1)},floatingButtons:{position:"absolute",top:V.spacing(1),right:V.spacing(3)},floatingButton:{padding:V.spacing(1)}}));function pr(V){const{errorText:H}=V,Y=Qr(),te=(0,p.useMemo)(()=>{if(!H)return _.mH.of(null);const he=document.createElement("div");return he.classList.add(Y.errorPanel),he.textContent=H,_.mH.of(()=>({dom:he,bottom:!0}))},[Y,H]);return Ft(he=>he.key==="s"&&(he.ctrlKey||he.metaKey),he=>{he.preventDefault(),V.onSave&&V.onSave()}),p.createElement("div",{className:Y.container},p.createElement(Ge.ZP,{className:Y.codeMirror,theme:"dark",height:"100%",extensions:[N.il.define(Z.r),te],value:V.content,onChange:V.onUpdate}),(V.onSave||V.onReload)&&p.createElement("div",{className:Y.floatingButtons},p.createElement(Je.Z,null,V.onSave&&p.createElement(Dt.ZP,{title:"Save file"},p.createElement(Mi.Z,{className:Y.floatingButton,onClick:()=>{var he;return(he=V.onSave)==null?void 0:he.call(V)}},p.createElement(I.Z,null))),V.onReload&&p.createElement(Dt.ZP,{title:"Reload file"},p.createElement(Mi.Z,{className:Y.floatingButton,onClick:()=>{var he;return(he=V.onReload)==null?void 0:he.call(V)}},p.createElement(D.Z,null))))))}function Ir(V){var H,Y;const te=Yr(),he=(H=te.selectedFile)!=null&&H.dirty?{onSave:()=>te.save(),onReload:()=>te.reload()}:{onReload:()=>te.reload()};return p.createElement(pr,{errorText:V.errorText,content:(Y=te.selectedFile)==null?void 0:Y.content,onUpdate:me=>{var xe;return(xe=te.selectedFile)==null?void 0:xe.updateContent(me)},...he})}pr.DirectoryEditor=Ir;function hs(V,H){const Y=document.createElement("a");Y.href=URL.createObjectURL(V),Y.download=H,Y.click(),URL.revokeObjectURL(Y.href),Y.remove()}const Es=(0,ke.Z)(V=>({root:{overflowY:"auto",background:V.palette.background.default},iconSuccess:{minWidth:0,marginRight:V.spacing(1),color:V.palette.status.ok},iconFailure:{minWidth:0,marginRight:V.spacing(1),color:V.palette.status.error}}));function Qs(){const V=Es(),H=qn();return p.createElement(Ut.Z,{className:V.root,dense:!0},H.results.map(Y=>{var te;const he=Y.log.some(Le=>Le.body.status==="failed");let me=!1;async function xe(){me=!0,await Ds(Y.directoryContents,`dry-run-result-${Y.id}.zip`),me=!1}return p.createElement(je.Z,{button:!0,key:Y.id,selected:((te=H.selectedResult)==null?void 0:te.id)===Y.id,onClick:()=>H.selectResult(Y.id)},p.createElement(ct.Z,{className:he?V.iconFailure:V.iconSuccess},he?p.createElement(ut.Z,null):p.createElement(Rt.Z,null)),p.createElement(St.Z,{primary:`Result ${Y.id}`}),p.createElement(yt.Z,null,p.createElement(Mi.Z,{edge:"end","aria-label":"download",title:"Download as .zip",disabled:me,onClick:()=>xe()},p.createElement(st.Z,null)),p.createElement(Mi.Z,{edge:"end","aria-label":"delete",title:"Delete result",onClick:()=>H.deleteResult(Y.id)},p.createElement(rt.Z,null))))}))}async function Ds(V,H){const{default:Y}=await Q.e(1297).then(Q.t.bind(Q,1297,23)),te=new Y;for(const me of V){const xe=atob(me.base64Content);await te.file(me.path,xe)}const he=await te.generateAsync({type:"blob"});hs(he,H)}const Os=(0,ke.Z)(V=>({root:{display:"grid",gridTemplateColumns:"280px auto 3fr",gridTemplateRows:"1fr"},child:{overflowY:"auto",height:"100%",minHeight:0},firstChild:{background:V.palette.background.paper}}));function _r(V){const H=Os(),Y=p.Children.toArray(V.children);if(Y.length!==2)throw new Error("must have exactly 2 children");return p.createElement("div",{className:H.root},p.createElement("div",{className:Ue()(H.child,H.firstChild)},Y[0]),p.createElement(mi.Z,{orientation:"horizontal"}),p.createElement("div",{className:H.child},Y[1]))}const es=(0,ke.Z)({root:{display:"flex",flexFlow:"column nowrap"},contentWrapper:{flex:1,position:"relative"},content:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex","& > *":{flex:1}},codeMirror:{height:"100%",overflowY:"auto"}});function Ps(){const V=es(),{selectedResult:H}=qn(),[Y,te]=(0,p.useState)(""),he=H==null?void 0:H.directoryContents.find(me=>me.path===Y);return(0,p.useEffect)(()=>{if(H){const[me]=H.directoryContents;te(me?me.path:"")}},[H]),H?p.createElement(_r,null,p.createElement($i,{selected:Y,onSelect:te,filePaths:H.directoryContents.map(me=>me.path)}),p.createElement(Ge.ZP,{className:V.codeMirror,theme:"dark",height:"100%",extensions:[N.il.define(Z.r)],readOnly:!0,value:he!=null&&he.base64Content?atob(he.base64Content):""})):null}function cs(){var V,H;const{selectedResult:Y}=qn(),[te,he]=(0,p.useState)(),me=(0,p.useMemo)(()=>{var Le;return Y?(Le=Y.steps.map($t=>{var dt,Ne;const we=Y.log.filter(He=>He.body.stepId===$t.id);return{id:$t.id,name:$t.name,logString:we.map(He=>He.body.message).join(`
`),status:(Ne=(dt=we[we.length-1])==null?void 0:dt.body.status)!=null?Ne:"completed"}}))!=null?Le:[]:[]},[Y]);if(!Y)return null;const xe=(V=me.find(Le=>Le.id===te))!=null?V:me[0];return p.createElement(_r,null,p.createElement(zt,{steps:me,currentStepId:xe.id,onUserStepChange:he}),p.createElement(ve.nU,{text:(H=xe==null?void 0:xe.logString)!=null?H:""}))}function _s(){var V,H;const Y=es(),{selectedResult:te}=qn();return te?p.createElement(_r,null,p.createElement(G.Z,{pt:2},((H=(V=te.output)==null?void 0:V.links)==null?void 0:H.length)&&p.createElement(ui,{output:te.output})),p.createElement(Ge.ZP,{className:Y.codeMirror,theme:"dark",height:"100%",extensions:[N.il.define(Z.r)],readOnly:!0,value:JSON.stringify(te.output,null,2)})):null}function eo(){const V=es(),[H,Y]=(0,p.useState)("files");return p.createElement("div",{className:V.root},p.createElement(Qe.Z,{value:H,onChange:(te,he)=>Y(he)},p.createElement(Vt.Z,{value:"files",label:"Files"}),p.createElement(Vt.Z,{value:"log",label:"Log"}),p.createElement(Vt.Z,{value:"output",label:"Output"})),p.createElement(mi.Z,null),p.createElement("div",{className:V.contentWrapper},p.createElement("div",{className:V.content},H==="files"&&p.createElement(Ps,null),H==="log"&&p.createElement(cs,null),H==="output"&&p.createElement(_s,null))))}const Rs=(0,ke.Z)(V=>({header:{height:48,minHeight:0,"&.Mui-expanded":{height:48,minHeight:0}},content:{display:"grid",background:V.palette.background.default,gridTemplateColumns:"180px auto 1fr",gridTemplateRows:"1fr",padding:0,height:400}}));function to(){const V=Rs(),H=qn(),[Y,te]=(0,p.useState)(!1),[he,me]=(0,p.useState)(!0),xe=H.results.length,Le=Xt(xe);return(0,p.useEffect)(()=>{Le===0&&xe===1?(me(!1),te(!0)):Le===1&&xe===0&&te(!1)},[Le,xe]),p.createElement(p.Fragment,null,p.createElement(pi.Z,{variant:"outlined",expanded:Y,hidden:xe===0&&he,onChange:($t,dt)=>te(dt),onTransitionEnd:()=>xe===0&&me(!0)},p.createElement(Oi.Z,{className:V.header,expandIcon:p.createElement(Ve.Z,null)},p.createElement(xt.Z,null,"Dry-run results")),p.createElement(mi.Z,{orientation:"horizontal"}),p.createElement(At.Z,{className:V.content},p.createElement(Qs,null),p.createElement(mi.Z,{orientation:"horizontal"}),p.createElement(eo,null))))}},22983:(yn,Wt,Q)=>{var p,Se=Q(71600),ue=Q(34590);p={value:!0},Wt.Z=void 0;var L=ue(Q(2784)),G=Se(Q(50175)),ke=(0,G.default)(L.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");Wt.Z=ke},84905:(yn,Wt,Q)=>{var p,Se=Q(71600),ue=Q(34590);p={value:!0},Wt.Z=void 0;var L=ue(Q(2784)),G=Se(Q(50175)),ke=(0,G.default)(L.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");Wt.Z=ke},16874:(yn,Wt,Q)=>{var p,Se=Q(71600),ue=Q(34590);p={value:!0},Wt.Z=void 0;var L=ue(Q(2784)),G=Se(Q(50175)),ke=(0,G.default)(L.createElement("circle",{cx:"12",cy:"12",r:"8"}),"FiberManualRecord");Wt.Z=ke},28113:(yn,Wt,Q)=>{var p,Se=Q(71600),ue=Q(34590);p={value:!0},Wt.Z=void 0;var L=ue(Q(2784)),G=Se(Q(50175)),ke=(0,G.default)(L.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp");Wt.Z=ke},82726:(yn,Wt,Q)=>{var p,Se=Q(71600),ue=Q(34590);p={value:!0},Wt.Z=void 0;var L=ue(Q(2784)),G=Se(Q(50175)),ke=(0,G.default)(L.createElement("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"InfoOutlined");Wt.Z=ke},49423:(yn,Wt,Q)=>{var p,Se=Q(71600),ue=Q(34590);p={value:!0},Wt.Z=void 0;var L=ue(Q(2784)),G=Se(Q(50175)),ke=(0,G.default)(L.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");Wt.Z=ke},96401:(yn,Wt,Q)=>{var p,Se=Q(71600),ue=Q(34590);p={value:!0},Wt.Z=void 0;var L=ue(Q(2784)),G=Se(Q(50175)),ke=(0,G.default)(L.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");Wt.Z=ke},2552:(yn,Wt,Q)=>{Q.d(Wt,{ZP:()=>Rl});var p=Q(7896),Se=Q(31461),ue=Q(2784),L=Q(1727),G=Q(65329),ke=Q(77120),Ie=Q(21649);const xt=o=>{let{state:i}=o,l=i.doc.lineAt(i.selection.main.from),a=ge(o.state,l.from);return a.line?wt(o):a.block?li(o):!1};function ht(o,i){return({state:l,dispatch:a})=>{if(l.readOnly)return!1;let f=o(i,l);return f?(a(l.update(f)),!0):!1}}const wt=ht(At,0),Je=null,vt=null,et=ht(Oi,0),gt=null,hi=null,li=ht((o,i)=>Oi(o,i,pi(i)),0);function ge(o,i){let l=o.languageDataAt("commentTokens",i);return l.length?l[0]:{}}const ot=50;function Jt(o,{open:i,close:l},a,f){let m=o.sliceDoc(a-ot,a),k=o.sliceDoc(f,f+ot),T=/\s*$/.exec(m)[0].length,B=/^\s*/.exec(k)[0].length,J=m.length-T;if(m.slice(J-i.length,J)==i&&k.slice(B,B+l.length)==l)return{open:{pos:a-T,margin:T&&1},close:{pos:f+B,margin:B&&1}};let q,pe;f-a<=2*ot?q=pe=o.sliceDoc(a,f):(q=o.sliceDoc(a,a+ot),pe=o.sliceDoc(f-ot,f));let Re=/^\s*/.exec(q)[0].length,at=/\s*$/.exec(pe)[0].length,ri=pe.length-at-l.length;return q.slice(Re,Re+i.length)==i&&pe.slice(ri,ri+l.length)==l?{open:{pos:a+Re+i.length,margin:/\s/.test(q.charAt(Re+i.length))?1:0},close:{pos:f-at-l.length,margin:/\s/.test(pe.charAt(ri-1))?1:0}}:null}function pi(o){let i=[];for(let l of o.selection.ranges){let a=o.doc.lineAt(l.from),f=l.to<=a.to?a:o.doc.lineAt(l.to),m=i.length-1;m>=0&&i[m].to>a.from?i[m].to=f.to:i.push({from:a.from+/^\s*/.exec(a.text)[0].length,to:f.to})}return i}function Oi(o,i,l=i.selection.ranges){let a=l.map(m=>ge(i,m.from).block);if(!a.every(m=>m))return null;let f=l.map((m,k)=>Jt(i,a[k],m.from,m.to));if(o!=2&&!f.every(m=>m))return{changes:i.changes(l.map((m,k)=>f[k]?[]:[{from:m.from,insert:a[k].open+" "},{from:m.to,insert:" "+a[k].close}]))};if(o!=1&&f.some(m=>m)){let m=[];for(let k=0,T;k<f.length;k++)if(T=f[k]){let B=a[k],{open:J,close:q}=T;m.push({from:J.pos-B.open.length,to:J.pos+J.margin},{from:q.pos-q.margin,to:q.pos+B.close.length})}return{changes:m}}return null}function At(o,i,l=i.selection.ranges){let a=[],f=-1;for(let{from:m,to:k}of l){let T=a.length,B=1e9,J=ge(i,m).line;if(J){for(let q=m;q<=k;){let pe=i.doc.lineAt(q);if(pe.from>f&&(m==k||k>pe.from)){f=pe.from;let Re=/^\s*/.exec(pe.text)[0].length,at=Re==pe.length,ri=pe.text.slice(Re,Re+J.length)==J?Re:-1;Re<pe.text.length&&Re<B&&(B=Re),a.push({line:pe,comment:ri,token:J,indent:Re,empty:at,single:!1})}q=pe.to+1}if(B<1e9)for(let q=T;q<a.length;q++)a[q].indent<a[q].line.text.length&&(a[q].indent=B);a.length==T+1&&(a[T].single=!0)}}if(o!=2&&a.some(m=>m.comment<0&&(!m.empty||m.single))){let m=[];for(let{line:T,token:B,indent:J,empty:q,single:pe}of a)(pe||!q)&&m.push({from:T.from+J,insert:B+" "});let k=i.changes(m);return{changes:k,selection:i.selection.map(k,1)}}else if(o!=1&&a.some(m=>m.comment>=0)){let m=[];for(let{line:k,comment:T,token:B}of a)if(T>=0){let J=k.from+T,q=J+B.length;k.text[q-k.from]==" "&&q++,m.push({from:J,to:q})}return{changes:m}}return null}const si=L.q6.define(),Ut=L.q6.define(),ii=L.r$.define(),ct=L.r$.define({combine(o){return(0,L.BO)(o,{minDepth:100,newGroupDelay:500,joinToEvent:(i,l)=>l},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(i,l)=>(a,f)=>i(a,f)||l(a,f)})}});function St(o){let i=0;return o.iterChangedRanges((l,a)=>i=a),i}const Dt=L.QQ.define({create(){return b.empty},update(o,i){let l=i.state.facet(ct),a=i.annotation(si);if(a){let B=i.docChanged?L.jT.single(St(i.changes)):void 0,J=Me.fromTransaction(i,B),q=a.side,pe=q==0?o.undone:o.done;return J?pe=it(pe,pe.length,l.minDepth,J):pe=Pt(pe,i.startState.selection),new b(q==0?a.rest:pe,q==0?pe:a.rest)}let f=i.annotation(Ut);if((f=="full"||f=="before")&&(o=o.isolate()),i.annotation(L.YW.addToHistory)===!1)return i.changes.empty?o:o.addMapping(i.changes.desc);let m=Me.fromTransaction(i),k=i.annotation(L.YW.time),T=i.annotation(L.YW.userEvent);return m?o=o.addChanges(m,k,T,l,i):i.selection&&(o=o.addSelection(i.startState.selection,k,T,l.newGroupDelay)),(f=="full"||f=="after")&&(o=o.isolate()),o},toJSON(o){return{done:o.done.map(i=>i.toJSON()),undone:o.undone.map(i=>i.toJSON())}},fromJSON(o){return new b(o.done.map(Me.fromJSON),o.undone.map(Me.fromJSON))}});function Mi(o={}){return[Dt,ct.of(o),G.tk.domEventHandlers({beforeinput(i,l){let a=i.inputType=="historyUndo"?Ue:i.inputType=="historyRedo"?Tt:null;return a?(i.preventDefault(),a(l)):!1}})]}const mi=null;function wi(o,i){return function({state:l,dispatch:a}){if(!i&&l.readOnly)return!1;let f=l.field(Dt,!1);if(!f)return!1;let m=f.pop(o,l,i);return m?(a(m),!0):!1}}const Ue=wi(0,!1),Tt=wi(1,!1),Ve=wi(0,!0),oe=wi(1,!0);function Te(o){return function(i){let l=i.field(Dt,!1);if(!l)return 0;let a=o==0?l.done:l.undone;return a.length-(a.length&&!a[0].changes?1:0)}}const ve=null,tt=null;class Me{constructor(i,l,a,f,m){this.changes=i,this.effects=l,this.mapped=a,this.startSelection=f,this.selectionsAfter=m}setSelAfter(i){return new Me(this.changes,this.effects,this.mapped,this.startSelection,i)}toJSON(){var i,l,a;return{changes:(i=this.changes)===null||i===void 0?void 0:i.toJSON(),mapped:(l=this.mapped)===null||l===void 0?void 0:l.toJSON(),startSelection:(a=this.startSelection)===null||a===void 0?void 0:a.toJSON(),selectionsAfter:this.selectionsAfter.map(f=>f.toJSON())}}static fromJSON(i){return new Me(i.changes&&L.as.fromJSON(i.changes),[],i.mapped&&L.n0.fromJSON(i.mapped),i.startSelection&&L.jT.fromJSON(i.startSelection),i.selectionsAfter.map(L.jT.fromJSON))}static fromTransaction(i,l){let a=Lt;for(let f of i.startState.facet(ii)){let m=f(i);m.length&&(a=a.concat(m))}return!a.length&&i.changes.empty?null:new Me(i.changes.invert(i.startState.doc),a,void 0,l||i.startState.selection,Lt)}static selection(i){return new Me(void 0,Lt,void 0,void 0,i)}}function it(o,i,l,a){let f=i+1>l+20?i-l-1:0,m=o.slice(f,i);return m.push(a),m}function Ot(o,i){let l=[],a=!1;return o.iterChangedRanges((f,m)=>l.push(f,m)),i.iterChangedRanges((f,m,k,T)=>{for(let B=0;B<l.length;){let J=l[B++],q=l[B++];T>=J&&k<=q&&(a=!0)}}),a}function ci(o,i){return o.ranges.length==i.ranges.length&&o.ranges.filter((l,a)=>l.empty!=i.ranges[a].empty).length===0}function Et(o,i){return o.length?i.length?o.concat(i):o:i}const Lt=[],Nt=200;function Pt(o,i){if(o.length){let l=o[o.length-1],a=l.selectionsAfter.slice(Math.max(0,l.selectionsAfter.length-Nt));return a.length&&a[a.length-1].eq(i)?o:(a.push(i),it(o,o.length-1,1e9,l.setSelAfter(a)))}else return[Me.selection([i])]}function gi(o){let i=o[o.length-1],l=o.slice();return l[o.length-1]=i.setSelAfter(i.selectionsAfter.slice(0,i.selectionsAfter.length-1)),l}function Vi(o,i){if(!o.length)return o;let l=o.length,a=Lt;for(;l;){let f=Xi(o[l-1],i,a);if(f.changes&&!f.changes.empty||f.effects.length){let m=o.slice(0,l);return m[l-1]=f,m}else i=f.mapped,l--,a=f.selectionsAfter}return a.length?[Me.selection(a)]:Lt}function Xi(o,i,l){let a=Et(o.selectionsAfter.length?o.selectionsAfter.map(T=>T.map(i)):Lt,l);if(!o.changes)return Me.selection(a);let f=o.changes.map(i),m=i.mapDesc(o.changes,!0),k=o.mapped?o.mapped.composeDesc(m):m;return new Me(f,L.Py.mapEffects(o.effects,i),k,o.startSelection.map(m),a)}const re=/^(input\.type|delete)($|\.)/;class b{constructor(i,l,a=0,f=void 0){this.done=i,this.undone=l,this.prevTime=a,this.prevUserEvent=f}isolate(){return this.prevTime?new b(this.done,this.undone):this}addChanges(i,l,a,f,m){let k=this.done,T=k[k.length-1];return T&&T.changes&&!T.changes.empty&&i.changes&&(!a||re.test(a))&&(!T.selectionsAfter.length&&l-this.prevTime<f.newGroupDelay&&f.joinToEvent(m,Ot(T.changes,i.changes))||a=="input.type.compose")?k=it(k,k.length-1,f.minDepth,new Me(i.changes.compose(T.changes),Et(i.effects,T.effects),T.mapped,T.startSelection,Lt)):k=it(k,k.length,f.minDepth,i),new b(k,Lt,l,a)}addSelection(i,l,a,f){let m=this.done.length?this.done[this.done.length-1].selectionsAfter:Lt;return m.length>0&&l-this.prevTime<f&&a==this.prevUserEvent&&a&&/^select($|\.)/.test(a)&&ci(m[m.length-1],i)?this:new b(Pt(this.done,i),this.undone,l,a)}addMapping(i){return new b(Vi(this.done,i),Vi(this.undone,i),this.prevTime,this.prevUserEvent)}pop(i,l,a){let f=i==0?this.done:this.undone;if(f.length==0)return null;let m=f[f.length-1];if(a&&m.selectionsAfter.length)return l.update({selection:m.selectionsAfter[m.selectionsAfter.length-1],annotations:si.of({side:i,rest:gi(f)}),userEvent:i==0?"select.undo":"select.redo",scrollIntoView:!0});if(m.changes){let k=f.length==1?Lt:f.slice(0,f.length-1);return m.mapped&&(k=Vi(k,m.mapped)),l.update({changes:m.changes,selection:m.startSelection,effects:m.effects,annotations:si.of({side:i,rest:k}),filter:!1,userEvent:i==0?"undo":"redo",scrollIntoView:!0})}else return null}}b.empty=new b(Lt,Lt);const D=[{key:"Mod-z",run:Ue,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Tt,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Tt,preventDefault:!0},{key:"Mod-u",run:Ve,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:oe,preventDefault:!0}];function I(o,i){return L.jT.create(o.ranges.map(i),o.mainIndex)}function N(o,i){return o.update({selection:i,scrollIntoView:!0,userEvent:"select"})}function Z({state:o,dispatch:i},l){let a=I(o.selection,l);return a.eq(o.selection)?!1:(i(N(o,a)),!0)}function _(o,i){return L.jT.cursor(i?o.to:o.from)}function ce(o,i){return Z(o,l=>l.empty?o.moveByChar(l,i):_(l,i))}function ye(o){return o.textDirectionAt(o.state.selection.main.head)==G.Nm.LTR}const We=o=>ce(o,!ye(o)),Ee=o=>ce(o,ye(o)),Xe=o=>ce(o,!0),qe=o=>ce(o,!1);function ft(o,i){return Z(o,l=>l.empty?o.moveByGroup(l,i):_(l,i))}const Qt=o=>ft(o,!ye(o)),kt=o=>ft(o,ye(o)),Gt=o=>ft(o,!0),Ht=o=>ft(o,!1),_t=typeof Intl!="undefined"&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function Ft(o,i,l){let a=o.state.charCategorizer(i.from),f=CharCategory.Space,m=i.from,k=0,T=!1,B=!1,J=!1,q=Re=>{if(T)return!1;m+=l?Re.length:-Re.length;let at=a(Re),ri;if(at==CharCategory.Word&&Re.charCodeAt(0)<128&&/[\W_]/.test(Re)&&(at=-1),f==CharCategory.Space&&(f=at),f!=at)return!1;if(f==CharCategory.Word)if(Re.toLowerCase()==Re){if(!l&&B)return!1;J=!0}else if(J){if(l)return!1;T=!0}else{if(B&&l&&a(ri=o.state.sliceDoc(m,m+1))==CharCategory.Word&&ri.toLowerCase()==ri)return!1;B=!0}return k++,!0},pe=o.moveByChar(i,l,Re=>(q(Re),q));if(_t&&f==CharCategory.Word&&pe.from==i.from+k*(l?1:-1)){let Re=Math.min(i.head,pe.head),at=Math.max(i.head,pe.head),ri=o.state.sliceDoc(Re,at);if(ri.length>1&&/[\u4E00-\uffff]/.test(ri)){let Gi=Array.from(_t.segment(ri));if(Gi.length>1)return l?EditorSelection.cursor(i.head+Gi[1].index,-1):EditorSelection.cursor(pe.head+Gi[Gi.length-1].index,1)}}return pe}function Xt(o,i){return Z(o,l=>l.empty?Ft(o,l,i):_(l,i))}const Ge=o=>Xt(o,!0),jt=o=>Xt(o,!1);function je(o,i,l){if(i.type.prop(l))return!0;let a=i.to-i.from;return a&&(a>2||/[^\s,.;:]/.test(o.sliceDoc(i.from,i.to)))||i.firstChild}function yt(o,i,l){let a=(0,ke.qz)(o).resolveInner(i.head),f=l?Ie.md.closedBy:Ie.md.openedBy;for(let B=i.head;;){let J=l?a.childAfter(B):a.childBefore(B);if(!J)break;je(o,J,f)?a=J:B=l?J.to:J.from}let m=a.type.prop(f),k,T;return m&&(k=l?(0,ke.Um)(o,a.from,1):(0,ke.Um)(o,a.to,-1))&&k.matched?T=l?k.end.to:k.end.from:T=l?a.to:a.from,L.jT.cursor(T,l?-1:1)}const ut=o=>Z(o,i=>yt(o.state,i,!ye(o))),Rt=o=>Z(o,i=>yt(o.state,i,ye(o)));function rt(o,i){return Z(o,l=>{if(!l.empty)return _(l,i);let a=o.moveVertically(l,i);return a.head!=l.head?a:o.moveToLineBoundary(l,i)})}const st=o=>rt(o,!1),Vt=o=>rt(o,!0);function Qe(o){let i=o.scrollDOM.clientHeight<o.scrollDOM.scrollHeight-2,l=0,a=0,f;if(i){for(let m of o.state.facet(G.tk.scrollMargins)){let k=m(o);k!=null&&k.top&&(l=Math.max(k==null?void 0:k.top,l)),k!=null&&k.bottom&&(a=Math.max(k==null?void 0:k.bottom,a))}f=o.scrollDOM.clientHeight-l-a}else f=(o.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:l,marginBottom:a,selfScroll:i,height:Math.max(o.defaultLineHeight,f-5)}}function Yt(o,i){let l=Qe(o),{state:a}=o,f=I(a.selection,k=>k.empty?o.moveVertically(k,i,l.height):_(k,i));if(f.eq(a.selection))return!1;let m;if(l.selfScroll){let k=o.coordsAtPos(a.selection.main.head),T=o.scrollDOM.getBoundingClientRect(),B=T.top+l.marginTop,J=T.bottom-l.marginBottom;k&&k.top>B&&k.bottom<J&&(m=G.tk.scrollIntoView(f.main.head,{y:"start",yMargin:k.top-B}))}return o.dispatch(N(a,f),{effects:m}),!0}const Pi=o=>Yt(o,!1),Ri=o=>Yt(o,!0);function oi(o,i,l){let a=o.lineBlockAt(i.head),f=o.moveToLineBoundary(i,l);if(f.head==i.head&&f.head!=(l?a.to:a.from)&&(f=o.moveToLineBoundary(i,l,!1)),!l&&f.head==a.from&&a.length){let m=/^\s*/.exec(o.state.sliceDoc(a.from,Math.min(a.from+100,a.to)))[0].length;m&&i.head!=a.from+m&&(f=L.jT.cursor(a.from+m))}return f}const Yi=o=>Z(o,i=>oi(o,i,!0)),ei=o=>Z(o,i=>oi(o,i,!1)),Si=o=>Z(o,i=>oi(o,i,!ye(o))),ki=o=>Z(o,i=>oi(o,i,ye(o))),nn=o=>Z(o,i=>L.jT.cursor(o.lineBlockAt(i.head).from,1)),Ni=o=>Z(o,i=>L.jT.cursor(o.lineBlockAt(i.head).to,-1));function Bi(o,i,l){let a=!1,f=I(o.selection,m=>{let k=(0,ke.Um)(o,m.head,-1)||(0,ke.Um)(o,m.head,1)||m.head>0&&(0,ke.Um)(o,m.head-1,1)||m.head<o.doc.length&&(0,ke.Um)(o,m.head+1,-1);if(!k||!k.end)return m;a=!0;let T=k.start.from==m.head?k.end.to:k.end.from;return l?L.jT.range(m.anchor,T):L.jT.cursor(T)});return a?(i(N(o,f)),!0):!1}const Fi=({state:o,dispatch:i})=>Bi(o,i,!1),vn=({state:o,dispatch:i})=>Bi(o,i,!0);function Li(o,i){let l=I(o.state.selection,a=>{let f=i(a);return L.jT.range(a.anchor,f.head,f.goalColumn,f.bidiLevel||void 0)});return l.eq(o.state.selection)?!1:(o.dispatch(N(o.state,l)),!0)}function qi(o,i){return Li(o,l=>o.moveByChar(l,i))}const fi=o=>qi(o,!ye(o)),fn=o=>qi(o,ye(o)),lr=o=>qi(o,!0),Kn=o=>qi(o,!1);function bn(o,i){return Li(o,l=>o.moveByGroup(l,i))}const R=o=>bn(o,!ye(o)),c=o=>bn(o,ye(o)),u=o=>bn(o,!0),v=o=>bn(o,!1);function w(o,i){return Li(o,l=>Ft(o,l,i))}const E=o=>w(o,!0),M=o=>w(o,!1),z=o=>Li(o,i=>yt(o.state,i,!ye(o))),j=o=>Li(o,i=>yt(o.state,i,ye(o)));function ie(o,i){return Li(o,l=>o.moveVertically(l,i))}const fe=o=>ie(o,!1),be=o=>ie(o,!0);function Be(o,i){return Li(o,l=>o.moveVertically(l,i,Qe(o).height))}const De=o=>Be(o,!1),Zt=o=>Be(o,!0),ui=o=>Li(o,i=>oi(o,i,!0)),yi=o=>Li(o,i=>oi(o,i,!1)),Jn=o=>Li(o,i=>oi(o,i,!ye(o))),xn=o=>Li(o,i=>oi(o,i,ye(o))),ar=o=>Li(o,i=>L.jT.cursor(o.lineBlockAt(i.head).from)),zt=o=>Li(o,i=>L.jT.cursor(o.lineBlockAt(i.head).to)),Ur=({state:o,dispatch:i})=>(i(N(o,{anchor:0})),!0),Er=({state:o,dispatch:i})=>(i(N(o,{anchor:o.doc.length})),!0),Dr=({state:o,dispatch:i})=>(i(N(o,{anchor:o.selection.main.anchor,head:0})),!0),Un=({state:o,dispatch:i})=>(i(N(o,{anchor:o.selection.main.anchor,head:o.doc.length})),!0),Or=({state:o,dispatch:i})=>(i(o.update({selection:{anchor:0,head:o.doc.length},userEvent:"select"})),!0),hr=({state:o,dispatch:i})=>{let l=ln(o).map(({from:a,to:f})=>L.jT.range(a,Math.min(f+1,o.doc.length)));return i(o.update({selection:L.jT.create(l),userEvent:"select"})),!0},Pr=({state:o,dispatch:i})=>{let l=I(o.selection,a=>{var f;let m=(0,ke.qz)(o).resolveStack(a.from,1);for(let k=m;k;k=k.next){let{node:T}=k;if((T.from<a.from&&T.to>=a.to||T.to>a.to&&T.from<=a.from)&&(!((f=T.parent)===null||f===void 0)&&f.parent))return L.jT.range(T.to,T.from)}return a});return i(N(o,l)),!0},Gr=({state:o,dispatch:i})=>{let l=o.selection,a=null;return l.ranges.length>1?a=L.jT.create([l.main]):l.main.empty||(a=L.jT.create([L.jT.cursor(l.main.head)])),a?(i(N(o,a)),!0):!1};function O(o,i){if(o.state.readOnly)return!1;let l="delete.selection",{state:a}=o,f=a.changeByRange(m=>{let{from:k,to:T}=m;if(k==T){let B=i(m);B<k?(l="delete.backward",B=g(o,B,!1)):B>k&&(l="delete.forward",B=g(o,B,!0)),k=Math.min(k,B),T=Math.max(T,B)}else k=g(o,k,!1),T=g(o,T,!0);return k==T?{range:m}:{changes:{from:k,to:T},range:L.jT.cursor(k,k<m.head?-1:1)}});return f.changes.empty?!1:(o.dispatch(a.update(f,{scrollIntoView:!0,userEvent:l,effects:l=="delete.selection"?G.tk.announce.of(a.phrase("Selection deleted")):void 0})),!0)}function g(o,i,l){if(o instanceof G.tk)for(let a of o.state.facet(G.tk.atomicRanges).map(f=>f(o)))a.between(i,i,(f,m)=>{f<i&&m>i&&(i=l?m:f)});return i}const S=(o,i)=>O(o,l=>{let a=l.from,{state:f}=o,m=f.doc.lineAt(a),k,T;if(!i&&a>m.from&&a<m.from+200&&!/[^ \t]/.test(k=m.text.slice(0,a-m.from))){if(k[k.length-1]=="	")return a-1;let B=(0,L.IS)(k,f.tabSize),J=B%(0,ke.y1)(f)||(0,ke.y1)(f);for(let q=0;q<J&&k[k.length-1-q]==" ";q++)a--;T=a}else T=(0,L.cp)(m.text,a-m.from,i,i)+m.from,T==a&&m.number!=(i?f.doc.lines:1)&&(T+=i?1:-1);return T}),P=o=>S(o,!1),F=o=>S(o,!0),K=(o,i)=>O(o,l=>{let a=l.head,{state:f}=o,m=f.doc.lineAt(a),k=f.charCategorizer(a);for(let T=null;;){if(a==(i?m.to:m.from)){a==l.head&&m.number!=(i?f.doc.lines:1)&&(a+=i?1:-1);break}let B=(0,L.cp)(m.text,a-m.from,i)+m.from,J=m.text.slice(Math.min(a,B)-m.from,Math.max(a,B)-m.from),q=k(J);if(T!=null&&q!=T)break;(J!=" "||a!=l.head)&&(T=q),a=B}return a}),U=o=>K(o,!1),se=o=>K(o,!0),ae=o=>O(o,i=>{let l=o.lineBlockAt(i.head).to;return i.head<l?l:Math.min(o.state.doc.length,i.head+1)}),Ze=o=>O(o,i=>{let l=o.lineBlockAt(i.head).from;return i.head>l?l:Math.max(0,i.head-1)}),Ye=o=>O(o,i=>{let l=o.moveToLineBoundary(i,!1).head;return i.head>l?l:Math.max(0,i.head-1)}),Kt=o=>O(o,i=>{let l=o.moveToLineBoundary(i,!0).head;return i.head<l?l:Math.min(o.state.doc.length,i.head+1)}),Qi=({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=[];for(let a=0,f="",m=o.doc.iter();;){if(m.next(),m.lineBreak||m.done){let k=f.search(/\s+$/);if(k>-1&&l.push({from:a-(f.length-k),to:a}),m.done)break;f=""}else f=m.value;a+=m.value.length}return l.length?(i(o.update({changes:l,userEvent:"delete"})),!0):!1},zi=({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=o.changeByRange(a=>({changes:{from:a.from,to:a.to,insert:L.xv.of(["",""])},range:L.jT.cursor(a.from)}));return i(o.update(l,{scrollIntoView:!0,userEvent:"input"})),!0},wn=({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=o.changeByRange(a=>{if(!a.empty||a.from==0||a.from==o.doc.length)return{range:a};let f=a.from,m=o.doc.lineAt(f),k=f==m.from?f-1:(0,L.cp)(m.text,f-m.from,!1)+m.from,T=f==m.to?f+1:(0,L.cp)(m.text,f-m.from,!0)+m.from;return{changes:{from:k,to:T,insert:o.doc.slice(f,T).append(o.doc.slice(k,f))},range:L.jT.cursor(T)}});return l.changes.empty?!1:(i(o.update(l,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function ln(o){let i=[],l=-1;for(let a of o.selection.ranges){let f=o.doc.lineAt(a.from),m=o.doc.lineAt(a.to);if(!a.empty&&a.to==m.from&&(m=o.doc.lineAt(a.to-1)),l>=f.number){let k=i[i.length-1];k.to=m.to,k.ranges.push(a)}else i.push({from:f.from,to:m.to,ranges:[a]});l=m.number+1}return i}function cr(o,i,l){if(o.readOnly)return!1;let a=[],f=[];for(let m of ln(o)){if(l?m.to==o.doc.length:m.from==0)continue;let k=o.doc.lineAt(l?m.to+1:m.from-1),T=k.length+1;if(l){a.push({from:m.to,to:k.to},{from:m.from,insert:k.text+o.lineBreak});for(let B of m.ranges)f.push(L.jT.range(Math.min(o.doc.length,B.anchor+T),Math.min(o.doc.length,B.head+T)))}else{a.push({from:k.from,to:m.from},{from:m.to,insert:o.lineBreak+k.text});for(let B of m.ranges)f.push(L.jT.range(B.anchor-T,B.head-T))}}return a.length?(i(o.update({changes:a,scrollIntoView:!0,selection:L.jT.create(f,o.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Bt=({state:o,dispatch:i})=>cr(o,i,!1),Sn=({state:o,dispatch:i})=>cr(o,i,!0);function un(o,i,l){if(o.readOnly)return!1;let a=[];for(let f of ln(o))l?a.push({from:f.from,insert:o.doc.slice(f.from,f.to)+o.lineBreak}):a.push({from:f.to,insert:o.lineBreak+o.doc.slice(f.from,f.to)});return i(o.update({changes:a,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Gn=({state:o,dispatch:i})=>un(o,i,!1),Nn=({state:o,dispatch:i})=>un(o,i,!0),an=o=>{if(o.state.readOnly)return!1;let{state:i}=o,l=i.changes(ln(i).map(({from:f,to:m})=>(f>0?f--:m<i.doc.length&&m++,{from:f,to:m}))),a=I(i.selection,f=>o.moveVertically(f,!0)).map(l);return o.dispatch({changes:l,selection:a,scrollIntoView:!0,userEvent:"delete.line"}),!0},Rr=({state:o,dispatch:i})=>(i(o.update(o.replaceSelection(o.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0);function fr(o,i){if(/\(\)|\[\]|\{\}/.test(o.sliceDoc(i-1,i+1)))return{from:i,to:i};let l=(0,ke.qz)(o).resolveInner(i),a=l.childBefore(i),f=l.childAfter(i),m;return a&&f&&a.to<=i&&f.from>=i&&(m=a.type.prop(Ie.md.closedBy))&&m.indexOf(f.name)>-1&&o.doc.lineAt(a.to).from==o.doc.lineAt(f.from).from&&!/\S/.test(o.sliceDoc(a.to,f.from))?{from:a.to,to:f.from}:null}const Br=Xn(!1),Pn=Xn(!0);function Xn(o){return({state:i,dispatch:l})=>{if(i.readOnly)return!1;let a=i.changeByRange(f=>{let{from:m,to:k}=f,T=i.doc.lineAt(m),B=!o&&m==k&&fr(i,m);o&&(m=k=(k<=T.to?T:i.doc.lineAt(k)).to);let J=new ke.Gn(i,{simulateBreak:m,simulateDoubleBreak:!!B}),q=(0,ke.K0)(J,m);for(q==null&&(q=(0,L.IS)(/^\s*/.exec(i.doc.lineAt(m).text)[0],i.tabSize));k<T.to&&/\s/.test(T.text[k-T.from]);)k++;B?{from:m,to:k}=B:m>T.from&&m<T.from+100&&!/\S/.test(T.text.slice(0,m))&&(m=T.from);let pe=["",(0,ke.SS)(i,q)];return B&&pe.push((0,ke.SS)(i,J.lineIndent(T.from,-1))),{changes:{from:m,to:k,insert:L.xv.of(pe)},range:L.jT.cursor(m+1+pe[1].length)}});return l(i.update(a,{scrollIntoView:!0,userEvent:"input"})),!0}}function Yn(o,i){let l=-1;return o.changeByRange(a=>{let f=[];for(let k=a.from;k<=a.to;){let T=o.doc.lineAt(k);T.number>l&&(a.empty||a.to>T.from)&&(i(T,f,a),l=T.number),k=T.to+1}let m=o.changes(f);return{changes:f,range:L.jT.range(m.mapPos(a.anchor,1),m.mapPos(a.head,1))}})}const Xr=({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=Object.create(null),a=new ke.Gn(o,{overrideIndentation:m=>{let k=l[m];return k==null?-1:k}}),f=Yn(o,(m,k,T)=>{let B=(0,ke.K0)(a,m.from);if(B==null)return;/\S/.test(m.text)||(B=0);let J=/^\s*/.exec(m.text)[0],q=(0,ke.SS)(o,B);(J!=q||T.from<m.from+J.length)&&(l[m.from]=B,k.push({from:m.from,to:m.from+J.length,insert:q}))});return f.changes.empty||i(o.update(f,{userEvent:"indent"})),!0},Lr=({state:o,dispatch:i})=>o.readOnly?!1:(i(o.update(Yn(o,(l,a)=>{a.push({from:l.from,insert:o.facet(ke.c)})}),{userEvent:"input.indent"})),!0),Ss=({state:o,dispatch:i})=>o.readOnly?!1:(i(o.update(Yn(o,(l,a)=>{let f=/^\s*/.exec(l.text)[0];if(!f)return;let m=(0,L.IS)(f,o.tabSize),k=0,T=(0,ke.SS)(o,Math.max(0,m-(0,ke.y1)(o)));for(;k<f.length&&k<T.length&&f.charCodeAt(k)==T.charCodeAt(k);)k++;a.push({from:l.from+k,to:l.from+f.length,insert:T.slice(k)})}),{userEvent:"delete.dedent"})),!0),Ys=({state:o,dispatch:i})=>o.selection.ranges.some(l=>!l.empty)?Lr({state:o,dispatch:i}):(i(o.update(o.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),ks=[{key:"Ctrl-b",run:We,shift:fi,preventDefault:!0},{key:"Ctrl-f",run:Ee,shift:fn},{key:"Ctrl-p",run:st,shift:fe},{key:"Ctrl-n",run:Vt,shift:be},{key:"Ctrl-a",run:nn,shift:ar},{key:"Ctrl-e",run:Ni,shift:zt},{key:"Ctrl-d",run:F},{key:"Ctrl-h",run:P},{key:"Ctrl-k",run:ae},{key:"Ctrl-Alt-h",run:U},{key:"Ctrl-o",run:zi},{key:"Ctrl-t",run:wn},{key:"Ctrl-v",run:Ri}],Yr=[{key:"ArrowLeft",run:We,shift:fi,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Qt,shift:R,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Si,shift:Jn,preventDefault:!0},{key:"ArrowRight",run:Ee,shift:fn,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:kt,shift:c,preventDefault:!0},{mac:"Cmd-ArrowRight",run:ki,shift:xn,preventDefault:!0},{key:"ArrowUp",run:st,shift:fe,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Ur,shift:Dr},{mac:"Ctrl-ArrowUp",run:Pi,shift:De},{key:"ArrowDown",run:Vt,shift:be,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Er,shift:Un},{mac:"Ctrl-ArrowDown",run:Ri,shift:Zt},{key:"PageUp",run:Pi,shift:De},{key:"PageDown",run:Ri,shift:Zt},{key:"Home",run:ei,shift:yi,preventDefault:!0},{key:"Mod-Home",run:Ur,shift:Dr},{key:"End",run:Yi,shift:ui,preventDefault:!0},{key:"Mod-End",run:Er,shift:Un},{key:"Enter",run:Br},{key:"Mod-a",run:Or},{key:"Backspace",run:P,shift:P},{key:"Delete",run:F},{key:"Mod-Backspace",mac:"Alt-Backspace",run:U},{key:"Mod-Delete",mac:"Alt-Delete",run:se},{mac:"Mod-Backspace",run:Ye},{mac:"Mod-Delete",run:Kt}].concat(ks.map(o=>({mac:o.key,run:o.run,shift:o.shift}))),qs=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:ut,shift:z},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Rt,shift:j},{key:"Alt-ArrowUp",run:Bt},{key:"Shift-Alt-ArrowUp",run:Gn},{key:"Alt-ArrowDown",run:Sn},{key:"Shift-Alt-ArrowDown",run:Nn},{key:"Escape",run:Gr},{key:"Mod-Enter",run:Pn},{key:"Alt-l",mac:"Ctrl-l",run:hr},{key:"Mod-i",run:Pr,preventDefault:!0},{key:"Mod-[",run:Ss},{key:"Mod-]",run:Lr},{key:"Mod-Alt-\\",run:Xr},{key:"Shift-Mod-k",run:an},{key:"Shift-Mod-\\",run:Fi},{key:"Mod-/",run:xt},{key:"Alt-A",run:et}].concat(Yr),Cs={key:"Tab",run:Lr,shift:Ss};function ti(){var o=arguments[0];typeof o=="string"&&(o=document.createElement(o));var i=1,l=arguments[1];if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){for(var a in l)if(Object.prototype.hasOwnProperty.call(l,a)){var f=l[a];typeof f=="string"?o.setAttribute(a,f):f!=null&&(o[a]=f)}i++}for(;i<arguments.length;i++)ur(o,arguments[i]);return o}function ur(o,i){if(typeof i=="string")o.appendChild(document.createTextNode(i));else if(i!=null)if(i.nodeType!=null)o.appendChild(i);else if(Array.isArray(i))for(var l=0;l<i.length;l++)ur(o,i[l]);else throw new RangeError("Unsupported child node: "+i)}const As=typeof String.prototype.normalize=="function"?o=>o.normalize("NFKD"):o=>o;class dr{constructor(i,l,a=0,f=i.length,m,k){this.test=k,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=i.iterRange(a,f),this.bufferStart=a,this.normalize=m?T=>m(As(T)):As,this.query=this.normalize(l)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return(0,L.gm)(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let i=this.peek();if(i<0)return this.done=!0,this;let l=(0,L.bg)(i),a=this.bufferStart+this.bufferPos;this.bufferPos+=(0,L.nZ)(i);let f=this.normalize(l);for(let m=0,k=a;;m++){let T=f.charCodeAt(m),B=this.match(T,k);if(m==f.length-1){if(B)return this.value=B,this;break}k==a&&m<l.length&&l.charCodeAt(m)==T&&k++}}}match(i,l){let a=null;for(let f=0;f<this.matches.length;f+=2){let m=this.matches[f],k=!1;this.query.charCodeAt(m)==i&&(m==this.query.length-1?a={from:this.matches[f+1],to:l+1}:(this.matches[f]++,k=!0)),k||(this.matches.splice(f,2),f-=2)}return this.query.charCodeAt(0)==i&&(this.query.length==1?a={from:l,to:l+1}:this.matches.push(1,l)),a&&this.test&&!this.test(a.from,a.to,this.buffer,this.bufferStart)&&(a=null),a}}typeof Symbol!="undefined"&&(dr.prototype[Symbol.iterator]=function(){return this});const qn={from:-1,to:-1,match:/.*/.exec("")},as="gm"+(/x/.unicode==null?"":"u");class Ts{constructor(i,l,a,f=0,m=i.length){if(this.text=i,this.to=m,this.curLine="",this.done=!1,this.value=qn,/\\[sWDnr]|\n|\r|\[\^/.test(l))return new dn(i,l,a,f,m);this.re=new RegExp(l,as+(a!=null&&a.ignoreCase?"i":"")),this.test=a==null?void 0:a.test,this.iter=i.iter();let k=i.lineAt(f);this.curLineStart=k.from,this.matchPos=Qr(i,f),this.getLine(this.curLineStart)}getLine(i){this.iter.next(i),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let i=this.matchPos-this.curLineStart;;){this.re.lastIndex=i;let l=this.matchPos<=this.to&&this.re.exec(this.curLine);if(l){let a=this.curLineStart+l.index,f=a+l[0].length;if(this.matchPos=Qr(this.text,f+(a==f?1:0)),a==this.curLineStart+this.curLine.length&&this.nextLine(),(a<f||a>this.value.to)&&(!this.test||this.test(a,f,l)))return this.value={from:a,to:f,match:l},this;i=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),i=0;else return this.done=!0,this}}}const qr=new WeakMap;class $i{constructor(i,l){this.from=i,this.text=l}get to(){return this.from+this.text.length}static get(i,l,a){let f=qr.get(i);if(!f||f.from>=a||f.to<=l){let T=new $i(l,i.sliceString(l,a));return qr.set(i,T),T}if(f.from==l&&f.to==a)return f;let{text:m,from:k}=f;return k>l&&(m=i.sliceString(l,k)+m,k=l),f.to<a&&(m+=i.sliceString(f.to,a)),qr.set(i,new $i(k,m)),new $i(l,m.slice(l-k,a-k))}}class dn{constructor(i,l,a,f,m){this.text=i,this.to=m,this.done=!1,this.value=qn,this.matchPos=Qr(i,f),this.re=new RegExp(l,as+(a!=null&&a.ignoreCase?"i":"")),this.test=a==null?void 0:a.test,this.flat=$i.get(i,f,this.chunkEnd(f+5e3))}chunkEnd(i){return i>=this.to?this.to:this.text.lineAt(i).to}next(){for(;;){let i=this.re.lastIndex=this.matchPos-this.flat.from,l=this.re.exec(this.flat.text);if(l&&!l[0]&&l.index==i&&(this.re.lastIndex=i+1,l=this.re.exec(this.flat.text)),l){let a=this.flat.from+l.index,f=a+l[0].length;if((this.flat.to>=this.to||l.index+l[0].length<=this.flat.text.length-10)&&(!this.test||this.test(a,f,l)))return this.value={from:a,to:f,match:l},this.matchPos=Qr(this.text,f+(a==f?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=$i.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol!="undefined"&&(Ts.prototype[Symbol.iterator]=dn.prototype[Symbol.iterator]=function(){return this});function Ms(o){try{return new RegExp(o,as),!0}catch{return!1}}function Qr(o,i){if(i>=o.length)return i;let l=o.lineAt(i),a;for(;i<l.to&&(a=l.text.charCodeAt(i-l.from))>=56320&&a<57344;)i++;return i}function pr(o){let i=String(o.state.doc.lineAt(o.state.selection.main.head).number),l=ti("input",{class:"cm-textfield",name:"line",value:i}),a=ti("form",{class:"cm-gotoLine",onkeydown:m=>{m.keyCode==27?(m.preventDefault(),o.dispatch({effects:Ir.of(!1)}),o.focus()):m.keyCode==13&&(m.preventDefault(),f())},onsubmit:m=>{m.preventDefault(),f()}},ti("label",o.state.phrase("Go to line"),": ",l)," ",ti("button",{class:"cm-button",type:"submit"},o.state.phrase("go")));function f(){let m=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(l.value);if(!m)return;let{state:k}=o,T=k.doc.lineAt(k.selection.main.head),[,B,J,q,pe]=m,Re=q?+q.slice(1):0,at=J?+J:T.number;if(J&&pe){let Zn=at/100;B&&(Zn=Zn*(B=="-"?-1:1)+T.number/k.doc.lines),at=Math.round(k.doc.lines*Zn)}else J&&B&&(at=at*(B=="-"?-1:1)+T.number);let ri=k.doc.line(Math.max(1,Math.min(k.doc.lines,at))),Gi=L.jT.cursor(ri.from+Math.max(0,Math.min(Re,ri.length)));o.dispatch({effects:[Ir.of(!1),G.tk.scrollIntoView(Gi.from,{y:"center"})],selection:Gi}),o.focus()}return{dom:a}}const Ir=L.Py.define(),hs=L.QQ.define({create(){return!0},update(o,i){for(let l of i.effects)l.is(Ir)&&(o=l.value);return o},provide:o=>G.mH.from(o,i=>i?pr:null)}),Es=o=>{let i=(0,G.Sd)(o,pr);if(!i){let l=[Ir.of(!0)];o.state.field(hs,!1)==null&&l.push(L.Py.appendConfig.of([hs,Qs])),o.dispatch({effects:l}),i=(0,G.Sd)(o,pr)}return i&&i.dom.querySelector("input").select(),!0},Qs=G.tk.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Ds={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},Os=L.r$.define({combine(o){return(0,L.BO)(o,Ds,{highlightWordAroundCursor:(i,l)=>i||l,minSelectionLength:Math.min,maxMatches:Math.min})}});function _r(o){let i=[Rs,eo];return o&&i.push(Os.of(o)),i}const es=G.p.mark({class:"cm-selectionMatch"}),Ps=G.p.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function cs(o,i,l,a){return(l==0||o(i.sliceDoc(l-1,l))!=L.D0.Word)&&(a==i.doc.length||o(i.sliceDoc(a,a+1))!=L.D0.Word)}function _s(o,i,l,a){return o(i.sliceDoc(l,l+1))==L.D0.Word&&o(i.sliceDoc(a-1,a))==L.D0.Word}const eo=G.lg.fromClass(class{constructor(o){this.decorations=this.getDeco(o)}update(o){(o.selectionSet||o.docChanged||o.viewportChanged)&&(this.decorations=this.getDeco(o.view))}getDeco(o){let i=o.state.facet(Os),{state:l}=o,a=l.selection;if(a.ranges.length>1)return G.p.none;let f=a.main,m,k=null;if(f.empty){if(!i.highlightWordAroundCursor)return G.p.none;let B=l.wordAt(f.head);if(!B)return G.p.none;k=l.charCategorizer(f.head),m=l.sliceDoc(B.from,B.to)}else{let B=f.to-f.from;if(B<i.minSelectionLength||B>200)return G.p.none;if(i.wholeWords){if(m=l.sliceDoc(f.from,f.to),k=l.charCategorizer(f.head),!(cs(k,l,f.from,f.to)&&_s(k,l,f.from,f.to)))return G.p.none}else if(m=l.sliceDoc(f.from,f.to).trim(),!m)return G.p.none}let T=[];for(let B of o.visibleRanges){let J=new dr(l.doc,m,B.from,B.to);for(;!J.next().done;){let{from:q,to:pe}=J.value;if((!k||cs(k,l,q,pe))&&(f.empty&&q<=f.from&&pe>=f.to?T.push(Ps.range(q,pe)):(q>=f.to||pe<=f.from)&&T.push(es.range(q,pe)),T.length>i.maxMatches))return G.p.none}}return G.p.set(T)}},{decorations:o=>o.decorations}),Rs=G.tk.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),to=({state:o,dispatch:i})=>{let{selection:l}=o,a=L.jT.create(l.ranges.map(f=>o.wordAt(f.head)||L.jT.cursor(f.head)),l.mainIndex);return a.eq(l)?!1:(i(o.update({selection:a})),!0)};function V(o,i){let{main:l,ranges:a}=o.selection,f=o.wordAt(l.head),m=f&&f.from==l.from&&f.to==l.to;for(let k=!1,T=new dr(o.doc,i,a[a.length-1].to);;)if(T.next(),T.done){if(k)return null;T=new dr(o.doc,i,0,Math.max(0,a[a.length-1].from-1)),k=!0}else{if(k&&a.some(B=>B.from==T.value.from))continue;if(m){let B=o.wordAt(T.value.from);if(!B||B.from!=T.value.from||B.to!=T.value.to)continue}return T.value}}const H=({state:o,dispatch:i})=>{let{ranges:l}=o.selection;if(l.some(m=>m.from===m.to))return to({state:o,dispatch:i});let a=o.sliceDoc(l[0].from,l[0].to);if(o.selection.ranges.some(m=>o.sliceDoc(m.from,m.to)!=a))return!1;let f=V(o,a);return f?(i(o.update({selection:o.selection.addRange(L.jT.range(f.from,f.to),!1),effects:G.tk.scrollIntoView(f.to)})),!0):!1},Y=L.r$.define({combine(o){return(0,L.BO)(o,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:i=>new yr(i),scrollToMatch:i=>G.tk.scrollIntoView(i)})}});function te(o){return o?[Y.of(o),cn]:cn}class he{constructor(i){this.search=i.search,this.caseSensitive=!!i.caseSensitive,this.literal=!!i.literal,this.regexp=!!i.regexp,this.replace=i.replace||"",this.valid=!!this.search&&(!this.regexp||Ms(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!i.wholeWord}unquote(i){return this.literal?i:i.replace(/\\([nrt\\])/g,(l,a)=>a=="n"?`
`:a=="r"?"\r":a=="t"?"	":"\\")}eq(i){return this.search==i.search&&this.replace==i.replace&&this.caseSensitive==i.caseSensitive&&this.regexp==i.regexp&&this.wholeWord==i.wholeWord}create(){return this.regexp?new nt(this):new $t(this)}getCursor(i,l=0,a){let f=i.doc?i:L.yy.create({doc:i});return a==null&&(a=f.doc.length),this.regexp?dt(this,f,l,a):xe(this,f,l,a)}}class me{constructor(i){this.spec=i}}function xe(o,i,l,a){return new dr(i.doc,o.unquoted,l,a,o.caseSensitive?void 0:f=>f.toLowerCase(),o.wholeWord?Le(i.doc,i.charCategorizer(i.selection.main.head)):void 0)}function Le(o,i){return(l,a,f,m)=>((m>l||m+f.length<a)&&(m=Math.max(0,l-2),f=o.sliceString(m,Math.min(o.length,a+2))),(i(Ne(f,l-m))!=L.D0.Word||i(we(f,l-m))!=L.D0.Word)&&(i(we(f,a-m))!=L.D0.Word||i(Ne(f,a-m))!=L.D0.Word))}class $t extends me{constructor(i){super(i)}nextMatch(i,l,a){let f=xe(this.spec,i,a,i.doc.length).nextOverlapping();return f.done&&(f=xe(this.spec,i,0,l).nextOverlapping()),f.done?null:f.value}prevMatchInRange(i,l,a){for(let f=a;;){let m=Math.max(l,f-1e4-this.spec.unquoted.length),k=xe(this.spec,i,m,f),T=null;for(;!k.nextOverlapping().done;)T=k.value;if(T)return T;if(m==l)return null;f-=1e4}}prevMatch(i,l,a){return this.prevMatchInRange(i,0,l)||this.prevMatchInRange(i,a,i.doc.length)}getReplacement(i){return this.spec.unquote(this.spec.replace)}matchAll(i,l){let a=xe(this.spec,i,0,i.doc.length),f=[];for(;!a.next().done;){if(f.length>=l)return null;f.push(a.value)}return f}highlight(i,l,a,f){let m=xe(this.spec,i,Math.max(0,l-this.spec.unquoted.length),Math.min(a+this.spec.unquoted.length,i.doc.length));for(;!m.next().done;)f(m.value.from,m.value.to)}}function dt(o,i,l,a){return new Ts(i.doc,o.search,{ignoreCase:!o.caseSensitive,test:o.wholeWord?He(i.charCategorizer(i.selection.main.head)):void 0},l,a)}function Ne(o,i){return o.slice((0,L.cp)(o,i,!1),i)}function we(o,i){return o.slice(i,(0,L.cp)(o,i))}function He(o){return(i,l,a)=>!a[0].length||(o(Ne(a.input,a.index))!=L.D0.Word||o(we(a.input,a.index))!=L.D0.Word)&&(o(we(a.input,a.index+a[0].length))!=L.D0.Word||o(Ne(a.input,a.index+a[0].length))!=L.D0.Word)}class nt extends me{nextMatch(i,l,a){let f=dt(this.spec,i,a,i.doc.length).next();return f.done&&(f=dt(this.spec,i,0,l).next()),f.done?null:f.value}prevMatchInRange(i,l,a){for(let f=1;;f++){let m=Math.max(l,a-f*1e4),k=dt(this.spec,i,m,a),T=null;for(;!k.next().done;)T=k.value;if(T&&(m==l||T.from>m+10))return T;if(m==l)return null}}prevMatch(i,l,a){return this.prevMatchInRange(i,0,l)||this.prevMatchInRange(i,a,i.doc.length)}getReplacement(i){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(l,a)=>a=="$"?"$":a=="&"?i.match[0]:a!="0"&&+a<i.match.length?i.match[a]:l))}matchAll(i,l){let a=dt(this.spec,i,0,i.doc.length),f=[];for(;!a.next().done;){if(f.length>=l)return null;f.push(a.value)}return f}highlight(i,l,a,f){let m=dt(this.spec,i,Math.max(0,l-250),Math.min(a+250,i.doc.length));for(;!m.next().done;)f(m.value.from,m.value.to)}}const pt=L.Py.define(),Mt=L.Py.define(),bt=L.QQ.define({create(o){return new Ei(Ai(o).create(),null)},update(o,i){for(let l of i.effects)l.is(pt)?o=new Ei(l.value.create(),o.panel):l.is(Mt)&&(o=new Ei(o.query,l.value?en:null));return o},provide:o=>G.mH.from(o,i=>i.panel)});function ji(o){let i=o.field(bt,!1);return i?i.query.spec:Ai(o)}function Zi(o){var i;return((i=o.field(bt,!1))===null||i===void 0?void 0:i.panel)!=null}class Ei{constructor(i,l){this.query=i,this.panel=l}}const Wi=G.p.mark({class:"cm-searchMatch"}),rn=G.p.mark({class:"cm-searchMatch cm-searchMatch-selected"}),qt=G.lg.fromClass(class{constructor(o){this.view=o,this.decorations=this.highlight(o.state.field(bt))}update(o){let i=o.state.field(bt);(i!=o.startState.field(bt)||o.docChanged||o.selectionSet||o.viewportChanged)&&(this.decorations=this.highlight(i))}highlight({query:o,panel:i}){if(!i||!o.spec.valid)return G.p.none;let{view:l}=this,a=new L.f_;for(let f=0,m=l.visibleRanges,k=m.length;f<k;f++){let{from:T,to:B}=m[f];for(;f<k-1&&B>m[f+1].from-2*250;)B=m[++f].to;o.highlight(l.state,T,B,(J,q)=>{let pe=l.state.selection.ranges.some(Re=>Re.from==J&&Re.to==q);a.add(J,q,pe?rn:Wi)})}return a.finish()}},{decorations:o=>o.decorations});function pn(o){return i=>{let l=i.state.field(bt,!1);return l&&l.query.spec.valid?o(i,l):Cn(i)}}const ai=pn((o,{query:i})=>{let{to:l}=o.state.selection.main,a=i.nextMatch(o.state,l,l);if(!a)return!1;let f=L.jT.single(a.from,a.to),m=o.state.facet(Y);return o.dispatch({selection:f,effects:[Qn(o,a),m.scrollToMatch(f.main,o)],userEvent:"select.search"}),mr(o),!0}),vi=pn((o,{query:i})=>{let{state:l}=o,{from:a}=l.selection.main,f=i.prevMatch(l,a,a);if(!f)return!1;let m=L.jT.single(f.from,f.to),k=o.state.facet(Y);return o.dispatch({selection:m,effects:[Qn(o,f),k.scrollToMatch(m.main,o)],userEvent:"select.search"}),mr(o),!0}),_i=pn((o,{query:i})=>{let l=i.matchAll(o.state,1e3);return!l||!l.length?!1:(o.dispatch({selection:L.jT.create(l.map(a=>L.jT.range(a.from,a.to))),userEvent:"select.search.matches"}),!0)}),kn=({state:o,dispatch:i})=>{let l=o.selection;if(l.ranges.length>1||l.main.empty)return!1;let{from:a,to:f}=l.main,m=[],k=0;for(let T=new dr(o.doc,o.sliceDoc(a,f));!T.next().done;){if(m.length>1e3)return!1;T.value.from==a&&(k=m.length),m.push(L.jT.range(T.value.from,T.value.to))}return i(o.update({selection:L.jT.create(m,k),userEvent:"select.search.matches"})),!0},Tn=pn((o,{query:i})=>{let{state:l}=o,{from:a,to:f}=l.selection.main;if(l.readOnly)return!1;let m=i.nextMatch(l,a,a);if(!m)return!1;let k=[],T,B,J=[];if(m.from==a&&m.to==f&&(B=l.toText(i.getReplacement(m)),k.push({from:m.from,to:m.to,insert:B}),m=i.nextMatch(l,m.from,m.to),J.push(G.tk.announce.of(l.phrase("replaced match on line $",l.doc.lineAt(a).number)+"."))),m){let q=k.length==0||k[0].from>=m.to?0:m.to-m.from-B.length;T=L.jT.single(m.from-q,m.to-q),J.push(Qn(o,m)),J.push(l.facet(Y).scrollToMatch(T.main,o))}return o.dispatch({changes:k,selection:T,effects:J,userEvent:"input.replace"}),!0}),Ci=pn((o,{query:i})=>{if(o.state.readOnly)return!1;let l=i.matchAll(o.state,1e9).map(f=>{let{from:m,to:k}=f;return{from:m,to:k,insert:i.getReplacement(f)}});if(!l.length)return!1;let a=o.state.phrase("replaced $ matches",l.length)+".";return o.dispatch({changes:l,effects:G.tk.announce.of(a),userEvent:"input.replace.all"}),!0});function en(o){return o.state.facet(Y).createPanel(o)}function Ai(o,i){var l,a,f,m,k;let T=o.selection.main,B=T.empty||T.to>T.from+100?"":o.sliceDoc(T.from,T.to);if(i&&!B)return i;let J=o.facet(Y);return new he({search:((l=i==null?void 0:i.literal)!==null&&l!==void 0?l:J.literal)?B:B.replace(/\n/g,"\\n"),caseSensitive:(a=i==null?void 0:i.caseSensitive)!==null&&a!==void 0?a:J.caseSensitive,literal:(f=i==null?void 0:i.literal)!==null&&f!==void 0?f:J.literal,regexp:(m=i==null?void 0:i.regexp)!==null&&m!==void 0?m:J.regexp,wholeWord:(k=i==null?void 0:i.wholeWord)!==null&&k!==void 0?k:J.wholeWord})}function ts(o){let i=(0,G.Sd)(o,en);return i&&i.dom.querySelector("[main-field]")}function mr(o){let i=ts(o);i&&i==o.root.activeElement&&i.select()}const Cn=o=>{let i=o.state.field(bt,!1);if(i&&i.panel){let l=ts(o);if(l&&l!=o.root.activeElement){let a=Ai(o.state,i.query.spec);a.valid&&o.dispatch({effects:pt.of(a)}),l.focus(),l.select()}}else o.dispatch({effects:[Mt.of(!0),i?pt.of(Ai(o.state,i.query.spec)):L.Py.appendConfig.of(cn)]});return!0},Rn=o=>{let i=o.state.field(bt,!1);if(!i||!i.panel)return!1;let l=(0,G.Sd)(o,en);return l&&l.dom.contains(o.root.activeElement)&&o.focus(),o.dispatch({effects:Mt.of(!1)}),!0},gr=[{key:"Mod-f",run:Cn,scope:"editor search-panel"},{key:"F3",run:ai,shift:vi,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:ai,shift:vi,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Rn,scope:"editor search-panel"},{key:"Mod-Shift-l",run:kn},{key:"Alt-g",run:Es},{key:"Mod-d",run:H,preventDefault:!0}];class yr{constructor(i){this.view=i;let l=this.query=i.state.field(bt).query.spec;this.commit=this.commit.bind(this),this.searchField=ti("input",{value:l.search,placeholder:ni(i,"Find"),"aria-label":ni(i,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ti("input",{value:l.replace,placeholder:ni(i,"Replace"),"aria-label":ni(i,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ti("input",{type:"checkbox",name:"case",form:"",checked:l.caseSensitive,onchange:this.commit}),this.reField=ti("input",{type:"checkbox",name:"re",form:"",checked:l.regexp,onchange:this.commit}),this.wordField=ti("input",{type:"checkbox",name:"word",form:"",checked:l.wholeWord,onchange:this.commit});function a(f,m,k){return ti("button",{class:"cm-button",name:f,onclick:m,type:"button"},k)}this.dom=ti("div",{onkeydown:f=>this.keydown(f),class:"cm-search"},[this.searchField,a("next",()=>ai(i),[ni(i,"next")]),a("prev",()=>vi(i),[ni(i,"previous")]),a("select",()=>_i(i),[ni(i,"all")]),ti("label",null,[this.caseField,ni(i,"match case")]),ti("label",null,[this.reField,ni(i,"regexp")]),ti("label",null,[this.wordField,ni(i,"by word")]),...i.state.readOnly?[]:[ti("br"),this.replaceField,a("replace",()=>Tn(i),[ni(i,"replace")]),a("replaceAll",()=>Ci(i),[ni(i,"replace all")])],ti("button",{name:"close",onclick:()=>Rn(i),"aria-label":ni(i,"close"),type:"button"},["\xD7"])])}commit(){let i=new he({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});i.eq(this.query)||(this.query=i,this.view.dispatch({effects:pt.of(i)}))}keydown(i){(0,G.$1)(this.view,i,"search-panel")?i.preventDefault():i.keyCode==13&&i.target==this.searchField?(i.preventDefault(),(i.shiftKey?vi:ai)(this.view)):i.keyCode==13&&i.target==this.replaceField&&(i.preventDefault(),Tn(this.view))}update(i){for(let l of i.transactions)for(let a of l.effects)a.is(pt)&&!a.value.eq(this.query)&&this.setQuery(a.value)}setQuery(i){this.query=i,this.searchField.value=i.search,this.replaceField.value=i.replace,this.caseField.checked=i.caseSensitive,this.reField.checked=i.regexp,this.wordField.checked=i.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Y).top}}function ni(o,i){return o.state.phrase(i)}const mn=30,hn=/[\s\.,:;?!]/;function Qn(o,{from:i,to:l}){let a=o.state.doc.lineAt(i),f=o.state.doc.lineAt(l).to,m=Math.max(a.from,i-mn),k=Math.min(f,l+mn),T=o.state.sliceDoc(m,k);if(m!=a.from){for(let B=0;B<mn;B++)if(!hn.test(T[B+1])&&hn.test(T[B])){T=T.slice(B);break}}if(k!=f){for(let B=T.length-1;B>T.length-mn;B--)if(!hn.test(T[B-1])&&hn.test(T[B])){T=T.slice(0,B);break}}return G.tk.announce.of(`${o.state.phrase("current match")}. ${T} ${o.state.phrase("on line")} ${a.number}.`)}const vr=G.tk.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),cn=[bt,L.Wl.low(qt),vr];class Bn{constructor(i,l,a){this.state=i,this.pos=l,this.explicit=a,this.abortListeners=[]}tokenBefore(i){let l=(0,ke.qz)(this.state).resolveInner(this.pos,-1);for(;l&&i.indexOf(l.name)<0;)l=l.parent;return l?{from:l.from,to:this.pos,text:this.state.sliceDoc(l.from,this.pos),type:l.type}:null}matchBefore(i){let l=this.state.doc.lineAt(this.pos),a=Math.max(l.from,this.pos-250),f=l.text.slice(a-l.from,this.pos-l.from),m=f.search(Wn(i,!1));return m<0?null:{from:a+m,to:this.pos,text:f.slice(m)}}get aborted(){return this.abortListeners==null}addEventListener(i,l){i=="abort"&&this.abortListeners&&this.abortListeners.push(l)}}function _n(o){let i=Object.keys(o).join(""),l=/\w/.test(i);return l&&(i=i.replace(/\w/g,"")),`[${l?"\\w":""}${i.replace(/[^\w\s]/g,"\\$&")}]`}function er(o){let i=Object.create(null),l=Object.create(null);for(let{label:f}of o){i[f[0]]=!0;for(let m=1;m<f.length;m++)l[f[m]]=!0}let a=_n(i)+_n(l)+"*$";return[new RegExp("^"+a),new RegExp(a)]}function Fn(o){let i=o.map(f=>typeof f=="string"?{label:f}:f),[l,a]=i.every(f=>/^\w+$/.test(f.label))?[/\w*$/,/\w+$/]:er(i);return f=>{let m=f.matchBefore(a);return m||f.explicit?{from:m?m.from:f.pos,options:i,validFor:l}:null}}function br(o,i){return l=>{for(let a=syntaxTree(l.state).resolveInner(l.pos,-1);a;a=a.parent){if(o.indexOf(a.name)>-1)return i(l);if(a.type.isTop)break}return null}}function fs(o,i){return l=>{for(let a=syntaxTree(l.state).resolveInner(l.pos,-1);a;a=a.parent){if(o.indexOf(a.name)>-1)return null;if(a.type.isTop)break}return i(l)}}class Mn{constructor(i,l,a,f){this.completion=i,this.source=l,this.match=a,this.score=f}}function Ki(o){return o.selection.main.from}function Wn(o,i){var l;let{source:a}=o,f=i&&a[0]!="^",m=a[a.length-1]!="$";return!f&&!m?o:new RegExp(`${f?"^":""}(?:${a})${m?"$":""}`,(l=o.flags)!==null&&l!==void 0?l:o.ignoreCase?"i":"")}const Ln=L.q6.define();function xr(o,i,l,a){let{main:f}=o.selection,m=l-f.from,k=a-f.from;return Object.assign(Object.assign({},o.changeByRange(T=>T!=f&&l!=a&&o.sliceDoc(T.from+m,T.from+k)!=o.sliceDoc(l,a)?{range:T}:{changes:{from:T.from+m,to:a==f.from?T.to:T.from+k,insert:i},range:L.jT.cursor(T.from+m+i.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const is=new WeakMap;function tr(o){if(!Array.isArray(o))return o;let i=is.get(o);return i||is.set(o,i=Fn(o)),i}const Hn=L.Py.define(),Ji=L.Py.define();class Vn{constructor(i){this.pattern=i,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let l=0;l<i.length;){let a=(0,L.gm)(i,l),f=(0,L.nZ)(a);this.chars.push(a);let m=i.slice(l,l+f),k=m.toUpperCase();this.folded.push((0,L.gm)(k==m?m.toLowerCase():k,0)),l+=f}this.astral=i.length!=this.chars.length}ret(i,l){return this.score=i,this.matched=l,!0}match(i){if(this.pattern.length==0)return this.ret(-100,[]);if(i.length<this.pattern.length)return!1;let{chars:l,folded:a,any:f,precise:m,byWord:k}=this;if(l.length==1){let Di=(0,L.gm)(i,0),sr=(0,L.nZ)(Di),On=sr==i.length?0:-100;if(Di!=l[0])if(Di==a[0])On+=-200;else return!1;return this.ret(On,[0,sr])}let T=i.indexOf(this.pattern);if(T==0)return this.ret(i.length==this.pattern.length?0:-100,[0,this.pattern.length]);let B=l.length,J=0;if(T<0){for(let Di=0,sr=Math.min(i.length,200);Di<sr&&J<B;){let On=(0,L.gm)(i,Di);(On==l[J]||On==a[J])&&(f[J++]=Di),Di+=(0,L.nZ)(On)}if(J<B)return!1}let q=0,pe=0,Re=!1,at=0,ri=-1,Gi=-1,Zn=/[a-z]/.test(i),Ar=!0;for(let Di=0,sr=Math.min(i.length,200),On=0;Di<sr&&pe<B;){let sn=(0,L.gm)(i,Di);T<0&&(q<B&&sn==l[q]&&(m[q++]=Di),at<B&&(sn==l[at]||sn==a[at]?(at==0&&(ri=Di),Gi=Di+1,at++):at=0));let Tr,Mr=sn<255?sn>=48&&sn<=57||sn>=97&&sn<=122?2:sn>=65&&sn<=90?1:0:(Tr=(0,L.bg)(sn))!=Tr.toLowerCase()?1:Tr!=Tr.toUpperCase()?2:0;(!Di||Mr==1&&Zn||On==0&&Mr!=0)&&(l[pe]==sn||a[pe]==sn&&(Re=!0)?k[pe++]=Di:k.length&&(Ar=!1)),On=Mr,Di+=(0,L.nZ)(sn)}return pe==B&&k[0]==0&&Ar?this.result(-100+(Re?-200:0),k,i):at==B&&ri==0?this.ret(-200-i.length+(Gi==i.length?0:-100),[0,Gi]):T>-1?this.ret(-700-i.length,[T,T+this.pattern.length]):at==B?this.ret(-200+-700-i.length,[ri,Gi]):pe==B?this.result(-100+(Re?-200:0)+-700+(Ar?0:-1100),k,i):l.length==2?!1:this.result((f[0]?-700:0)+-200+-1100,f,i)}result(i,l,a){let f=[],m=0;for(let k of l){let T=k+(this.astral?(0,L.nZ)((0,L.gm)(a,k)):1);m&&f[m-1]==k?f[m-1]=T:(f[m++]=k,f[m++]=T)}return this.ret(i-a.length,f)}}const ze=L.r$.define({combine(o){return(0,L.BO)(o,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Fr,compareCompletions:(i,l)=>i.label.localeCompare(l.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(i,l)=>i&&l,closeOnBlur:(i,l)=>i&&l,icons:(i,l)=>i&&l,tooltipClass:(i,l)=>a=>Nr(i(a),l(a)),optionClass:(i,l)=>a=>Nr(i(a),l(a)),addToOptions:(i,l)=>i.concat(l)})}});function Nr(o,i){return o?i?o+" "+i:o:i}function Fr(o,i,l,a,f,m){let k=o.textDirection==G.Nm.RTL,T=k,B=!1,J="top",q,pe,Re=i.left-f.left,at=f.right-i.right,ri=a.right-a.left,Gi=a.bottom-a.top;if(T&&Re<Math.min(ri,at)?T=!1:!T&&at<Math.min(ri,Re)&&(T=!0),ri<=(T?Re:at))q=Math.max(f.top,Math.min(l.top,f.bottom-Gi))-i.top,pe=Math.min(400,T?Re:at);else{B=!0,pe=Math.min(400,(k?i.right:f.right-i.left)-30);let Di=f.bottom-i.bottom;Di>=Gi||Di>i.top?q=l.bottom-i.top:(J="bottom",q=i.bottom-l.top)}let Zn=(i.bottom-i.top)/m.offsetHeight,Ar=(i.right-i.left)/m.offsetWidth;return{style:`${J}: ${q/Zn}px; max-width: ${pe/Ar}px`,class:"cm-completionInfo-"+(B?k?"left-narrow":"right-narrow":T?"left":"right")}}function wr(o){let i=o.addToOptions.slice();return o.icons&&i.push({render(l){let a=document.createElement("div");return a.classList.add("cm-completionIcon"),l.type&&a.classList.add(...l.type.split(/\s+/g).map(f=>"cm-completionIcon-"+f)),a.setAttribute("aria-hidden","true"),a},position:20}),i.push({render(l,a,f,m){let k=document.createElement("span");k.className="cm-completionLabel";let T=l.displayLabel||l.label,B=0;for(let J=0;J<m.length;){let q=m[J++],pe=m[J++];q>B&&k.appendChild(document.createTextNode(T.slice(B,q)));let Re=k.appendChild(document.createElement("span"));Re.appendChild(document.createTextNode(T.slice(q,pe))),Re.className="cm-completionMatchedText",B=pe}return B<T.length&&k.appendChild(document.createTextNode(T.slice(B))),k},position:50},{render(l){if(!l.detail)return null;let a=document.createElement("span");return a.className="cm-completionDetail",a.textContent=l.detail,a},position:80}),i.sort((l,a)=>l.position-a.position).map(l=>l.render)}function Sr(o,i,l){if(o<=l)return{from:0,to:o};if(i<0&&(i=0),i<=o>>1){let f=Math.floor(i/l);return{from:f*l,to:(f+1)*l}}let a=Math.floor((o-i)/l);return{from:o-(a+1)*l,to:o-a*l}}class Wr{constructor(i,l,a){this.view=i,this.stateField=l,this.applyCompletion=a,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:B=>this.placeInfo(B),key:this},this.space=null,this.currentClass="";let f=i.state.field(l),{options:m,selected:k}=f.open,T=i.state.facet(ze);this.optionContent=wr(T),this.optionClass=T.optionClass,this.tooltipClass=T.tooltipClass,this.range=Sr(m.length,k,T.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(i.state),this.dom.addEventListener("mousedown",B=>{let{options:J}=i.state.field(l).open;for(let q=B.target,pe;q&&q!=this.dom;q=q.parentNode)if(q.nodeName=="LI"&&(pe=/-(\d+)$/.exec(q.id))&&+pe[1]<J.length){this.applyCompletion(i,J[+pe[1]]),B.preventDefault();return}}),this.dom.addEventListener("focusout",B=>{let J=i.state.field(this.stateField,!1);J&&J.tooltip&&i.state.facet(ze).closeOnBlur&&B.relatedTarget!=i.contentDOM&&i.dispatch({effects:Ji.of(null)})}),this.showOptions(m,f.id)}mount(){this.updateSel()}showOptions(i,l){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(i,l,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(i){var l;let a=i.state.field(this.stateField),f=i.startState.field(this.stateField);if(this.updateTooltipClass(i.state),a!=f){let{options:m,selected:k,disabled:T}=a.open;(!f.open||f.open.options!=m)&&(this.range=Sr(m.length,k,i.state.facet(ze).maxRenderedOptions),this.showOptions(m,a.id)),this.updateSel(),T!=((l=f.open)===null||l===void 0?void 0:l.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!T)}}updateTooltipClass(i){let l=this.tooltipClass(i);if(l!=this.currentClass){for(let a of this.currentClass.split(" "))a&&this.dom.classList.remove(a);for(let a of l.split(" "))a&&this.dom.classList.add(a);this.currentClass=l}}positioned(i){this.space=i,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let i=this.view.state.field(this.stateField),l=i.open;if((l.selected>-1&&l.selected<this.range.from||l.selected>=this.range.to)&&(this.range=Sr(l.options.length,l.selected,this.view.state.facet(ze).maxRenderedOptions),this.showOptions(l.options,i.id)),this.updateSelectedOption(l.selected)){this.destroyInfo();let{completion:a}=l.options[l.selected],{info:f}=a;if(!f)return;let m=typeof f=="string"?document.createTextNode(f):f(a);if(!m)return;"then"in m?m.then(k=>{k&&this.view.state.field(this.stateField,!1)==i&&this.addInfoPane(k,a)}).catch(k=>(0,G.OO)(this.view.state,k,"completion info")):this.addInfoPane(m,a)}}addInfoPane(i,l){this.destroyInfo();let a=this.info=document.createElement("div");if(a.className="cm-tooltip cm-completionInfo",i.nodeType!=null)a.appendChild(i),this.infoDestroy=null;else{let{dom:f,destroy:m}=i;a.appendChild(f),this.infoDestroy=m||null}this.dom.appendChild(a),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(i){let l=null;for(let a=this.list.firstChild,f=this.range.from;a;a=a.nextSibling,f++)a.nodeName!="LI"||!a.id?f--:f==i?a.hasAttribute("aria-selected")||(a.setAttribute("aria-selected","true"),l=a):a.hasAttribute("aria-selected")&&a.removeAttribute("aria-selected");return l&&Oe(this.list,l),l}measureInfo(){let i=this.dom.querySelector("[aria-selected]");if(!i||!this.info)return null;let l=this.dom.getBoundingClientRect(),a=this.info.getBoundingClientRect(),f=i.getBoundingClientRect(),m=this.space;if(!m){let k=this.dom.ownerDocument.defaultView||window;m={left:0,top:0,right:k.innerWidth,bottom:k.innerHeight}}return f.top>Math.min(m.bottom,l.bottom)-10||f.bottom<Math.max(m.top,l.top)+10?null:this.view.state.facet(ze).positionInfo(this.view,l,f,a,m,this.dom)}placeInfo(i){this.info&&(i?(i.style&&(this.info.style.cssText=i.style),this.info.className="cm-tooltip cm-completionInfo "+(i.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(i,l,a){const f=document.createElement("ul");f.id=l,f.setAttribute("role","listbox"),f.setAttribute("aria-expanded","true"),f.setAttribute("aria-label",this.view.state.phrase("Completions"));let m=null;for(let k=a.from;k<a.to;k++){let{completion:T,match:B}=i[k],{section:J}=T;if(J){let Re=typeof J=="string"?J:J.name;if(Re!=m&&(k>a.from||a.from==0))if(m=Re,typeof J!="string"&&J.header)f.appendChild(J.header(J));else{let at=f.appendChild(document.createElement("completion-section"));at.textContent=Re}}const q=f.appendChild(document.createElement("li"));q.id=l+"-"+k,q.setAttribute("role","option");let pe=this.optionClass(T);pe&&(q.className=pe);for(let Re of this.optionContent){let at=Re(T,this.view.state,this.view,B);at&&q.appendChild(at)}}return a.from&&f.classList.add("cm-completionListIncompleteTop"),a.to<i.length&&f.classList.add("cm-completionListIncompleteBottom"),f}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function tn(o,i){return l=>new Wr(l,o,i)}function Oe(o,i){let l=o.getBoundingClientRect(),a=i.getBoundingClientRect(),f=l.height/o.offsetHeight;a.top<l.top?o.scrollTop-=(l.top-a.top)/f:a.bottom>l.bottom&&(o.scrollTop+=(a.bottom-l.bottom)/f)}function di(o){return(o.boost||0)*100+(o.apply?10:0)+(o.info?5:0)+(o.type?1:0)}function zn(o,i){let l=[],a=null,f=B=>{l.push(B);let{section:J}=B.completion;if(J){a||(a=[]);let q=typeof J=="string"?J:J.name;a.some(pe=>pe.name==q)||a.push(typeof J=="string"?{name:q}:J)}};for(let B of o)if(B.hasResult()){let J=B.result.getMatch;if(B.result.filter===!1)for(let q of B.result.options)f(new Mn(q,B.source,J?J(q):[],1e9-l.length));else{let q=new Vn(i.sliceDoc(B.from,B.to));for(let pe of B.result.options)if(q.match(pe.label)){let Re=pe.displayLabel?J?J(pe,q.matched):[]:q.matched;f(new Mn(pe,B.source,Re,q.score+(pe.boost||0)))}}}if(a){let B=Object.create(null),J=0,q=(pe,Re)=>{var at,ri;return((at=pe.rank)!==null&&at!==void 0?at:1e9)-((ri=Re.rank)!==null&&ri!==void 0?ri:1e9)||(pe.name<Re.name?-1:1)};for(let pe of a.sort(q))J-=1e5,B[pe.name]=J;for(let pe of l){let{section:Re}=pe.completion;Re&&(pe.score+=B[typeof Re=="string"?Re:Re.name])}}let m=[],k=null,T=i.facet(ze).compareCompletions;for(let B of l.sort((J,q)=>q.score-J.score||T(J.completion,q.completion))){let J=B.completion;!k||k.label!=J.label||k.detail!=J.detail||k.type!=null&&J.type!=null&&k.type!=J.type||k.apply!=J.apply||k.boost!=J.boost?m.push(B):di(B.completion)>di(k)&&(m[m.length-1]=B),k=B.completion}return m}class gn{constructor(i,l,a,f,m,k){this.options=i,this.attrs=l,this.tooltip=a,this.timestamp=f,this.selected=m,this.disabled=k}setSelected(i,l){return i==this.selected||i>=this.options.length?this:new gn(this.options,us(l,i),this.tooltip,this.timestamp,i,this.disabled)}static build(i,l,a,f,m){let k=zn(i,l);if(!k.length)return f&&i.some(B=>B.state==1)?new gn(f.options,f.attrs,f.tooltip,f.timestamp,f.selected,!0):null;let T=l.facet(ze).selectOnOpen?0:-1;if(f&&f.selected!=T&&f.selected!=-1){let B=f.options[f.selected].completion;for(let J=0;J<k.length;J++)if(k[J].completion==B){T=J;break}}return new gn(k,us(a,T),{pos:i.reduce((B,J)=>J.hasResult()?Math.min(B,J.from):B,1e8),create:Ae,above:m.aboveCursor},f?f.timestamp:Date.now(),T,!1)}map(i){return new gn(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:i.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Hr{constructor(i,l,a){this.active=i,this.id=l,this.open=a}static start(){return new Hr(no,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(i){let{state:l}=i,a=l.facet(ze),m=(a.override||l.languageDataAt("autocomplete",Ki(l)).map(tr)).map(T=>(this.active.find(J=>J.source==T)||new Ii(T,this.active.some(J=>J.state!=0)?1:0)).update(i,a));m.length==this.active.length&&m.every((T,B)=>T==this.active[B])&&(m=this.active);let k=this.open;k&&i.docChanged&&(k=k.map(i.changes)),i.selection||m.some(T=>T.hasResult()&&i.changes.touchesRange(T.from,T.to))||!io(m,this.active)?k=gn.build(m,l,this.id,k,a):k&&k.disabled&&!m.some(T=>T.state==1)&&(k=null),!k&&m.every(T=>T.state!=1)&&m.some(T=>T.hasResult())&&(m=m.map(T=>T.hasResult()?new Ii(T.source,0):T));for(let T of i.effects)T.is(In)&&(k=k&&k.setSelected(T.value,this.id));return m==this.active&&k==this.open?this:new Hr(m,this.id,k)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:En}}function io(o,i){if(o==i)return!0;for(let l=0,a=0;;){for(;l<o.length&&!o[l].hasResult;)l++;for(;a<i.length&&!i[a].hasResult;)a++;let f=l==o.length,m=a==i.length;if(f||m)return f==m;if(o[l++].result!=i[a++].result)return!1}}const En={"aria-autocomplete":"list"};function us(o,i){let l={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":o};return i>-1&&(l["aria-activedescendant"]=o+"-"+i),l}const no=[];function ns(o){return o.isUserEvent("input.type")?"input":o.isUserEvent("delete.backward")?"delete":null}class Ii{constructor(i,l,a=-1){this.source=i,this.state=l,this.explicitPos=a}hasResult(){return!1}update(i,l){let a=ns(i),f=this;a?f=f.handleUserEvent(i,a,l):i.docChanged?f=f.handleChange(i):i.selection&&f.state!=0&&(f=new Ii(f.source,0));for(let m of i.effects)if(m.is(Hn))f=new Ii(f.source,1,m.value?Ki(i.state):-1);else if(m.is(Ji))f=new Ii(f.source,0);else if(m.is(Bs))for(let k of m.value)k.source==f.source&&(f=k);return f}handleUserEvent(i,l,a){return l=="delete"||!a.activateOnTyping?this.map(i.changes):new Ii(this.source,1)}handleChange(i){return i.changes.touchesRange(Ki(i.startState))?new Ii(this.source,0):this.map(i.changes)}map(i){return i.empty||this.explicitPos<0?this:new Ii(this.source,this.state,i.mapPos(this.explicitPos))}}class $n extends Ii{constructor(i,l,a,f,m){super(i,2,l),this.result=a,this.from=f,this.to=m}hasResult(){return!0}handleUserEvent(i,l,a){var f;let m=i.changes.mapPos(this.from),k=i.changes.mapPos(this.to,1),T=Ki(i.state);if((this.explicitPos<0?T<=m:T<this.from)||T>k||l=="delete"&&Ki(i.startState)==this.from)return new Ii(this.source,l=="input"&&a.activateOnTyping?1:0);let B=this.explicitPos<0?-1:i.changes.mapPos(this.explicitPos),J;return ds(this.result.validFor,i.state,m,k)?new $n(this.source,B,this.result,m,k):this.result.update&&(J=this.result.update(this.result,m,k,new Bn(i.state,T,B>=0)))?new $n(this.source,B,J,J.from,(f=J.to)!==null&&f!==void 0?f:Ki(i.state)):new Ii(this.source,1,B)}handleChange(i){return i.changes.touchesRange(this.from,this.to)?new Ii(this.source,0):this.map(i.changes)}map(i){return i.empty?this:new $n(this.source,this.explicitPos<0?-1:i.mapPos(this.explicitPos),this.result,i.mapPos(this.from),i.mapPos(this.to,1))}}function ds(o,i,l,a){if(!o)return!1;let f=i.sliceDoc(l,a);return typeof o=="function"?o(f,l,a,i):Wn(o,!0).test(f)}const Bs=L.Py.define({map(o,i){return o.map(l=>l.map(i))}}),In=L.Py.define(),Pe=L.QQ.define({create(){return Hr.start()},update(o,i){return o.update(i)},provide:o=>[G.hJ.from(o,i=>i.tooltip),G.tk.contentAttributes.from(o,i=>i.attrs)]});function Ce(o,i){const l=i.completion.apply||i.completion.label;let a=o.state.field(Pe).active.find(f=>f.source==i.source);return a instanceof $n?(typeof l=="string"?o.dispatch(Object.assign(Object.assign({},xr(o.state,l,a.from,a.to)),{annotations:Ln.of(i.completion)})):l(o,i.completion,a.from,a.to),!0):!1}const Ae=tn(Pe,Ce);function Fe(o,i="option"){return l=>{let a=l.state.field(Pe,!1);if(!a||!a.open||a.open.disabled||Date.now()-a.open.timestamp<l.state.facet(ze).interactionDelay)return!1;let f=1,m;i=="page"&&(m=(0,G.gB)(l,a.open.tooltip))&&(f=Math.max(2,Math.floor(m.dom.offsetHeight/m.dom.querySelector("li").offsetHeight)-1));let{length:k}=a.open.options,T=a.open.selected>-1?a.open.selected+f*(o?1:-1):o?0:k-1;return T<0?T=i=="page"?0:k-1:T>=k&&(T=i=="page"?k-1:0),l.dispatch({effects:In.of(T)}),!0}}const lt=o=>{let i=o.state.field(Pe,!1);return o.state.readOnly||!i||!i.open||i.open.selected<0||i.open.disabled||Date.now()-i.open.timestamp<o.state.facet(ze).interactionDelay?!1:Ce(o,i.open.options[i.open.selected])},It=o=>o.state.field(Pe,!1)?(o.dispatch({effects:Hn.of(!0)}),!0):!1,bi=o=>{let i=o.state.field(Pe,!1);return!i||!i.active.some(l=>l.state!=0)?!1:(o.dispatch({effects:Ji.of(null)}),!0)};class xi{constructor(i,l){this.active=i,this.context=l,this.time=Date.now(),this.updates=[],this.done=void 0}}const An=50,rs=1e3,Ls=G.lg.fromClass(class{constructor(o){this.view=o,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let i of o.state.field(Pe).active)i.state==1&&this.startQuery(i)}update(o){let i=o.state.field(Pe);if(!o.selectionSet&&!o.docChanged&&o.startState.field(Pe)==i)return;let l=o.transactions.some(a=>(a.selection||a.docChanged)&&!ns(a));for(let a=0;a<this.running.length;a++){let f=this.running[a];if(l||f.updates.length+o.transactions.length>An&&Date.now()-f.time>rs){for(let m of f.context.abortListeners)try{m()}catch(k){(0,G.OO)(this.view.state,k)}f.context.abortListeners=null,this.running.splice(a--,1)}else f.updates.push(...o.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=i.active.some(a=>a.state==1&&!this.running.some(f=>f.active.source==a.source))?setTimeout(()=>this.startUpdate(),50):-1,this.composing!=0)for(let a of o.transactions)ns(a)=="input"?this.composing=2:this.composing==2&&a.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:o}=this.view,i=o.field(Pe);for(let l of i.active)l.state==1&&!this.running.some(a=>a.active.source==l.source)&&this.startQuery(l)}startQuery(o){let{state:i}=this.view,l=Ki(i),a=new Bn(i,l,o.explicitPos==l),f=new xi(o,a);this.running.push(f),Promise.resolve(o.source(a)).then(m=>{f.context.aborted||(f.done=m||null,this.scheduleAccept())},m=>{this.view.dispatch({effects:Ji.of(null)}),(0,G.OO)(this.view.state,m)})}scheduleAccept(){this.running.every(o=>o.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(ze).updateSyncTime))}accept(){var o;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let i=[],l=this.view.state.facet(ze);for(let a=0;a<this.running.length;a++){let f=this.running[a];if(f.done===void 0)continue;if(this.running.splice(a--,1),f.done){let k=new $n(f.active.source,f.active.explicitPos,f.done,f.done.from,(o=f.done.to)!==null&&o!==void 0?o:Ki(f.updates.length?f.updates[0].startState:this.view.state));for(let T of f.updates)k=k.update(T,l);if(k.hasResult()){i.push(k);continue}}let m=this.view.state.field(Pe).active.find(k=>k.source==f.active.source);if(m&&m.state==1)if(f.done==null){let k=new Ii(f.active.source,0);for(let T of f.updates)k=k.update(T,l);k.state!=1&&i.push(k)}else this.startQuery(m)}i.length&&this.view.dispatch({effects:Bs.of(i)})}},{eventHandlers:{blur(o){let i=this.view.state.field(Pe,!1);if(i&&i.tooltip&&this.view.state.facet(ze).closeOnBlur){let l=i.open&&(0,G.gB)(this.view,i.open.tooltip);(!l||!l.dom.contains(o.relatedTarget))&&this.view.dispatch({effects:Ji.of(null)})}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Hn.of(!1)}),20),this.composing=0}}}),ps=G.tk.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:`${400}px`,boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:`${30}px`},".cm-completionInfo.cm-completionInfo-right-narrow":{left:`${30}px`},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class Uo{constructor(i,l,a,f){this.field=i,this.line=l,this.from=a,this.to=f}}class Is{constructor(i,l,a){this.field=i,this.from=l,this.to=a}map(i){let l=i.mapPos(this.from,-1,MapMode.TrackDel),a=i.mapPos(this.to,1,MapMode.TrackDel);return l==null||a==null?null:new Is(this.field,l,a)}}class Vr{constructor(i,l){this.lines=i,this.fieldPositions=l}instantiate(i,l){let a=[],f=[l],m=i.doc.lineAt(l),k=/^\s*/.exec(m.text)[0];for(let B of this.lines){if(a.length){let J=k,q=/^\t*/.exec(B)[0].length;for(let pe=0;pe<q;pe++)J+=i.facet(indentUnit);f.push(l+J.length-q),B=J+B.slice(q)}a.push(B),l+=B.length+1}let T=this.fieldPositions.map(B=>new Is(B.field,f[B.line]+B.from,f[B.line]+B.to));return{text:a,ranges:T}}static parse(i){let l=[],a=[],f=[],m;for(let k of i.split(/\r\n?|\n/)){for(;m=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(k);){let T=m[1]?+m[1]:null,B=m[2]||m[3]||"",J=-1;for(let q=0;q<l.length;q++)(T!=null?l[q].seq==T:B&&l[q].name==B)&&(J=q);if(J<0){let q=0;for(;q<l.length&&(T==null||l[q].seq!=null&&l[q].seq<T);)q++;l.splice(q,0,{seq:T,name:B}),J=q;for(let pe of f)pe.field>=J&&pe.field++}f.push(new Uo(J,a.length,m.index,m.index+B.length)),k=k.slice(0,m.index)+B+k.slice(m.index+m[0].length)}for(let T;T=/\\([{}])/.exec(k);){k=k.slice(0,T.index)+T[1]+k.slice(T.index+T[0].length);for(let B of f)B.line==a.length&&B.from>T.index&&(B.from--,B.to--)}a.push(k)}return new Vr(a,f)}}let Go=G.p.widget({widget:new class extends G.l9{toDOM(){let o=document.createElement("span");return o.className="cm-snippetFieldPosition",o}ignoreEvent(){return!1}}}),Xo=G.p.mark({class:"cm-snippetField"});class zr{constructor(i,l){this.ranges=i,this.active=l,this.deco=G.p.set(i.map(a=>(a.from==a.to?Go:Xo).range(a.from,a.to)))}map(i){let l=[];for(let a of this.ranges){let f=a.map(i);if(!f)return null;l.push(f)}return new zr(l,this.active)}selectionInsideField(i){return i.ranges.every(l=>this.ranges.some(a=>a.field==this.active&&a.from<=l.from&&a.to>=l.to))}}const ms=L.Py.define({map(o,i){return o&&o.map(i)}}),ro=L.Py.define(),ir=L.QQ.define({create(){return null},update(o,i){for(let l of i.effects){if(l.is(ms))return l.value;if(l.is(ro)&&o)return new zr(o.ranges,l.value)}return o&&i.docChanged&&(o=o.map(i.changes)),o&&i.selection&&!o.selectionInsideField(i.selection)&&(o=null),o},provide:o=>G.tk.decorations.from(o,i=>i?i.deco:G.p.none)});function so(o,i){return L.jT.create(o.filter(l=>l.field==i).map(l=>L.jT.range(l.from,l.to)))}function Yo(o){let i=Vr.parse(o);return(l,a,f,m)=>{let{text:k,ranges:T}=i.instantiate(l.state,f),B={changes:{from:f,to:m,insert:Text.of(k)},scrollIntoView:!0,annotations:a?Ln.of(a):void 0};if(T.length&&(B.selection=so(T,0)),T.length>1){let J=new zr(T,0),q=B.effects=[ms.of(J)];l.state.field(ir,!1)===void 0&&q.push(StateEffect.appendConfig.of([ir,tl,vo,ps]))}l.dispatch(l.state.update(B))}}function Ns(o){return({state:i,dispatch:l})=>{let a=i.field(ir,!1);if(!a||o<0&&a.active==0)return!1;let f=a.active+o,m=o>0&&!a.ranges.some(k=>k.field==f+o);return l(i.update({selection:so(a.ranges,f),effects:ms.of(m?null:new zr(a.ranges,f)),scrollIntoView:!0})),!0}}const qo=({state:o,dispatch:i})=>o.field(ir,!1)?(i(o.update({effects:ms.of(null)})),!0):!1,Fs=Ns(1),Qo=Ns(-1);function _o(o){let i=o.field(ir,!1);return!!(i&&i.ranges.some(l=>l.field==i.active+1))}function vl(o){let i=o.field(ir,!1);return!!(i&&i.active>0)}const el=[{key:"Tab",run:Fs,shift:Qo},{key:"Escape",run:qo}],yo=L.r$.define({combine(o){return o.length?o[0]:el}}),tl=L.Wl.highest(G.$f.compute([yo],o=>o.facet(yo)));function bl(o,i){return Object.assign(Object.assign({},i),{apply:Yo(o)})}const vo=G.tk.domEventHandlers({mousedown(o,i){let l=i.state.field(ir,!1),a;if(!l||(a=i.posAtCoords({x:o.clientX,y:o.clientY}))==null)return!1;let f=l.ranges.find(m=>m.from<=a&&m.to>=a);return!f||f.field==l.active?!1:(i.dispatch({selection:so(l.ranges,f.field),effects:ms.of(l.ranges.some(m=>m.field>f.field)?new zr(l.ranges,f.field):null),scrollIntoView:!0}),!0)}});function xl(o){let i=o.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${i}]+`,"ug")}catch{return new RegExp(`[w${i}]`,"g")}}function bo(o,i){return new RegExp(i(o.source),o.unicode?"u":"")}const xo=null;function il(o){return xo[o]||(xo[o]=new WeakMap)}function wo(o,i,l,a,f){for(let m=o.iterLines(),k=0;!m.next().done;){let{value:T}=m,B;for(i.lastIndex=0;B=i.exec(T);)if(!a[B[0]]&&k+B.index!=f&&(l.push({type:"text",label:B[0]}),a[B[0]]=!0,l.length>=2e3))return;k+=T.length+1}}function So(o,i,l,a,f){let m=o.length>=1e3,k=m&&i.get(o);if(k)return k;let T=[],B=Object.create(null);if(o.children){let J=0;for(let q of o.children){if(q.length>=1e3)for(let pe of So(q,i,l,a-J,f-J))B[pe.label]||(B[pe.label]=!0,T.push(pe));else wo(q,l,T,B,f-J);J+=q.length+1}}else wo(o,l,T,B,f);return m&&T.length<2e3&&i.set(o,T),T}const ko=o=>{let i=o.state.languageDataAt("wordChars",o.pos).join(""),l=xl(i),a=o.matchBefore(bo(l,k=>k+"$"));if(!a&&!o.explicit)return null;let f=a?a.from:o.pos,m=So(o.state.doc,il(i),l,5e4,f);return{from:f,options:m,validFor:bo(l,k=>"^"+k)}},gs={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},$r=L.Py.define({map(o,i){let l=i.mapPos(o,-1,L.gc.TrackAfter);return l==null?void 0:l}}),Ws=new class extends L.uU{};Ws.startSide=1,Ws.endSide=-1;const Co=L.QQ.define({create(){return L.Xs.empty},update(o,i){if(i.selection){let l=i.state.doc.lineAt(i.selection.main.head);o=o.update({filter:a=>a>=l.from&&a<=l.to})}o=o.map(i.changes);for(let l of i.effects)l.is($r)&&(o=o.update({add:[Ws.range(l.value,l.value+1)]}));return o}});function nl(){return[Mo,Co]}const oo="()[]{}<>";function Ao(o){for(let i=0;i<oo.length;i+=2)if(oo.charCodeAt(i)==o)return oo.charAt(i+1);return(0,L.bg)(o<128?o:o+1)}function To(o,i){return o.languageDataAt("closeBrackets",i)[0]||gs}const ys=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Mo=G.tk.inputHandler.of((o,i,l,a)=>{if((ys?o.composing:o.compositionStarted)||o.state.readOnly)return!1;let f=o.state.selection.main;if(a.length>2||a.length==2&&(0,L.nZ)((0,L.gm)(a,0))==1||i!=f.from||l!=f.to)return!1;let m=Hs(o.state,a);return m?(o.dispatch(m),!0):!1}),rl=[{key:"Backspace",run:({state:o,dispatch:i})=>{if(o.readOnly)return!1;let a=To(o,o.selection.main.head).brackets||gs.brackets,f=null,m=o.changeByRange(k=>{if(k.empty){let T=sl(o.doc,k.head);for(let B of a)if(B==T&&ss(o.doc,k.head)==Ao((0,L.gm)(B,0)))return{changes:{from:k.head-B.length,to:k.head+B.length},range:L.jT.cursor(k.head-B.length)}}return{range:f=k}});return f||i(o.update(m,{scrollIntoView:!0,userEvent:"delete.backward"})),!f}}];function Hs(o,i){let l=To(o,o.selection.main.head),a=l.brackets||gs.brackets;for(let f of a){let m=Ao((0,L.gm)(f,0));if(i==f)return m==f?vs(o,f,a.indexOf(f+f+f)>-1,l):ol(o,f,m,l.before||gs.before);if(i==m&&lo(o,o.selection.main.from))return ao(o,f,m)}return null}function lo(o,i){let l=!1;return o.field(Co).between(0,o.doc.length,a=>{a==i&&(l=!0)}),l}function ss(o,i){let l=o.sliceString(i,i+2);return l.slice(0,(0,L.nZ)((0,L.gm)(l,0)))}function sl(o,i){let l=o.sliceString(i-2,i);return(0,L.nZ)((0,L.gm)(l,0))==l.length?l:l.slice(1)}function ol(o,i,l,a){let f=null,m=o.changeByRange(k=>{if(!k.empty)return{changes:[{insert:i,from:k.from},{insert:l,from:k.to}],effects:$r.of(k.to+i.length),range:L.jT.range(k.anchor+i.length,k.head+i.length)};let T=ss(o.doc,k.head);return!T||/\s/.test(T)||a.indexOf(T)>-1?{changes:{insert:i+l,from:k.head},effects:$r.of(k.head+i.length),range:L.jT.cursor(k.head+i.length)}:{range:f=k}});return f?null:o.update(m,{scrollIntoView:!0,userEvent:"input.type"})}function ao(o,i,l){let a=null,f=o.changeByRange(m=>m.empty&&ss(o.doc,m.head)==l?{changes:{from:m.head,to:m.head+l.length,insert:l},range:L.jT.cursor(m.head+l.length)}:a={range:m});return a?null:o.update(f,{scrollIntoView:!0,userEvent:"input.type"})}function vs(o,i,l,a){let f=a.stringPrefixes||gs.stringPrefixes,m=null,k=o.changeByRange(T=>{if(!T.empty)return{changes:[{insert:i,from:T.from},{insert:i,from:T.to}],effects:$r.of(T.to+i.length),range:L.jT.range(T.anchor+i.length,T.head+i.length)};let B=T.head,J=ss(o.doc,B),q;if(J==i){if(Vs(o,B))return{changes:{insert:i+i,from:B},effects:$r.of(B+i.length),range:L.jT.cursor(B+i.length)};if(lo(o,B)){let Re=l&&o.sliceDoc(B,B+i.length*3)==i+i+i?i+i+i:i;return{changes:{from:B,to:B+Re.length,insert:Re},range:L.jT.cursor(B+Re.length)}}}else{if(l&&o.sliceDoc(B-2*i.length,B)==i+i&&(q=Eo(o,B-2*i.length,f))>-1&&Vs(o,q))return{changes:{insert:i+i+i+i,from:B},effects:$r.of(B+i.length),range:L.jT.cursor(B+i.length)};if(o.charCategorizer(B)(J)!=L.D0.Word&&Eo(o,B,f)>-1&&!ll(o,B,i,f))return{changes:{insert:i+i,from:B},effects:$r.of(B+i.length),range:L.jT.cursor(B+i.length)}}return{range:m=T}});return m?null:o.update(k,{scrollIntoView:!0,userEvent:"input.type"})}function Vs(o,i){let l=(0,ke.qz)(o).resolveInner(i+1);return l.parent&&l.from==i}function ll(o,i,l,a){let f=(0,ke.qz)(o).resolveInner(i,-1),m=a.reduce((k,T)=>Math.max(k,T.length),0);for(let k=0;k<5;k++){let T=o.sliceDoc(f.from,Math.min(f.to,f.from+l.length+m)),B=T.indexOf(l);if(!B||B>-1&&a.indexOf(T.slice(0,B))>-1){let q=f.firstChild;for(;q&&q.from==f.from&&q.to-q.from>l.length+B;){if(o.sliceDoc(q.to-l.length,q.to)==l)return!1;q=q.firstChild}return!0}let J=f.to==i&&f.parent;if(!J)break;f=J}return!1}function Eo(o,i,l){let a=o.charCategorizer(i);if(a(o.sliceDoc(i-1,i))!=L.D0.Word)return i;for(let f of l){let m=i-f.length;if(o.sliceDoc(m,i)==f&&a(o.sliceDoc(m-1,m))!=L.D0.Word)return m}return-1}function Do(o={}){return[Pe,ze.of(o),Ls,al,ps]}const Oo=[{key:"Ctrl-Space",run:It},{key:"Escape",run:bi},{key:"ArrowDown",run:Fe(!0)},{key:"ArrowUp",run:Fe(!1)},{key:"PageDown",run:Fe(!0,"page")},{key:"PageUp",run:Fe(!1,"page")},{key:"Enter",run:lt}],al=L.Wl.highest(G.$f.computeN([ze],o=>o.facet(ze).defaultKeymap?[Oo]:[]));function wl(o){let i=o.field(Pe,!1);return i&&i.active.some(l=>l.state==1)?"pending":i&&i.active.some(l=>l.state!=0)?"active":null}const hl=new WeakMap;function Sl(o){var i;let l=(i=o.field(Pe,!1))===null||i===void 0?void 0:i.open;if(!l||l.disabled)return[];let a=hl.get(l.options);return a||hl.set(l.options,a=l.options.map(f=>f.completion)),a}function Dl(o){var i;let l=(i=o.field(Pe,!1))===null||i===void 0?void 0:i.open;return l&&!l.disabled&&l.selected>=0?l.options[l.selected].completion:null}function Ol(o){var i;let l=(i=o.field(Pe,!1))===null||i===void 0?void 0:i.open;return l&&!l.disabled&&l.selected>=0?l.selected:null}function Po(o){return In.of(o)}class kl{constructor(i,l,a){this.from=i,this.to=l,this.diagnostic=a}}class jr{constructor(i,l,a){this.diagnostics=i,this.panel=l,this.selected=a}static init(i,l,a){let f=i,m=a.facet(fo).markerFilter;m&&(f=m(f));let k=G.p.set(f.map(T=>T.from==T.to||T.from==T.to-1&&a.doc.lineAt(T.from).to==T.from?G.p.widget({widget:new ul(T),diagnostic:T}).range(T.from):G.p.mark({attributes:{class:"cm-lintRange cm-lintRange-"+T.severity+(T.markClass?" "+T.markClass:"")},diagnostic:T}).range(T.from,T.to)),!0);return new jr(k,l,Zr(k))}}function Zr(o,i=null,l=0){let a=null;return o.between(l,1e9,(f,m,{spec:k})=>{if(!(i&&k.diagnostic!=i))return a=new kl(f,m,k.diagnostic),!1}),a}function bs(o,i){let l=o.startState.doc.lineAt(i.pos);return!!(o.effects.some(a=>a.is(Dn))||o.changes.touchesRange(l.from,l.to))}function ho(o,i){return o.field(Hi,!1)?i:i.concat(L.Py.appendConfig.of(n))}function Ro(o,i){return{effects:ho(o,[Dn.of(i)])}}const Dn=L.Py.define(),os=L.Py.define(),Bo=L.Py.define(),Hi=L.QQ.define({create(){return new jr(G.p.none,null,null)},update(o,i){if(i.docChanged){let l=o.diagnostics.map(i.changes),a=null;if(o.selected){let f=i.changes.mapPos(o.selected.from,1);a=Zr(l,o.selected.diagnostic,f)||Zr(l,null,f)}o=new jr(l,o.panel,a)}for(let l of i.effects)l.is(Dn)?o=jr.init(l.value,o.panel,i.state):l.is(os)?o=new jr(o.diagnostics,l.value?js.open:null,o.selected):l.is(Bo)&&(o=new jr(o.diagnostics,o.panel,l.value));return o},provide:o=>[G.mH.from(o,i=>i.panel),G.tk.decorations.from(o,i=>i.diagnostics)]});function Cl(o){let i=o.field(Hi,!1);return i?i.diagnostics.size:0}const co=G.p.mark({class:"cm-lintRange cm-lintRange-active"});function Lo(o,i,l){let{diagnostics:a}=o.state.field(Hi),f=[],m=2e8,k=0;a.between(i-(l<0?1:0),i+(l>0?1:0),(B,J,{spec:q})=>{i>=B&&i<=J&&(B==J||(i>B||l>0)&&(i<J||l<0))&&(f.push(q.diagnostic),m=Math.min(B,m),k=Math.max(J,k))});let T=o.state.facet(fo).tooltipFilter;return T&&(f=T(f)),f.length?{pos:m,end:k,above:o.state.doc.lineAt(m).to<k,create(){return{dom:Io(o,f)}}}:null}function Io(o,i){return ti("ul",{class:"cm-tooltip-lint"},i.map(l=>Vo(o,l,!1)))}const No=o=>{let i=o.state.field(Hi,!1);(!i||!i.panel)&&o.dispatch({effects:ho(o.state,[os.of(!0)])});let l=(0,G.Sd)(o,js.open);return l&&l.dom.querySelector(".cm-panel-lint ul").focus(),!0},zs=o=>{let i=o.state.field(Hi,!1);return!i||!i.panel?!1:(o.dispatch({effects:os.of(!1)}),!0)},cl=o=>{let i=o.state.field(Hi,!1);if(!i)return!1;let l=o.state.selection.main,a=i.diagnostics.iter(l.to+1);return!a.value&&(a=i.diagnostics.iter(0),!a.value||a.from==l.from&&a.to==l.to)?!1:(o.dispatch({selection:{anchor:a.from,head:a.to},scrollIntoView:!0}),!0)},fl=o=>{let{state:i}=o,l=i.field(Hi,!1);if(!l)return!1;let a=i.selection.main,f,m,k,T;return l.diagnostics.between(0,i.doc.length,(B,J)=>{J<a.to&&(f==null||f<B)&&(f=B,m=J),(k==null||B>k)&&(k=B,T=J)}),k==null||f==null&&k==a.from?!1:(o.dispatch({selection:{anchor:f!=null?f:k,head:m!=null?m:T},scrollIntoView:!0}),!0)},Fo=[{key:"Mod-Shift-m",run:No,preventDefault:!0},{key:"F8",run:cl}],Wo=null,fo=L.r$.define({combine(o){return Object.assign({sources:o.map(i=>i.source)},(0,L.BO)(o.map(i=>i.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(i,l)=>i?l?a=>i(a)||l(a):i:l}))}});function xs(o,i={}){return[fo.of({source:o,config:i}),Wo,n]}function Ho(o){let i=o.plugin(Wo);i&&i.force()}function $s(o){let i=[];if(o)e:for(let{name:l}of o){for(let a=0;a<l.length;a++){let f=l[a];if(/[a-zA-Z]/.test(f)&&!i.some(m=>m.toLowerCase()==f.toLowerCase())){i.push(f);continue e}}i.push("")}return i}function Vo(o,i,l){var a;let f=l?$s(i.actions):[];return ti("li",{class:"cm-diagnostic cm-diagnostic-"+i.severity},ti("span",{class:"cm-diagnosticText"},i.renderMessage?i.renderMessage():i.message),(a=i.actions)===null||a===void 0?void 0:a.map((m,k)=>{let T=!1,B=Re=>{if(Re.preventDefault(),T)return;T=!0;let at=Zr(o.state.field(Hi).diagnostics,i);at&&m.apply(o,at.from,at.to)},{name:J}=m,q=f[k]?J.indexOf(f[k]):-1,pe=q<0?J:[J.slice(0,q),ti("u",J.slice(q,q+1)),J.slice(q+1)];return ti("button",{type:"button",class:"cm-diagnosticAction",onclick:B,onmousedown:B,"aria-label":` Action: ${J}${q<0?"":` (access key "${f[k]})"`}.`},pe)}),i.source&&ti("div",{class:"cm-diagnosticSource"},i.source))}class ul extends G.l9{constructor(i){super(),this.diagnostic=i}eq(i){return i.diagnostic==this.diagnostic}toDOM(){return ti("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class uo{constructor(i,l){this.diagnostic=l,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Vo(i,l,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class js{constructor(i){this.view=i,this.items=[];let l=f=>{if(f.keyCode==27)zs(this.view),this.view.focus();else if(f.keyCode==38||f.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(f.keyCode==40||f.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(f.keyCode==36)this.moveSelection(0);else if(f.keyCode==35)this.moveSelection(this.items.length-1);else if(f.keyCode==13)this.view.focus();else if(f.keyCode>=65&&f.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:m}=this.items[this.selectedIndex],k=$s(m.actions);for(let T=0;T<k.length;T++)if(k[T].toUpperCase().charCodeAt(0)==f.keyCode){let B=Zr(this.view.state.field(Hi).diagnostics,m);B&&m.actions[T].apply(i,B.from,B.to)}}else return;f.preventDefault()},a=f=>{for(let m=0;m<this.items.length;m++)this.items[m].dom.contains(f.target)&&this.moveSelection(m)};this.list=ti("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:l,onclick:a}),this.dom=ti("div",{class:"cm-panel-lint"},this.list,ti("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>zs(this.view)},"\xD7")),this.update()}get selectedIndex(){let i=this.view.state.field(Hi).selected;if(!i)return-1;for(let l=0;l<this.items.length;l++)if(this.items[l].diagnostic==i.diagnostic)return l;return-1}update(){let{diagnostics:i,selected:l}=this.view.state.field(Hi),a=0,f=!1,m=null;for(i.between(0,this.view.state.doc.length,(k,T,{spec:B})=>{let J=-1,q;for(let pe=a;pe<this.items.length;pe++)if(this.items[pe].diagnostic==B.diagnostic){J=pe;break}J<0?(q=new uo(this.view,B.diagnostic),this.items.splice(a,0,q),f=!0):(q=this.items[J],J>a&&(this.items.splice(a,J-a),f=!0)),l&&q.diagnostic==l.diagnostic?q.dom.hasAttribute("aria-selected")||(q.dom.setAttribute("aria-selected","true"),m=q):q.dom.hasAttribute("aria-selected")&&q.dom.removeAttribute("aria-selected"),a++});a<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)f=!0,this.items.pop();this.items.length==0&&(this.items.push(new uo(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),f=!0),m?(this.list.setAttribute("aria-activedescendant",m.id),this.view.requestMeasure({key:this,read:()=>({sel:m.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:k,panel:T})=>{let B=T.height/this.list.offsetHeight;k.top<T.top?this.list.scrollTop-=(T.top-k.top)/B:k.bottom>T.bottom&&(this.list.scrollTop+=(k.bottom-T.bottom)/B)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),f&&this.sync()}sync(){let i=this.list.firstChild;function l(){let a=i;i=a.nextSibling,a.remove()}for(let a of this.items)if(a.dom.parentNode==this.list){for(;i!=a.dom;)l();i=a.dom.nextSibling}else this.list.insertBefore(a.dom,i);for(;i;)l()}moveSelection(i){if(this.selectedIndex<0)return;let l=this.view.state.field(Hi),a=Zr(l.diagnostics,this.items[i].diagnostic);a&&this.view.dispatch({selection:{anchor:a.from,head:a.to},scrollIntoView:!0,effects:Bo.of(a)})}static open(i){return new js(i)}}function Zs(o,i='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${i}>${encodeURIComponent(o)}</svg>')`}function Ks(o){return Zs(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${o}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const zo=G.tk.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Ks("#d11")},".cm-lintRange-warning":{backgroundImage:Ks("orange")},".cm-lintRange-info":{backgroundImage:Ks("#999")},".cm-lintRange-hint":{backgroundImage:Ks("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function $o(o){return o=="error"?4:o=="warning"?3:o=="info"?2:1}class jo extends G.SJ{constructor(i){super(),this.diagnostics=i,this.severity=i.reduce((l,a)=>$o(l)<$o(a.severity)?a.severity:l,"hint")}toDOM(i){let l=document.createElement("div");l.className="cm-lint-marker cm-lint-marker-"+this.severity;let a=this.diagnostics,f=i.state.facet(r).tooltipFilter;return f&&(a=f(a)),a.length&&(l.onmouseover=()=>Al(i,l,a)),l}}function dl(o,i){let l=a=>{let f=i.getBoundingClientRect();if(!(a.clientX>f.left-10&&a.clientX<f.right+10&&a.clientY>f.top-10&&a.clientY<f.bottom+10)){for(let m=a.target;m;m=m.parentNode)if(m.nodeType==1&&m.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",l),o.state.field(e)&&o.dispatch({effects:s.of(null)})}};window.addEventListener("mousemove",l)}function Al(o,i,l){function a(){let k=o.elementAtHeight(i.getBoundingClientRect().top+5-o.documentTop);o.coordsAtPos(k.from)&&o.dispatch({effects:s.of({pos:k.from,above:!1,create(){return{dom:Io(o,l),getCoords:()=>i.getBoundingClientRect()}}})}),i.onmouseout=i.onmousemove=null,dl(o,i)}let{hoverTime:f}=o.state.facet(r),m=setTimeout(a,f);i.onmouseout=()=>{clearTimeout(m),i.onmouseout=i.onmousemove=null},i.onmousemove=()=>{clearTimeout(m),m=setTimeout(a,f)}}function pl(o,i){let l=Object.create(null);for(let f of i){let m=o.lineAt(f.from);(l[m.from]||(l[m.from]=[])).push(f)}let a=[];for(let f in l)a.push(new jo(l[f]).range(+f));return L.Xs.of(a,!0)}const Tl=(0,G.v5)({class:"cm-gutter-lint",markers:o=>o.state.field(ml)}),ml=L.QQ.define({create(){return L.Xs.empty},update(o,i){o=o.map(i.changes);let l=i.state.facet(r).markerFilter;for(let a of i.effects)if(a.is(Dn)){let f=a.value;l&&(f=l(f||[])),o=pl(i.state.doc,f.slice(0))}return o}}),s=L.Py.define(),e=L.QQ.define({create(){return null},update(o,i){return o&&i.docChanged&&(o=bs(i,o)?null:Object.assign(Object.assign({},o),{pos:i.changes.mapPos(o.pos)})),i.effects.reduce((l,a)=>a.is(s)?a.value:l,o)},provide:o=>G.hJ.from(o)}),t=G.tk.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:Zs('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:Zs('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:Zs('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),n=[Hi,G.tk.decorations.compute([Hi],o=>{let{selected:i,panel:l}=o.field(Hi);return!i||!l||i.from==i.to?G.p.none:G.p.set([co.range(i.from,i.to)])}),(0,G.bF)(Lo,{hideOn:bs}),zo],r=L.r$.define({combine(o){return(0,L.BO)(o,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function h(o={}){return[r.of(o),ml,Tl,t,e]}function d(o,i){let l=o.field(Hi,!1);if(l&&l.diagnostics.size)for(let a=RangeSet.iter([l.diagnostics]);a.value;a.next())i(a.value.spec.diagnostic,a.from,a.to)}var y=function(i){i===void 0&&(i={});var{crosshairCursor:l=!1}=i,a=[];i.closeBracketsKeymap!==!1&&(a=a.concat(rl)),i.defaultKeymap!==!1&&(a=a.concat(qs)),i.searchKeymap!==!1&&(a=a.concat(gr)),i.historyKeymap!==!1&&(a=a.concat(D)),i.foldKeymap!==!1&&(a=a.concat(ke.e7)),i.completionKeymap!==!1&&(a=a.concat(Oo)),i.lintKeymap!==!1&&(a=a.concat(Fo));var f=[];return i.lineNumbers!==!1&&f.push((0,G.Eu)()),i.highlightActiveLineGutter!==!1&&f.push((0,G.HQ)()),i.highlightSpecialChars!==!1&&f.push((0,G.AE)()),i.history!==!1&&f.push(Mi()),i.foldGutter!==!1&&f.push((0,ke.mi)()),i.drawSelection!==!1&&f.push((0,G.Uw)()),i.dropCursor!==!1&&f.push((0,G.qr)()),i.allowMultipleSelections!==!1&&f.push(L.yy.allowMultipleSelections.of(!0)),i.indentOnInput!==!1&&f.push((0,ke.nY)()),i.syntaxHighlighting!==!1&&f.push((0,ke.nF)(ke.R_,{fallback:!0})),i.bracketMatching!==!1&&f.push((0,ke.n$)()),i.closeBrackets!==!1&&f.push(nl()),i.autocompletion!==!1&&f.push(Do()),i.rectangularSelection!==!1&&f.push((0,G.Zs)()),l!==!1&&f.push((0,G.S2)()),i.highlightActiveLine!==!1&&f.push((0,G.ZO)()),i.highlightSelectionMatches!==!1&&f.push(_r()),i.tabSize&&typeof i.tabSize=="number"&&f.push(ke.c.of(" ".repeat(i.tabSize))),f.concat([G.$f.of(a.flat())]).filter(Boolean)},x=function(i){i===void 0&&(i={});var l=[];i.defaultKeymap!==!1&&(l=l.concat(defaultKeymap)),i.historyKeymap!==!1&&(l=l.concat(historyKeymap));var a=[];return i.highlightSpecialChars!==!1&&a.push(highlightSpecialChars()),i.history!==!1&&a.push(history()),i.drawSelection!==!1&&a.push(drawSelection()),i.syntaxHighlighting!==!1&&a.push(syntaxHighlighting(defaultHighlightStyle,{fallback:!0})),a.concat([keymap.of(l.flat())]).filter(Boolean)},C=Q(86253);const A="#e5c07b",W="#e06c75",$="#56b6c2",X="#ffffff",ee="#abb2bf",le="#7d8799",ne="#61afef",de="#98c379",Ke="#d19a66",mt="#c678dd",$e="#21252b",_e="#2c313a",Ct="#282c34",Ti="#353a42",Ui="#3E4451",jn="#528bff",po={chalky:A,coral:W,cyan:$,invalid:X,ivory:ee,stone:le,malibu:ne,sage:de,whiskey:Ke,violet:mt,darkBackground:$e,highlightBackground:_e,background:Ct,tooltipBackground:Ti,selection:Ui,cursor:jn},Zo=G.tk.theme({"&":{color:ee,backgroundColor:Ct},".cm-content":{caretColor:jn},".cm-cursor, .cm-dropCursor":{borderLeftColor:jn},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Ui},".cm-panels":{backgroundColor:$e,color:ee},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Ct,color:le,border:"none"},".cm-activeLineGutter":{backgroundColor:_e},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Ti},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Ti,borderBottomColor:Ti},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:_e,color:ee}}},{dark:!0}),Js=ke.Qf.define([{tag:C.pJ.keyword,color:mt},{tag:[C.pJ.name,C.pJ.deleted,C.pJ.character,C.pJ.propertyName,C.pJ.macroName],color:W},{tag:[C.pJ.function(C.pJ.variableName),C.pJ.labelName],color:ne},{tag:[C.pJ.color,C.pJ.constant(C.pJ.name),C.pJ.standard(C.pJ.name)],color:Ke},{tag:[C.pJ.definition(C.pJ.name),C.pJ.separator],color:ee},{tag:[C.pJ.typeName,C.pJ.className,C.pJ.number,C.pJ.changed,C.pJ.annotation,C.pJ.modifier,C.pJ.self,C.pJ.namespace],color:A},{tag:[C.pJ.operator,C.pJ.operatorKeyword,C.pJ.url,C.pJ.escape,C.pJ.regexp,C.pJ.link,C.pJ.special(C.pJ.string)],color:$},{tag:[C.pJ.meta,C.pJ.comment],color:le},{tag:C.pJ.strong,fontWeight:"bold"},{tag:C.pJ.emphasis,fontStyle:"italic"},{tag:C.pJ.strikethrough,textDecoration:"line-through"},{tag:C.pJ.link,color:le,textDecoration:"underline"},{tag:C.pJ.heading,fontWeight:"bold",color:W},{tag:[C.pJ.atom,C.pJ.bool,C.pJ.special(C.pJ.variableName)],color:Ke},{tag:[C.pJ.processingInstruction,C.pJ.string,C.pJ.inserted],color:de},{tag:C.pJ.invalid,color:X}]),Us=[Zo,(0,ke.nF)(Js)];var Kr=G.tk.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),kr=function(i){i===void 0&&(i={});var{indentWithTab:l=!0,editable:a=!0,readOnly:f=!1,theme:m="light",placeholder:k="",basicSetup:T=!0}=i,B=[];switch(l&&B.unshift(G.$f.of([Cs])),T&&(typeof T=="boolean"?B.unshift(y()):B.unshift(y(T))),k&&B.unshift((0,G.W$)(k)),m){case"light":B.push(Kr);break;case"dark":B.push(Us);break;case"none":break;default:B.push(m);break}return a===!1&&B.push(G.tk.editable.of(!1)),f&&B.push(L.yy.readOnly.of(!0)),[...B]},ls=o=>({line:o.state.doc.lineAt(o.state.selection.main.from),lineCount:o.state.doc.lines,lineBreak:o.state.lineBreak,length:o.state.doc.length,readOnly:o.state.readOnly,tabSize:o.state.tabSize,selection:o.state.selection,selectionAsSingle:o.state.selection.asSingle().main,ranges:o.state.selection.ranges,selectionCode:o.state.sliceDoc(o.state.selection.main.from,o.state.selection.main.to),selections:o.state.selection.ranges.map(i=>o.state.sliceDoc(i.from,i.to)),selectedText:o.state.selection.ranges.some(i=>!i.empty)}),Cr=L.q6.define(),ws=[];function nr(o){var{value:i,selection:l,onChange:a,onStatistics:f,onCreateEditor:m,onUpdate:k,extensions:T=ws,autoFocus:B,theme:J="light",height:q=null,minHeight:pe=null,maxHeight:Re=null,width:at=null,minWidth:ri=null,maxWidth:Gi=null,placeholder:Zn="",editable:Ar=!0,readOnly:Di=!1,indentWithTab:sr=!0,basicSetup:On=!0,root:sn,initialState:Tr}=o,[Mr,Ko]=(0,ue.useState)(),[on,Jr]=(0,ue.useState)(),[Gs,Xs]=(0,ue.useState)(),gl=G.tk.theme({"&":{height:q,minHeight:pe,maxHeight:Re,width:at,minWidth:ri,maxWidth:Gi},"& .cm-scroller":{height:"100% !important"}}),yl=G.tk.updateListener.of(or=>{if(or.docChanged&&typeof a=="function"&&!or.transactions.some(Ll=>Ll.annotation(Cr))){var go=or.state.doc,Jo=go.toString();a(Jo,or)}f&&f(ls(or))}),Bl=kr({theme:J,editable:Ar,readOnly:Di,placeholder:Zn,indentWithTab:sr,basicSetup:On}),mo=[yl,gl,...Bl];return k&&typeof k=="function"&&mo.push(G.tk.updateListener.of(k)),mo=mo.concat(T),(0,ue.useEffect)(()=>{if(Mr&&!Gs){var or={doc:i,selection:l,extensions:mo},go=Tr?L.yy.fromJSON(Tr.json,or,Tr.fields):L.yy.create(or);if(Xs(go),!on){var Jo=new G.tk({state:go,parent:Mr,root:sn});Jr(Jo),m&&m(Jo,go)}}return()=>{on&&(Xs(void 0),Jr(void 0))}},[Mr,Gs]),(0,ue.useEffect)(()=>Ko(o.container),[o.container]),(0,ue.useEffect)(()=>()=>{on&&(on.destroy(),Jr(void 0))},[on]),(0,ue.useEffect)(()=>{B&&on&&on.focus()},[B,on]),(0,ue.useEffect)(()=>{on&&on.dispatch({effects:L.Py.reconfigure.of(mo)})},[J,T,q,pe,Re,at,ri,Gi,Zn,Ar,Di,sr,On,a,k]),(0,ue.useEffect)(()=>{if(i!==void 0){var or=on?on.state.doc.toString():"";on&&i!==or&&on.dispatch({changes:{from:0,to:or.length,insert:i||""},annotations:[Cr.of(!0)]})}},[i,on]),{state:Gs,setState:Xs,view:on,setView:Jr,container:Mr,setContainer:Ko}}var rr=Q(52322),Pl=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],Ml=(0,ue.forwardRef)((o,i)=>{var{className:l,value:a="",selection:f,extensions:m=[],onChange:k,onStatistics:T,onCreateEditor:B,onUpdate:J,autoFocus:q,theme:pe="light",height:Re,minHeight:at,maxHeight:ri,width:Gi,minWidth:Zn,maxWidth:Ar,basicSetup:Di,placeholder:sr,indentWithTab:On,editable:sn,readOnly:Tr,root:Mr,initialState:Ko}=o,on=(0,Se.Z)(o,Pl),Jr=(0,ue.useRef)(null),{state:Gs,view:Xs,container:gl}=nr({container:Jr.current,root:Mr,value:a,autoFocus:q,theme:pe,height:Re,minHeight:at,maxHeight:ri,width:Gi,minWidth:Zn,maxWidth:Ar,basicSetup:Di,placeholder:sr,indentWithTab:On,editable:sn,readOnly:Tr,selection:f,onChange:k,onStatistics:T,onCreateEditor:B,onUpdate:J,extensions:m,initialState:Ko});if((0,ue.useImperativeHandle)(i,()=>({editor:Jr.current,state:Gs,view:Xs}),[Jr,gl,Gs,Xs]),typeof a!="string")throw new Error("value must be typeof string but got "+typeof a);var yl=typeof pe=="string"?"cm-theme-"+pe:"cm-theme";return(0,rr.jsx)("div",(0,p.Z)({ref:Jr,className:""+yl+(l?" "+l:"")},on))});Ml.displayName="CodeMirror";const Rl=Ml},77120:(yn,Wt,Q)=>{Q.d(Wt,{Gn:()=>oe,K0:()=>Tt,Qf:()=>oi,R_:()=>Fi,SS:()=>Ue,Um:()=>E,c:()=>mi,e7:()=>je,il:()=>De,mi:()=>Pi,n$:()=>c,nF:()=>ki,nY:()=>re,qz:()=>et,y1:()=>wi});var p=Q(21649),Se=Q(1727),ue=Q(65329),L=Q(86253),G=Q(37207),ke;const Ie=new p.md;function xt(O){return Se.r$.define({combine:O?g=>g.concat(O):void 0})}const ht=new p.md;class wt{constructor(g,S,P=[],F=""){this.data=g,this.name=F,Se.yy.prototype.hasOwnProperty("tree")||Object.defineProperty(Se.yy.prototype,"tree",{get(){return et(this)}}),this.parser=S,this.extension=[ct.of(this),Se.yy.languageData.of((K,U,se)=>{let ae=Je(K,U,se),Ze=ae.type.prop(Ie);if(!Ze)return[];let Ye=K.facet(Ze),Kt=ae.type.prop(ht);if(Kt){let Qi=ae.resolve(U-ae.from,se);for(let zi of Kt)if(zi.test(Qi,K)){let wn=K.facet(zi.facet);return zi.type=="replace"?wn:wn.concat(Ye)}}return Ye})].concat(P)}isActiveAt(g,S,P=-1){return Je(g,S,P).type.prop(Ie)==this.data}findRegions(g){let S=g.facet(ct);if((S==null?void 0:S.data)==this.data)return[{from:0,to:g.doc.length}];if(!S||!S.allowsNesting)return[];let P=[],F=(K,U)=>{if(K.prop(Ie)==this.data){P.push({from:U,to:U+K.length});return}let se=K.prop(p.md.mounted);if(se){if(se.tree.prop(Ie)==this.data){if(se.overlay)for(let ae of se.overlay)P.push({from:ae.from+U,to:ae.to+U});else P.push({from:U,to:U+K.length});return}else if(se.overlay){let ae=P.length;if(F(se.tree,se.overlay[0].from+U),P.length>ae)return}}for(let ae=0;ae<K.children.length;ae++){let Ze=K.children[ae];Ze instanceof p.mp&&F(Ze,K.positions[ae]+U)}};return F(et(g),0),P}get allowsNesting(){return!0}}wt.setState=Se.Py.define();function Je(O,g,S){let P=O.facet(ct),F=et(O).topNode;if(!P||P.allowsNesting)for(let K=F;K;K=K.enter(g,S,p.vj.ExcludeBuffers))K.type.isTop&&(F=K);return F}class vt extends null{constructor(g,S,P){super(g,S,[],P),this.parser=S}static define(g){let S=xt(g.languageData);return new vt(S,g.parser.configure({props:[Ie.add(P=>P.isTop?S:void 0)]}),g.name)}configure(g,S){return new vt(this.data,this.parser.configure(g),S||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function et(O){let g=O.field(wt.state,!1);return g?g.tree:p.mp.empty}function gt(O,g,S=50){var P;let F=(P=O.field(wt.state,!1))===null||P===void 0?void 0:P.context;if(!F)return null;let K=F.viewport;F.updateViewport({from:0,to:g});let U=F.isDone(g)||F.work(S,g)?F.tree:null;return F.updateViewport(K),U}function hi(O,g=O.doc.length){var S;return((S=O.field(wt.state,!1))===null||S===void 0?void 0:S.context.isDone(g))||!1}function li(O,g=O.viewport.to,S=100){let P=gt(O.state,g,S);return P!=et(O.state)&&O.dispatch({}),!!P}function ge(O){var g;return((g=O.plugin(ii))===null||g===void 0?void 0:g.isWorking())||!1}class ot{constructor(g){this.doc=g,this.cursorPos=0,this.string="",this.cursor=g.iter()}get length(){return this.doc.length}syncTo(g){return this.string=this.cursor.next(g-this.cursorPos).value,this.cursorPos=g+this.string.length,this.cursorPos-this.string.length}chunk(g){return this.syncTo(g),this.string}get lineChunks(){return!0}read(g,S){let P=this.cursorPos-this.string.length;return g<P||S>=this.cursorPos?this.doc.sliceString(g,S):this.string.slice(g-P,S-P)}}let Jt=null;class pi{constructor(g,S,P=[],F,K,U,se,ae){this.parser=g,this.state=S,this.fragments=P,this.tree=F,this.treeLen=K,this.viewport=U,this.skipped=se,this.scheduleOn=ae,this.parse=null,this.tempSkipped=[]}static create(g,S,P){return new pi(g,S,[],p.mp.empty,0,P,[],null)}startParse(){return this.parser.startParse(new ot(this.state.doc),this.fragments)}work(g,S){return S!=null&&S>=this.state.doc.length&&(S=void 0),this.tree!=p.mp.empty&&this.isDone(S!=null?S:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var P;if(typeof g=="number"){let F=Date.now()+g;g=()=>Date.now()>F}for(this.parse||(this.parse=this.startParse()),S!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>S)&&S<this.state.doc.length&&this.parse.stopAt(S);;){let F=this.parse.advance();if(F)if(this.fragments=this.withoutTempSkipped(p.i9.addTree(F,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(P=this.parse.stoppedAt)!==null&&P!==void 0?P:this.state.doc.length,this.tree=F,this.parse=null,this.treeLen<(S!=null?S:this.state.doc.length))this.parse=this.startParse();else return!0;if(g())return!1}})}takeTree(){let g,S;this.parse&&(g=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>g)&&this.parse.stopAt(g),this.withContext(()=>{for(;!(S=this.parse.advance()););}),this.treeLen=g,this.tree=S,this.fragments=this.withoutTempSkipped(p.i9.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(g){let S=Jt;Jt=this;try{return g()}finally{Jt=S}}withoutTempSkipped(g){for(let S;S=this.tempSkipped.pop();)g=Oi(g,S.from,S.to);return g}changes(g,S){let{fragments:P,tree:F,treeLen:K,viewport:U,skipped:se}=this;if(this.takeTree(),!g.empty){let ae=[];if(g.iterChangedRanges((Ze,Ye,Kt,Qi)=>ae.push({fromA:Ze,toA:Ye,fromB:Kt,toB:Qi})),P=p.i9.applyChanges(P,ae),F=p.mp.empty,K=0,U={from:g.mapPos(U.from,-1),to:g.mapPos(U.to,1)},this.skipped.length){se=[];for(let Ze of this.skipped){let Ye=g.mapPos(Ze.from,1),Kt=g.mapPos(Ze.to,-1);Ye<Kt&&se.push({from:Ye,to:Kt})}}}return new pi(this.parser,S,P,F,K,U,se,this.scheduleOn)}updateViewport(g){if(this.viewport.from==g.from&&this.viewport.to==g.to)return!1;this.viewport=g;let S=this.skipped.length;for(let P=0;P<this.skipped.length;P++){let{from:F,to:K}=this.skipped[P];F<g.to&&K>g.from&&(this.fragments=Oi(this.fragments,F,K),this.skipped.splice(P--,1))}return this.skipped.length>=S?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(g,S){this.skipped.push({from:g,to:S})}static getSkippingParser(g){return new class extends p._b{createParse(S,P,F){let K=F[0].from,U=F[F.length-1].to;return{parsedPos:K,advance(){let ae=Jt;if(ae){for(let Ze of F)ae.tempSkipped.push(Ze);g&&(ae.scheduleOn=ae.scheduleOn?Promise.all([ae.scheduleOn,g]):g)}return this.parsedPos=U,new p.mp(p.Jq.none,[],[],U-K)},stoppedAt:null,stopAt(){}}}}}isDone(g){g=Math.min(g,this.state.doc.length);let S=this.fragments;return this.treeLen>=g&&S.length&&S[0].from==0&&S[0].to>=g}static get(){return Jt}}function Oi(O,g,S){return p.i9.applyChanges(O,[{fromA:g,toA:S,fromB:g,toB:S}])}class At{constructor(g){this.context=g,this.tree=g.tree}apply(g){if(!g.docChanged&&this.tree==this.context.tree)return this;let S=this.context.changes(g.changes,g.state),P=this.context.treeLen==g.startState.doc.length?void 0:Math.max(g.changes.mapPos(this.context.treeLen),S.viewport.to);return S.work(20,P)||S.takeTree(),new At(S)}static init(g){let S=Math.min(3e3,g.doc.length),P=pi.create(g.facet(ct).parser,g,{from:0,to:S});return P.work(20,S)||P.takeTree(),new At(P)}}wt.state=Se.QQ.define({create:At.init,update(O,g){for(let S of g.effects)if(S.is(wt.setState))return S.value;return g.startState.facet(ct)!=g.state.facet(ct)?At.init(g.state):O.apply(g)}});let si=O=>{let g=setTimeout(()=>O(),500);return()=>clearTimeout(g)};typeof requestIdleCallback!="undefined"&&(si=O=>{let g=-1,S=setTimeout(()=>{g=requestIdleCallback(O,{timeout:500-100})},100);return()=>g<0?clearTimeout(S):cancelIdleCallback(g)});const Ut=typeof navigator!="undefined"&&(!((ke=navigator.scheduling)===null||ke===void 0)&&ke.isInputPending)?()=>navigator.scheduling.isInputPending():null,ii=ue.lg.fromClass(class{constructor(g){this.view=g,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(g){let S=this.view.state.field(wt.state).context;(S.updateViewport(g.view.viewport)||this.view.viewport.to>S.treeLen)&&this.scheduleWork(),(g.docChanged||g.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(S)}scheduleWork(){if(this.working)return;let{state:g}=this.view,S=g.field(wt.state);(S.tree!=S.context.tree||!S.context.isDone(g.doc.length))&&(this.working=si(this.work))}work(g){this.working=null;let S=Date.now();if(this.chunkEnd<S&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=S+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:P,viewport:{to:F}}=this.view,K=P.field(wt.state);if(K.tree==K.context.tree&&K.context.isDone(F+1e5))return;let U=Date.now()+Math.min(this.chunkBudget,100,g&&!Ut?Math.max(25,g.timeRemaining()-5):1e9),se=K.context.treeLen<F&&P.doc.length>F+1e3,ae=K.context.work(()=>Ut&&Ut()||Date.now()>U,F+(se?0:1e5));this.chunkBudget-=Date.now()-S,(ae||this.chunkBudget<=0)&&(K.context.takeTree(),this.view.dispatch({effects:wt.setState.of(new At(K.context))})),this.chunkBudget>0&&!(ae&&!se)&&this.scheduleWork(),this.checkAsyncSchedule(K.context)}checkAsyncSchedule(g){g.scheduleOn&&(this.workScheduled++,g.scheduleOn.then(()=>this.scheduleWork()).catch(S=>(0,ue.OO)(this.view.state,S)).then(()=>this.workScheduled--),g.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),ct=Se.r$.define({combine(O){return O.length?O[0]:null},enables:O=>[wt.state,ii,ue.tk.contentAttributes.compute([O],g=>{let S=g.facet(O);return S&&S.name?{"data-language":S.name}:{}})]});class St{constructor(g,S=[]){this.language=g,this.support=S,this.extension=[g,S]}}class Dt{constructor(g,S,P,F,K,U=void 0){this.name=g,this.alias=S,this.extensions=P,this.filename=F,this.loadFunc=K,this.support=U,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(g=>this.support=g,g=>{throw this.loading=null,g}))}static of(g){let{load:S,support:P}=g;if(!S){if(!P)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");S=()=>Promise.resolve(P)}return new Dt(g.name,(g.alias||[]).concat(g.name).map(F=>F.toLowerCase()),g.extensions||[],g.filename,S,P)}static matchFilename(g,S){for(let F of g)if(F.filename&&F.filename.test(S))return F;let P=/\.([^.]+)$/.exec(S);if(P){for(let F of g)if(F.extensions.indexOf(P[1])>-1)return F}return null}static matchLanguageName(g,S,P=!0){S=S.toLowerCase();for(let F of g)if(F.alias.some(K=>K==S))return F;if(P)for(let F of g)for(let K of F.alias){let U=S.indexOf(K);if(U>-1&&(K.length>2||!/\w/.test(S[U-1])&&!/\w/.test(S[U+K.length])))return F}return null}}const Mi=Se.r$.define(),mi=Se.r$.define({combine:O=>{if(!O.length)return"  ";let g=O[0];if(!g||/\S/.test(g)||Array.from(g).some(S=>S!=g[0]))throw new Error("Invalid indent unit: "+JSON.stringify(O[0]));return g}});function wi(O){let g=O.facet(mi);return g.charCodeAt(0)==9?O.tabSize*g.length:g.length}function Ue(O,g){let S="",P=O.tabSize,F=O.facet(mi)[0];if(F=="	"){for(;g>=P;)S+="	",g-=P;F=" "}for(let K=0;K<g;K++)S+=F;return S}function Tt(O,g){O instanceof Se.yy&&(O=new oe(O));for(let P of O.state.facet(Mi)){let F=P(O,g);if(F!==void 0)return F}let S=et(O.state);return S.length>=g?ve(O,S,g):null}function Ve(O,g,S){let P=Object.create(null),F=new oe(O,{overrideIndentation:U=>{var se;return(se=P[U])!==null&&se!==void 0?se:-1}}),K=[];for(let U=g;U<=S;){let se=O.doc.lineAt(U);U=se.to+1;let ae=Tt(F,se.from);if(ae==null)continue;/\S/.test(se.text)||(ae=0);let Ze=/^\s*/.exec(se.text)[0],Ye=Ue(O,ae);Ze!=Ye&&(P[se.from]=ae,K.push({from:se.from,to:se.from+Ze.length,insert:Ye}))}return O.changes(K)}class oe{constructor(g,S={}){this.state=g,this.options=S,this.unit=wi(g)}lineAt(g,S=1){let P=this.state.doc.lineAt(g),{simulateBreak:F,simulateDoubleBreak:K}=this.options;return F!=null&&F>=P.from&&F<=P.to?K&&F==g?{text:"",from:g}:(S<0?F<g:F<=g)?{text:P.text.slice(F-P.from),from:F}:{text:P.text.slice(0,F-P.from),from:P.from}:P}textAfterPos(g,S=1){if(this.options.simulateDoubleBreak&&g==this.options.simulateBreak)return"";let{text:P,from:F}=this.lineAt(g,S);return P.slice(g-F,Math.min(P.length,g+100-F))}column(g,S=1){let{text:P,from:F}=this.lineAt(g,S),K=this.countColumn(P,g-F),U=this.options.overrideIndentation?this.options.overrideIndentation(F):-1;return U>-1&&(K+=U-this.countColumn(P,P.search(/\S|$/))),K}countColumn(g,S=g.length){return(0,Se.IS)(g,this.state.tabSize,S)}lineIndent(g,S=1){let{text:P,from:F}=this.lineAt(g,S),K=this.options.overrideIndentation;if(K){let U=K(F);if(U>-1)return U}return this.countColumn(P,P.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Te=new p.md;function ve(O,g,S){let P=g.resolveStack(S),F=P.node.enterUnfinishedNodesBefore(S);if(F!=P.node){let K=[];for(let U=F;U!=P.node;U=U.parent)K.push(U);for(let U=K.length-1;U>=0;U--)P={node:K[U],next:P}}return tt(P,O,S)}function tt(O,g,S){for(let P=O;P;P=P.next){let F=it(P.node);if(F)return F(ci.create(g,S,P))}return 0}function Me(O){return O.pos==O.options.simulateBreak&&O.options.simulateDoubleBreak}function it(O){let g=O.type.prop(Te);if(g)return g;let S=O.firstChild,P;if(S&&(P=S.type.prop(p.md.closedBy))){let F=O.lastChild,K=F&&P.indexOf(F.name)>-1;return U=>Pt(U,!0,1,void 0,K&&!Me(U)?F.from:void 0)}return O.parent==null?Ot:null}function Ot(){return 0}class ci extends oe{constructor(g,S,P){super(g.state,g.options),this.base=g,this.pos=S,this.context=P}get node(){return this.context.node}static create(g,S,P){return new ci(g,S,P)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(g){let S=this.state.doc.lineAt(g.from);for(;;){let P=g.resolve(S.from);for(;P.parent&&P.parent.from==P.from;)P=P.parent;if(Et(P,g))break;S=this.state.doc.lineAt(P.from)}return this.lineIndent(S.from)}continue(){return tt(this.context.next,this.base,this.pos)}}function Et(O,g){for(let S=g;S;S=S.parent)if(O==S)return!0;return!1}function Lt(O){let g=O.node,S=g.childAfter(g.from),P=g.lastChild;if(!S)return null;let F=O.options.simulateBreak,K=O.state.doc.lineAt(S.from),U=F==null||F<=K.from?K.to:Math.min(K.to,F);for(let se=S.to;;){let ae=g.childAfter(se);if(!ae||ae==P)return null;if(!ae.type.isSkipped)return ae.from<U?S:null;se=ae.to}}function Nt({closing:O,align:g=!0,units:S=1}){return P=>Pt(P,g,S,O)}function Pt(O,g,S,P,F){let K=O.textAfter,U=K.match(/^\s*/)[0].length,se=P&&K.slice(U,U+P.length)==P||F==O.pos+U,ae=g?Lt(O):null;return ae?se?O.column(ae.from):O.column(ae.to):O.baseIndent+(se?0:O.unit*S)}const gi=O=>O.baseIndent;function Vi({except:O,units:g=1}={}){return S=>{let P=O&&O.test(S.textAfter);return S.baseIndent+(P?0:g*S.unit)}}const Xi=200;function re(){return Se.yy.transactionFilter.of(O=>{if(!O.docChanged||!O.isUserEvent("input.type")&&!O.isUserEvent("input.complete"))return O;let g=O.startState.languageDataAt("indentOnInput",O.startState.selection.main.head);if(!g.length)return O;let S=O.newDoc,{head:P}=O.newSelection.main,F=S.lineAt(P);if(P>F.from+Xi)return O;let K=S.sliceString(F.from,P);if(!g.some(Ze=>Ze.test(K)))return O;let{state:U}=O,se=-1,ae=[];for(let{head:Ze}of U.selection.ranges){let Ye=U.doc.lineAt(Ze);if(Ye.from==se)continue;se=Ye.from;let Kt=Tt(U,Ye.from);if(Kt==null)continue;let Qi=/^\s*/.exec(Ye.text)[0],zi=Ue(U,Kt);Qi!=zi&&ae.push({from:Ye.from,to:Ye.from+Qi.length,insert:zi})}return ae.length?[O,{changes:ae,sequential:!0}]:O})}const b=Se.r$.define(),D=new p.md;function I(O){let g=O.firstChild,S=O.lastChild;return g&&g.to<S.from?{from:g.to,to:S.type.isError?O.to:S.from}:null}function N(O,g,S){let P=et(O);if(P.length<S)return null;let F=P.resolveStack(S,1),K=null;for(let U=F;U;U=U.next){let se=U.node;if(se.to<=S||se.from>S)continue;if(K&&se.from<g)break;let ae=se.type.prop(D);if(ae&&(se.to<P.length-50||P.length==O.doc.length||!Z(se))){let Ze=ae(se,O);Ze&&Ze.from<=S&&Ze.from>=g&&Ze.to>S&&(K=Ze)}}return K}function Z(O){let g=O.lastChild;return g&&g.to==O.to&&g.type.isError}function _(O,g,S){for(let P of O.facet(b)){let F=P(O,g,S);if(F)return F}return N(O,g,S)}function ce(O,g){let S=g.mapPos(O.from,1),P=g.mapPos(O.to,-1);return S>=P?void 0:{from:S,to:P}}const ye=Se.Py.define({map:ce}),We=Se.Py.define({map:ce});function Ee(O){let g=[];for(let{head:S}of O.state.selection.ranges)g.some(P=>P.from<=S&&P.to>=S)||g.push(O.lineBlockAt(S));return g}const Xe=Se.QQ.define({create(){return ue.p.none},update(O,g){O=O.map(g.changes);for(let S of g.effects)if(S.is(ye)&&!Qt(O,S.value.from,S.value.to)){let{preparePlaceholder:P}=g.state.facet(ut),F=P?ue.p.replace({widget:new Vt(P(g.state,S.value))}):st;O=O.update({add:[F.range(S.value.from,S.value.to)]})}else S.is(We)&&(O=O.update({filter:(P,F)=>S.value.from!=P||S.value.to!=F,filterFrom:S.value.from,filterTo:S.value.to}));if(g.selection){let S=!1,{head:P}=g.selection.main;O.between(P,P,(F,K)=>{F<P&&K>P&&(S=!0)}),S&&(O=O.update({filterFrom:P,filterTo:P,filter:(F,K)=>K<=P||F>=P}))}return O},provide:O=>ue.tk.decorations.from(O),toJSON(O,g){let S=[];return O.between(0,g.doc.length,(P,F)=>{S.push(P,F)}),S},fromJSON(O){if(!Array.isArray(O)||O.length%2)throw new RangeError("Invalid JSON for fold state");let g=[];for(let S=0;S<O.length;){let P=O[S++],F=O[S++];if(typeof P!="number"||typeof F!="number")throw new RangeError("Invalid JSON for fold state");g.push(st.range(P,F))}return ue.p.set(g,!0)}});function qe(O){return O.field(Xe,!1)||RangeSet.empty}function ft(O,g,S){var P;let F=null;return(P=O.field(Xe,!1))===null||P===void 0||P.between(g,S,(K,U)=>{(!F||F.from>K)&&(F={from:K,to:U})}),F}function Qt(O,g,S){let P=!1;return O.between(g,g,(F,K)=>{F==g&&K==S&&(P=!0)}),P}function kt(O,g){return O.field(Xe,!1)?g:g.concat(Se.Py.appendConfig.of(Rt()))}const Gt=O=>{for(let g of Ee(O)){let S=_(O.state,g.from,g.to);if(S)return O.dispatch({effects:kt(O.state,[ye.of(S),_t(O,S)])}),!0}return!1},Ht=O=>{if(!O.state.field(Xe,!1))return!1;let g=[];for(let S of Ee(O)){let P=ft(O.state,S.from,S.to);P&&g.push(We.of(P),_t(O,P,!1))}return g.length&&O.dispatch({effects:g}),g.length>0};function _t(O,g,S=!0){let P=O.state.doc.lineAt(g.from).number,F=O.state.doc.lineAt(g.to).number;return ue.tk.announce.of(`${O.state.phrase(S?"Folded lines":"Unfolded lines")} ${P} ${O.state.phrase("to")} ${F}.`)}const Ft=O=>{let{state:g}=O,S=[];for(let P=0;P<g.doc.length;){let F=O.lineBlockAt(P),K=_(g,F.from,F.to);K&&S.push(ye.of(K)),P=(K?O.lineBlockAt(K.to):F).to+1}return S.length&&O.dispatch({effects:kt(O.state,S)}),!!S.length},Xt=O=>{let g=O.state.field(Xe,!1);if(!g||!g.size)return!1;let S=[];return g.between(0,O.state.doc.length,(P,F)=>{S.push(We.of({from:P,to:F}))}),O.dispatch({effects:S}),!0};function Ge(O,g){for(let S=g;;){let P=_(O.state,S.from,S.to);if(P&&P.to>g.from)return P;if(!S.from)return null;S=O.lineBlockAt(S.from-1)}}const jt=O=>{let g=[];for(let S of Ee(O)){let P=ft(O.state,S.from,S.to);if(P)g.push(We.of(P),_t(O,P,!1));else{let F=Ge(O,S);F&&g.push(ye.of(F),_t(O,F))}}return g.length>0&&O.dispatch({effects:kt(O.state,g)}),!!g.length},je=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Gt},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Ht},{key:"Ctrl-Alt-[",run:Ft},{key:"Ctrl-Alt-]",run:Xt}],yt={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},ut=Se.r$.define({combine(O){return(0,Se.BO)(O,yt)}});function Rt(O){let g=[Xe,Ri];return O&&g.push(ut.of(O)),g}function rt(O,g){let{state:S}=O,P=S.facet(ut),F=U=>{let se=O.lineBlockAt(O.posAtDOM(U.target)),ae=ft(O.state,se.from,se.to);ae&&O.dispatch({effects:We.of(ae)}),U.preventDefault()};if(P.placeholderDOM)return P.placeholderDOM(O,F,g);let K=document.createElement("span");return K.textContent=P.placeholderText,K.setAttribute("aria-label",S.phrase("folded code")),K.title=S.phrase("unfold"),K.className="cm-foldPlaceholder",K.onclick=F,K}const st=ue.p.replace({widget:new class extends ue.l9{toDOM(O){return rt(O,null)}}});class Vt extends ue.l9{constructor(g){super(),this.value=g}eq(g){return this.value==g.value}toDOM(g){return rt(g,this.value)}}const Qe={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Yt extends ue.SJ{constructor(g,S){super(),this.config=g,this.open=S}eq(g){return this.config==g.config&&this.open==g.open}toDOM(g){if(this.config.markerDOM)return this.config.markerDOM(this.open);let S=document.createElement("span");return S.textContent=this.open?this.config.openText:this.config.closedText,S.title=g.state.phrase(this.open?"Fold line":"Unfold line"),S}}function Pi(O={}){let g=Object.assign(Object.assign({},Qe),O),S=new Yt(g,!0),P=new Yt(g,!1),F=ue.lg.fromClass(class{constructor(U){this.from=U.viewport.from,this.markers=this.buildMarkers(U)}update(U){(U.docChanged||U.viewportChanged||U.startState.facet(ct)!=U.state.facet(ct)||U.startState.field(Xe,!1)!=U.state.field(Xe,!1)||et(U.startState)!=et(U.state)||g.foldingChanged(U))&&(this.markers=this.buildMarkers(U.view))}buildMarkers(U){let se=new Se.f_;for(let ae of U.viewportLineBlocks){let Ze=ft(U.state,ae.from,ae.to)?P:_(U.state,ae.from,ae.to)?S:null;Ze&&se.add(ae.from,ae.from,Ze)}return se.finish()}}),{domEventHandlers:K}=g;return[F,(0,ue.v5)({class:"cm-foldGutter",markers(U){var se;return((se=U.plugin(F))===null||se===void 0?void 0:se.markers)||Se.Xs.empty},initialSpacer(){return new Yt(g,!1)},domEventHandlers:Object.assign(Object.assign({},K),{click:(U,se,ae)=>{if(K.click&&K.click(U,se,ae))return!0;let Ze=ft(U.state,se.from,se.to);if(Ze)return U.dispatch({effects:We.of(Ze)}),!0;let Ye=_(U.state,se.from,se.to);return Ye?(U.dispatch({effects:ye.of(Ye)}),!0):!1}})}),Rt()]}const Ri=ue.tk.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class oi{constructor(g,S){this.specs=g;let P;function F(se){let ae=G.V.newName();return(P||(P=Object.create(null)))["."+ae]=se,ae}const K=typeof S.all=="string"?S.all:S.all?F(S.all):void 0,U=S.scope;this.scope=U instanceof wt?se=>se.prop(Ie)==U.data:U?se=>se==U:void 0,this.style=(0,L.QR)(g.map(se=>({tag:se.tag,class:se.class||F(Object.assign({},se,{tag:null}))})),{all:K}).style,this.module=P?new G.V(P):null,this.themeType=S.themeType}static define(g,S){return new oi(g,S||{})}}const Yi=Se.r$.define(),ei=Se.r$.define({combine(O){return O.length?[O[0]]:null}});function Si(O){let g=O.facet(Yi);return g.length?g:O.facet(ei)}function ki(O,g){let S=[Bi],P;return O instanceof oi&&(O.module&&S.push(ue.tk.styleModule.of(O.module)),P=O.themeType),g!=null&&g.fallback?S.push(ei.of(O)):P?S.push(Yi.computeN([ue.tk.darkTheme],F=>F.facet(ue.tk.darkTheme)==(P=="dark")?[O]:[])):S.push(Yi.of(O)),S}function nn(O,g,S){let P=Si(O),F=null;if(P){for(let K of P)if(!K.scope||S&&K.scope(S)){let U=K.style(g);U&&(F=F?F+" "+U:U)}}return F}class Ni{constructor(g){this.markCache=Object.create(null),this.tree=et(g.state),this.decorations=this.buildDeco(g,Si(g.state))}update(g){let S=et(g.state),P=Si(g.state),F=P!=Si(g.startState);S.length<g.view.viewport.to&&!F&&S.type==this.tree.type?this.decorations=this.decorations.map(g.changes):(S!=this.tree||g.viewportChanged||F)&&(this.tree=S,this.decorations=this.buildDeco(g.view,P))}buildDeco(g,S){if(!S||!this.tree.length)return ue.p.none;let P=new Se.f_;for(let{from:F,to:K}of g.visibleRanges)(0,L.bW)(this.tree,S,(U,se,ae)=>{P.add(U,se,this.markCache[ae]||(this.markCache[ae]=ue.p.mark({class:ae})))},F,K);return P.finish()}}const Bi=Se.Wl.high(ue.lg.fromClass(Ni,{decorations:O=>O.decorations})),Fi=oi.define([{tag:L.pJ.meta,color:"#404740"},{tag:L.pJ.link,textDecoration:"underline"},{tag:L.pJ.heading,textDecoration:"underline",fontWeight:"bold"},{tag:L.pJ.emphasis,fontStyle:"italic"},{tag:L.pJ.strong,fontWeight:"bold"},{tag:L.pJ.strikethrough,textDecoration:"line-through"},{tag:L.pJ.keyword,color:"#708"},{tag:[L.pJ.atom,L.pJ.bool,L.pJ.url,L.pJ.contentSeparator,L.pJ.labelName],color:"#219"},{tag:[L.pJ.literal,L.pJ.inserted],color:"#164"},{tag:[L.pJ.string,L.pJ.deleted],color:"#a11"},{tag:[L.pJ.regexp,L.pJ.escape,L.pJ.special(L.pJ.string)],color:"#e40"},{tag:L.pJ.definition(L.pJ.variableName),color:"#00f"},{tag:L.pJ.local(L.pJ.variableName),color:"#30a"},{tag:[L.pJ.typeName,L.pJ.namespace],color:"#085"},{tag:L.pJ.className,color:"#167"},{tag:[L.pJ.special(L.pJ.variableName),L.pJ.macroName],color:"#256"},{tag:L.pJ.definition(L.pJ.propertyName),color:"#00c"},{tag:L.pJ.comment,color:"#940"},{tag:L.pJ.invalid,color:"#f00"}]),vn=ue.tk.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Li=1e4,qi="()[]{}",fi=Se.r$.define({combine(O){return(0,Se.BO)(O,{afterCursor:!0,brackets:qi,maxScanDistance:Li,renderMatch:Kn})}}),fn=ue.p.mark({class:"cm-matchingBracket"}),lr=ue.p.mark({class:"cm-nonmatchingBracket"});function Kn(O){let g=[],S=O.matched?fn:lr;return g.push(S.range(O.start.from,O.start.to)),O.end&&g.push(S.range(O.end.from,O.end.to)),g}const R=[Se.QQ.define({create(){return ue.p.none},update(O,g){if(!g.docChanged&&!g.selection)return O;let S=[],P=g.state.facet(fi);for(let F of g.state.selection.ranges){if(!F.empty)continue;let K=E(g.state,F.head,-1,P)||F.head>0&&E(g.state,F.head-1,1,P)||P.afterCursor&&(E(g.state,F.head,1,P)||F.head<g.state.doc.length&&E(g.state,F.head+1,-1,P));K&&(S=S.concat(P.renderMatch(K,g.state)))}return ue.p.set(S,!0)},provide:O=>ue.tk.decorations.from(O)}),vn];function c(O={}){return[fi.of(O),R]}const u=new p.md;function v(O,g,S){let P=O.prop(g<0?p.md.openedBy:p.md.closedBy);if(P)return P;if(O.name.length==1){let F=S.indexOf(O.name);if(F>-1&&F%2==(g<0?1:0))return[S[F+g]]}return null}function w(O){let g=O.type.prop(u);return g?g(O.node):O}function E(O,g,S,P={}){let F=P.maxScanDistance||Li,K=P.brackets||qi,U=et(O),se=U.resolveInner(g,S);for(let ae=se;ae;ae=ae.parent){let Ze=v(ae.type,S,K);if(Ze&&ae.from<ae.to){let Ye=w(ae);if(Ye&&(S>0?g>=Ye.from&&g<Ye.to:g>Ye.from&&g<=Ye.to))return M(O,g,S,ae,Ye,Ze,K)}}return z(O,g,S,U,se.type,F,K)}function M(O,g,S,P,F,K,U){let se=P.parent,ae={from:F.from,to:F.to},Ze=0,Ye=se==null?void 0:se.cursor();if(Ye&&(S<0?Ye.childBefore(P.from):Ye.childAfter(P.to)))do if(S<0?Ye.to<=P.from:Ye.from>=P.to){if(Ze==0&&K.indexOf(Ye.type.name)>-1&&Ye.from<Ye.to){let Kt=w(Ye);return{start:ae,end:Kt?{from:Kt.from,to:Kt.to}:void 0,matched:!0}}else if(v(Ye.type,S,U))Ze++;else if(v(Ye.type,-S,U)){if(Ze==0){let Kt=w(Ye);return{start:ae,end:Kt&&Kt.from<Kt.to?{from:Kt.from,to:Kt.to}:void 0,matched:!1}}Ze--}}while(S<0?Ye.prevSibling():Ye.nextSibling());return{start:ae,matched:!1}}function z(O,g,S,P,F,K,U){let se=S<0?O.sliceDoc(g-1,g):O.sliceDoc(g,g+1),ae=U.indexOf(se);if(ae<0||ae%2==0!=S>0)return null;let Ze={from:S<0?g-1:g,to:S>0?g+1:g},Ye=O.doc.iterRange(g,S>0?O.doc.length:0),Kt=0;for(let Qi=0;!Ye.next().done&&Qi<=K;){let zi=Ye.value;S<0&&(Qi+=zi.length);let wn=g+Qi*S;for(let ln=S>0?0:zi.length-1,cr=S>0?zi.length:-1;ln!=cr;ln+=S){let Bt=U.indexOf(zi[ln]);if(!(Bt<0||P.resolveInner(wn+ln,1).type!=F))if(Bt%2==0==S>0)Kt++;else{if(Kt==1)return{start:Ze,end:{from:wn+ln,to:wn+ln+1},matched:Bt>>1==ae>>1};Kt--}}S>0&&(Qi+=zi.length)}return Ye.done?{start:Ze,matched:!1}:null}function j(O,g,S,P=0,F=0){g==null&&(g=O.search(/[^\s\u00a0]/),g==-1&&(g=O.length));let K=F;for(let U=P;U<g;U++)O.charCodeAt(U)==9?K+=S-K%S:K++;return K}class ie{constructor(g,S,P,F){this.string=g,this.tabSize=S,this.indentUnit=P,this.overrideIndent=F,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(g){let S=this.string.charAt(this.pos),P;if(typeof g=="string"?P=S==g:P=S&&(g instanceof RegExp?g.test(S):g(S)),P)return++this.pos,S}eatWhile(g){let S=this.pos;for(;this.eat(g););return this.pos>S}eatSpace(){let g=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>g}skipToEnd(){this.pos=this.string.length}skipTo(g){let S=this.string.indexOf(g,this.pos);if(S>-1)return this.pos=S,!0}backUp(g){this.pos-=g}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=j(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var g;return(g=this.overrideIndent)!==null&&g!==void 0?g:j(this.string,null,this.tabSize)}match(g,S,P){if(typeof g=="string"){let F=U=>P?U.toLowerCase():U,K=this.string.substr(this.pos,g.length);return F(K)==F(g)?(S!==!1&&(this.pos+=g.length),!0):null}else{let F=this.string.slice(this.pos).match(g);return F&&F.index>0?null:(F&&S!==!1&&(this.pos+=F[0].length),F)}}current(){return this.string.slice(this.start,this.pos)}}function fe(O){return{name:O.name||"",token:O.token,blankLine:O.blankLine||(()=>{}),startState:O.startState||(()=>!0),copyState:O.copyState||be,indent:O.indent||(()=>null),languageData:O.languageData||{},tokenTable:O.tokenTable||ar}}function be(O){if(typeof O!="object")return O;let g={};for(let S in O){let P=O[S];g[S]=P instanceof Array?P.slice():P}return g}const Be=new WeakMap;class De extends wt{constructor(g){let S=xt(g.languageData),P=fe(g),F,K=new class extends p._b{createParse(U,se,ae){return new Jn(F,U,se,ae)}};super(S,K,[Mi.of((U,se)=>this.getIndent(U,se))],g.name),this.topNode=Gr(S),F=this,this.streamParser=P,this.stateAfter=new p.md({perNode:!0}),this.tokenTable=g.tokenTable?new Un(P.tokenTable):Or}static define(g){return new De(g)}getIndent(g,S){let P=et(g.state),F=P.resolve(S);for(;F&&F.type!=this.topNode;)F=F.parent;if(!F)return null;let K,{overrideIndentation:U}=g.options;U&&(K=Be.get(g.state),K!=null&&K<S-1e4&&(K=void 0));let se=Zt(this,P,0,F.from,K!=null?K:S),ae,Ze;if(se?(Ze=se.state,ae=se.pos+1):(Ze=this.streamParser.startState(g.unit),ae=0),S-ae>1e4)return null;for(;ae<S;){let Kt=g.state.doc.lineAt(ae),Qi=Math.min(S,Kt.to);if(Kt.length){let zi=U?U(Kt.from):-1,wn=new ie(Kt.text,g.state.tabSize,g.unit,zi<0?void 0:zi);for(;wn.pos<Qi-Kt.from;)xn(this.streamParser.token,wn,Ze)}else this.streamParser.blankLine(Ze,g.unit);if(Qi==S)break;ae=Kt.to+1}let Ye=g.lineAt(S);return U&&K==null&&Be.set(g.state,Ye.from),this.streamParser.indent(Ze,/^\s*(.*)/.exec(Ye.text)[1],g)}get allowsNesting(){return!1}}function Zt(O,g,S,P,F){let K=S>=P&&S+g.length<=F&&g.prop(O.stateAfter);if(K)return{state:O.streamParser.copyState(K),pos:S+g.length};for(let U=g.children.length-1;U>=0;U--){let se=g.children[U],ae=S+g.positions[U],Ze=se instanceof p.mp&&ae<F&&Zt(O,se,ae,P,F);if(Ze)return Ze}return null}function ui(O,g,S,P,F){if(F&&S<=0&&P>=g.length)return g;!F&&g.type==O.topNode&&(F=!0);for(let K=g.children.length-1;K>=0;K--){let U=g.positions[K],se=g.children[K],ae;if(U<P&&se instanceof p.mp){if(!(ae=ui(O,se,S-U,P-U,F)))break;return F?new p.mp(g.type,g.children.slice(0,K).concat(ae),g.positions.slice(0,K+1),U+ae.length):ae}}return null}function yi(O,g,S,P){for(let F of g){let K=F.from+(F.openStart?25:0),U=F.to-(F.openEnd?25:0),se=K<=S&&U>S&&Zt(O,F.tree,0-F.offset,S,U),ae;if(se&&(ae=ui(O,F.tree,S+F.offset,se.pos+F.offset,!1)))return{state:se.state,tree:ae}}return{state:O.streamParser.startState(P?wi(P):4),tree:p.mp.empty}}class Jn{constructor(g,S,P,F){this.lang=g,this.input=S,this.fragments=P,this.ranges=F,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=F[F.length-1].to;let K=pi.get(),U=F[0].from,{state:se,tree:ae}=yi(g,P,U,K==null?void 0:K.state);this.state=se,this.parsedPos=this.chunkStart=U+ae.length;for(let Ze=0;Ze<ae.children.length;Ze++)this.chunks.push(ae.children[Ze]),this.chunkPos.push(ae.positions[Ze]);K&&this.parsedPos<K.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(wi(K.state)),K.skipUntilInView(this.parsedPos,K.viewport.from),this.parsedPos=K.viewport.from),this.moveRangeIndex()}advance(){let g=pi.get(),S=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),P=Math.min(S,this.chunkStart+2048);for(g&&(P=Math.min(P,g.viewport.to));this.parsedPos<P;)this.parseLine(g);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=S?this.finish():g&&this.parsedPos>=g.viewport.to?(g.skipUntilInView(this.parsedPos,S),this.finish()):null}stopAt(g){this.stoppedAt=g}lineAfter(g){let S=this.input.chunk(g);if(this.input.lineChunks)S==`
`&&(S="");else{let P=S.indexOf(`
`);P>-1&&(S=S.slice(0,P))}return g+S.length<=this.to?S:S.slice(0,this.to-g)}nextLine(){let g=this.parsedPos,S=this.lineAfter(g),P=g+S.length;for(let F=this.rangeIndex;;){let K=this.ranges[F].to;if(K>=P||(S=S.slice(0,K-(P-S.length)),F++,F==this.ranges.length))break;let U=this.ranges[F].from,se=this.lineAfter(U);S+=se,P=U+se.length}return{line:S,end:P}}skipGapsTo(g,S,P){for(;;){let F=this.ranges[this.rangeIndex].to,K=g+S;if(P>0?F>K:F>=K)break;let U=this.ranges[++this.rangeIndex].from;S+=U-F}return S}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(g,S,P,F,K){if(this.ranges.length>1){K=this.skipGapsTo(S,K,1),S+=K;let U=this.chunk.length;K=this.skipGapsTo(P,K,-1),P+=K,F+=this.chunk.length-U}return this.chunk.push(g,S,P,F),K}parseLine(g){let{line:S,end:P}=this.nextLine(),F=0,{streamParser:K}=this.lang,U=new ie(S,g?g.state.tabSize:4,g?wi(g.state):2);if(U.eol())K.blankLine(this.state,U.indentUnit);else for(;!U.eol();){let se=xn(K.token,U,this.state);if(se&&(F=this.emitToken(this.lang.tokenTable.resolve(se),this.parsedPos+U.start,this.parsedPos+U.pos,4,F)),U.start>1e4)break}this.parsedPos=P,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let g=p.mp.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Ur,topID:0,maxBufferLength:2048,reused:this.chunkReused});g=new p.mp(g.type,g.children,g.positions,g.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(g),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new p.mp(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function xn(O,g,S){g.start=g.pos;for(let P=0;P<10;P++){let F=O(g,S);if(g.pos>g.start)return F}throw new Error("Stream parser failed to advance stream.")}const ar=Object.create(null),zt=[p.Jq.none],Ur=new p.Lj(zt),Er=[],Dr=Object.create(null);for(let[O,g]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Dr[O]=Pr(ar,g);class Un{constructor(g){this.extra=g,this.table=Object.assign(Object.create(null),Dr)}resolve(g){return g?this.table[g]||(this.table[g]=Pr(this.extra,g)):0}}const Or=new Un(ar);function hr(O,g){Er.indexOf(O)>-1||(Er.push(O),console.warn(g))}function Pr(O,g){let S=[];for(let K of g.split(" ")){let U=[];for(let se of K.split(".")){let ae=O[se]||L.pJ[se];ae?typeof ae=="function"?U.length?U=U.map(ae):hr(se,`Modifier ${se} used at start of tag`):U.length?hr(se,`Tag ${se} used as modifier`):U=Array.isArray(ae)?ae:[ae]:hr(se,`Unknown highlighting tag ${se}`)}for(let se of U)S.push(se)}if(!S.length)return 0;let P=g.replace(/ /g,"_"),F=p.Jq.define({id:zt.length,name:P,props:[(0,L.Gv)({[P]:S})]});return zt.push(F),F.id}function Gr(O){let g=p.Jq.define({id:zt.length,name:"Document",props:[Ie.add(()=>O)],top:!0});return zt.push(g),g}},42123:(yn,Wt,Q)=>{Q.d(Wt,{r:()=>ue});var p=["true","false","on","off","yes","no"],Se=new RegExp("\\b(("+p.join(")|(")+"))$","i");const ue={name:"yaml",token:function(L,G){var ke=L.peek(),Ie=G.escaped;if(G.escaped=!1,ke=="#"&&(L.pos==0||/\s/.test(L.string.charAt(L.pos-1))))return L.skipToEnd(),"comment";if(L.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(G.literal&&L.indentation()>G.keyCol)return L.skipToEnd(),"string";if(G.literal&&(G.literal=!1),L.sol()){if(G.keyCol=0,G.pair=!1,G.pairStart=!1,L.match("---")||L.match("..."))return"def";if(L.match(/^\s*-\s+/))return"meta"}if(L.match(/^(\{|\}|\[|\])/))return ke=="{"?G.inlinePairs++:ke=="}"?G.inlinePairs--:ke=="["?G.inlineList++:G.inlineList--,"meta";if(G.inlineList>0&&!Ie&&ke==",")return L.next(),"meta";if(G.inlinePairs>0&&!Ie&&ke==",")return G.keyCol=0,G.pair=!1,G.pairStart=!1,L.next(),"meta";if(G.pairStart){if(L.match(/^\s*(\||\>)\s*/))return G.literal=!0,"meta";if(L.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(G.inlinePairs==0&&L.match(/^\s*-?[0-9\.\,]+\s?$/)||G.inlinePairs>0&&L.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(L.match(Se))return"keyword"}return!G.pair&&L.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(G.pair=!0,G.keyCol=L.indentation(),"atom"):G.pair&&L.match(/^:\s*/)?(G.pairStart=!0,"meta"):(G.pairStart=!1,G.escaped=ke=="\\",L.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}}},1727:(yn,Wt,Q)=>{Q.d(Wt,{BO:()=>Yt,D0:()=>ut,Gz:()=>bn,IS:()=>Kn,Py:()=>kt,QQ:()=>Lt,Wl:()=>gi,Xs:()=>ei,YW:()=>Gt,as:()=>ct,bg:()=>Oi,cp:()=>hi,f_:()=>ki,gc:()=>Ut,gm:()=>pi,jT:()=>Ve,n0:()=>ii,nZ:()=>At,q6:()=>qe,r$:()=>ve,uU:()=>Pi,xv:()=>p,yy:()=>Qe});class p{lineAt(c){if(c<0||c>this.length)throw new RangeError(`Invalid position ${c} in document of length ${this.length}`);return this.lineInner(c,!1,1,0)}line(c){if(c<1||c>this.lines)throw new RangeError(`Invalid line number ${c} in ${this.lines}-line document`);return this.lineInner(c,!0,1,0)}replace(c,u,v){let w=[];return this.decompose(0,c,w,2),v.length&&v.decompose(0,v.length,w,3),this.decompose(u,this.length,w,1),ue.from(w,this.length-(u-c)+v.length)}append(c){return this.replace(this.length,this.length,c)}slice(c,u=this.length){let v=[];return this.decompose(c,u,v,0),ue.from(v,u-c)}eq(c){if(c==this)return!0;if(c.length!=this.length||c.lines!=this.lines)return!1;let u=this.scanIdentical(c,1),v=this.length-this.scanIdentical(c,-1),w=new Ie(this),E=new Ie(c);for(let M=u,z=u;;){if(w.next(M),E.next(M),M=0,w.lineBreak!=E.lineBreak||w.done!=E.done||w.value!=E.value)return!1;if(z+=w.value.length,w.done||z>=v)return!0}}iter(c=1){return new Ie(this,c)}iterRange(c,u=this.length){return new xt(this,c,u)}iterLines(c,u){let v;if(c==null)v=this.iter();else{u==null&&(u=this.lines+1);let w=this.line(c).from;v=this.iterRange(w,Math.max(w,u==this.lines+1?this.length:u<=1?0:this.line(u-1).to))}return new ht(v)}toString(){return this.sliceString(0)}toJSON(){let c=[];return this.flatten(c),c}constructor(){}static of(c){if(c.length==0)throw new RangeError("A document must have at least one line");return c.length==1&&!c[0]?p.empty:c.length<=32?new Se(c):ue.from(Se.split(c,[]))}}class Se extends p{constructor(c,u=L(c)){super(),this.text=c,this.length=u}get lines(){return this.text.length}get children(){return null}lineInner(c,u,v,w){for(let E=0;;E++){let M=this.text[E],z=w+M.length;if((u?v:z)>=c)return new wt(w,z,v,M);w=z+1,v++}}decompose(c,u,v,w){let E=c<=0&&u>=this.length?this:new Se(ke(this.text,c,u),Math.min(u,this.length)-Math.max(0,c));if(w&1){let M=v.pop(),z=G(E.text,M.text.slice(),0,E.length);if(z.length<=32)v.push(new Se(z,M.length+E.length));else{let j=z.length>>1;v.push(new Se(z.slice(0,j)),new Se(z.slice(j)))}}else v.push(E)}replace(c,u,v){if(!(v instanceof Se))return super.replace(c,u,v);let w=G(this.text,G(v.text,ke(this.text,0,c)),u),E=this.length+v.length-(u-c);return w.length<=32?new Se(w,E):ue.from(Se.split(w,[]),E)}sliceString(c,u=this.length,v=`
`){let w="";for(let E=0,M=0;E<=u&&M<this.text.length;M++){let z=this.text[M],j=E+z.length;E>c&&M&&(w+=v),c<j&&u>E&&(w+=z.slice(Math.max(0,c-E),u-E)),E=j+1}return w}flatten(c){for(let u of this.text)c.push(u)}scanIdentical(){return 0}static split(c,u){let v=[],w=-1;for(let E of c)v.push(E),w+=E.length+1,v.length==32&&(u.push(new Se(v,w)),v=[],w=-1);return w>-1&&u.push(new Se(v,w)),u}}class ue extends p{constructor(c,u){super(),this.children=c,this.length=u,this.lines=0;for(let v of c)this.lines+=v.lines}lineInner(c,u,v,w){for(let E=0;;E++){let M=this.children[E],z=w+M.length,j=v+M.lines-1;if((u?j:z)>=c)return M.lineInner(c,u,v,w);w=z+1,v=j+1}}decompose(c,u,v,w){for(let E=0,M=0;M<=u&&E<this.children.length;E++){let z=this.children[E],j=M+z.length;if(c<=j&&u>=M){let ie=w&((M<=c?1:0)|(j>=u?2:0));M>=c&&j<=u&&!ie?v.push(z):z.decompose(c-M,u-M,v,ie)}M=j+1}}replace(c,u,v){if(v.lines<this.lines)for(let w=0,E=0;w<this.children.length;w++){let M=this.children[w],z=E+M.length;if(c>=E&&u<=z){let j=M.replace(c-E,u-E,v),ie=this.lines-M.lines+j.lines;if(j.lines<ie>>5-1&&j.lines>ie>>5+1){let fe=this.children.slice();return fe[w]=j,new ue(fe,this.length-(u-c)+v.length)}return super.replace(E,z,j)}E=z+1}return super.replace(c,u,v)}sliceString(c,u=this.length,v=`
`){let w="";for(let E=0,M=0;E<this.children.length&&M<=u;E++){let z=this.children[E],j=M+z.length;M>c&&E&&(w+=v),c<j&&u>M&&(w+=z.sliceString(c-M,u-M,v)),M=j+1}return w}flatten(c){for(let u of this.children)u.flatten(c)}scanIdentical(c,u){if(!(c instanceof ue))return 0;let v=0,[w,E,M,z]=u>0?[0,0,this.children.length,c.children.length]:[this.children.length-1,c.children.length-1,-1,-1];for(;;w+=u,E+=u){if(w==M||E==z)return v;let j=this.children[w],ie=c.children[E];if(j!=ie)return v+j.scanIdentical(ie,u);v+=j.length+1}}static from(c,u=c.reduce((v,w)=>v+w.length+1,-1)){let v=0;for(let De of c)v+=De.lines;if(v<32){let De=[];for(let Zt of c)Zt.flatten(De);return new Se(De,u)}let w=Math.max(32,v>>5),E=w<<1,M=w>>1,z=[],j=0,ie=-1,fe=[];function be(De){let Zt;if(De.lines>E&&De instanceof ue)for(let ui of De.children)be(ui);else De.lines>M&&(j>M||!j)?(Be(),z.push(De)):De instanceof Se&&j&&(Zt=fe[fe.length-1])instanceof Se&&De.lines+Zt.lines<=32?(j+=De.lines,ie+=De.length+1,fe[fe.length-1]=new Se(Zt.text.concat(De.text),Zt.length+1+De.length)):(j+De.lines>w&&Be(),j+=De.lines,ie+=De.length+1,fe.push(De))}function Be(){j!=0&&(z.push(fe.length==1?fe[0]:ue.from(fe,ie)),ie=-1,j=fe.length=0)}for(let De of c)be(De);return Be(),z.length==1?z[0]:new ue(z,u)}}p.empty=new Se([""],0);function L(R){let c=-1;for(let u of R)c+=u.length+1;return c}function G(R,c,u=0,v=1e9){for(let w=0,E=0,M=!0;E<R.length&&w<=v;E++){let z=R[E],j=w+z.length;j>=u&&(j>v&&(z=z.slice(0,v-w)),w<u&&(z=z.slice(u-w)),M?(c[c.length-1]+=z,M=!1):c.push(z)),w=j+1}return c}function ke(R,c,u){return G(R,[""],c,u)}class Ie{constructor(c,u=1){this.dir=u,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[c],this.offsets=[u>0?1:(c instanceof Se?c.text.length:c.children.length)<<1]}nextInner(c,u){for(this.done=this.lineBreak=!1;;){let v=this.nodes.length-1,w=this.nodes[v],E=this.offsets[v],M=E>>1,z=w instanceof Se?w.text.length:w.children.length;if(M==(u>0?z:0)){if(v==0)return this.done=!0,this.value="",this;u>0&&this.offsets[v-1]++,this.nodes.pop(),this.offsets.pop()}else if((E&1)==(u>0?0:1)){if(this.offsets[v]+=u,c==0)return this.lineBreak=!0,this.value=`
`,this;c--}else if(w instanceof Se){let j=w.text[M+(u<0?-1:0)];if(this.offsets[v]+=u,j.length>Math.max(0,c))return this.value=c==0?j:u>0?j.slice(c):j.slice(0,j.length-c),this;c-=j.length}else{let j=w.children[M+(u<0?-1:0)];c>j.length?(c-=j.length,this.offsets[v]+=u):(u<0&&this.offsets[v]--,this.nodes.push(j),this.offsets.push(u>0?1:(j instanceof Se?j.text.length:j.children.length)<<1))}}}next(c=0){return c<0&&(this.nextInner(-c,-this.dir),c=this.value.length),this.nextInner(c,this.dir)}}class xt{constructor(c,u,v){this.value="",this.done=!1,this.cursor=new Ie(c,u>v?-1:1),this.pos=u>v?c.length:0,this.from=Math.min(u,v),this.to=Math.max(u,v)}nextInner(c,u){if(u<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;c+=Math.max(0,u<0?this.pos-this.to:this.from-this.pos);let v=u<0?this.pos-this.from:this.to-this.pos;c>v&&(c=v),v-=c;let{value:w}=this.cursor.next(c);return this.pos+=(w.length+c)*u,this.value=w.length<=v?w:u<0?w.slice(w.length-v):w.slice(0,v),this.done=!this.value,this}next(c=0){return c<0?c=Math.max(c,this.from-this.pos):c>0&&(c=Math.min(c,this.to-this.pos)),this.nextInner(c,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class ht{constructor(c){this.inner=c,this.afterBreak=!0,this.value="",this.done=!1}next(c=0){let{done:u,lineBreak:v,value:w}=this.inner.next(c);return u?(this.done=!0,this.value=""):v?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=w,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol!="undefined"&&(p.prototype[Symbol.iterator]=function(){return this.iter()},Ie.prototype[Symbol.iterator]=xt.prototype[Symbol.iterator]=ht.prototype[Symbol.iterator]=function(){return this});class wt{constructor(c,u,v,w){this.from=c,this.to=u,this.number=v,this.text=w}get length(){return this.to-this.from}}let Je="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(R=>R?parseInt(R,36):1);for(let R=1;R<Je.length;R++)Je[R]+=Je[R-1];function vt(R){for(let c=1;c<Je.length;c+=2)if(Je[c]>R)return Je[c-1]<=R;return!1}function et(R){return R>=127462&&R<=127487}const gt=8205;function hi(R,c,u=!0,v=!0){return(u?li:ge)(R,c,v)}function li(R,c,u){if(c==R.length)return c;c&&ot(R.charCodeAt(c))&&Jt(R.charCodeAt(c-1))&&c--;let v=pi(R,c);for(c+=At(v);c<R.length;){let w=pi(R,c);if(v==gt||w==gt||u&&vt(w))c+=At(w),v=w;else if(et(w)){let E=0,M=c-2;for(;M>=0&&et(pi(R,M));)E++,M-=2;if(E%2==0)break;c+=2}else break}return c}function ge(R,c,u){for(;c>0;){let v=li(R,c-2,u);if(v<c)return v;c--}return 0}function ot(R){return R>=56320&&R<57344}function Jt(R){return R>=55296&&R<56320}function pi(R,c){let u=R.charCodeAt(c);if(!Jt(u)||c+1==R.length)return u;let v=R.charCodeAt(c+1);return ot(v)?(u-55296<<10)+(v-56320)+65536:u}function Oi(R){return R<=65535?String.fromCharCode(R):(R-=65536,String.fromCharCode((R>>10)+55296,(R&1023)+56320))}function At(R){return R<65536?1:2}const si=/\r\n?|\n/;var Ut=function(R){return R[R.Simple=0]="Simple",R[R.TrackDel=1]="TrackDel",R[R.TrackBefore=2]="TrackBefore",R[R.TrackAfter=3]="TrackAfter",R}(Ut||(Ut={}));class ii{constructor(c){this.sections=c}get length(){let c=0;for(let u=0;u<this.sections.length;u+=2)c+=this.sections[u];return c}get newLength(){let c=0;for(let u=0;u<this.sections.length;u+=2){let v=this.sections[u+1];c+=v<0?this.sections[u]:v}return c}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(c){for(let u=0,v=0,w=0;u<this.sections.length;){let E=this.sections[u++],M=this.sections[u++];M<0?(c(v,w,E),w+=E):w+=M,v+=E}}iterChangedRanges(c,u=!1){Mi(this,c,u)}get invertedDesc(){let c=[];for(let u=0;u<this.sections.length;){let v=this.sections[u++],w=this.sections[u++];w<0?c.push(v,w):c.push(w,v)}return new ii(c)}composeDesc(c){return this.empty?c:c.empty?this:wi(this,c)}mapDesc(c,u=!1){return c.empty?this:mi(this,c,u)}mapPos(c,u=-1,v=Ut.Simple){let w=0,E=0;for(let M=0;M<this.sections.length;){let z=this.sections[M++],j=this.sections[M++],ie=w+z;if(j<0){if(ie>c)return E+(c-w);E+=z}else{if(v!=Ut.Simple&&ie>=c&&(v==Ut.TrackDel&&w<c&&ie>c||v==Ut.TrackBefore&&w<c||v==Ut.TrackAfter&&ie>c))return null;if(ie>c||ie==c&&u<0&&!z)return c==w||u<0?E:E+j;E+=j}w=ie}if(c>w)throw new RangeError(`Position ${c} is out of range for changeset of length ${w}`);return E}touchesRange(c,u=c){for(let v=0,w=0;v<this.sections.length&&w<=u;){let E=this.sections[v++],M=this.sections[v++],z=w+E;if(M>=0&&w<=u&&z>=c)return w<c&&z>u?"cover":!0;w=z}return!1}toString(){let c="";for(let u=0;u<this.sections.length;){let v=this.sections[u++],w=this.sections[u++];c+=(c?" ":"")+v+(w>=0?":"+w:"")}return c}toJSON(){return this.sections}static fromJSON(c){if(!Array.isArray(c)||c.length%2||c.some(u=>typeof u!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ii(c)}static create(c){return new ii(c)}}class ct extends ii{constructor(c,u){super(c),this.inserted=u}apply(c){if(this.length!=c.length)throw new RangeError("Applying change set to a document with the wrong length");return Mi(this,(u,v,w,E,M)=>c=c.replace(w,w+(v-u),M),!1),c}mapDesc(c,u=!1){return mi(this,c,u,!0)}invert(c){let u=this.sections.slice(),v=[];for(let w=0,E=0;w<u.length;w+=2){let M=u[w],z=u[w+1];if(z>=0){u[w]=z,u[w+1]=M;let j=w>>1;for(;v.length<j;)v.push(p.empty);v.push(M?c.slice(E,E+M):p.empty)}E+=M}return new ct(u,v)}compose(c){return this.empty?c:c.empty?this:wi(this,c,!0)}map(c,u=!1){return c.empty?this:mi(this,c,u,!0)}iterChanges(c,u=!1){Mi(this,c,u)}get desc(){return ii.create(this.sections)}filter(c){let u=[],v=[],w=[],E=new Ue(this);e:for(let M=0,z=0;;){let j=M==c.length?1e9:c[M++];for(;z<j||z==j&&E.len==0;){if(E.done)break e;let fe=Math.min(E.len,j-z);St(w,fe,-1);let be=E.ins==-1?-1:E.off==0?E.ins:0;St(u,fe,be),be>0&&Dt(v,u,E.text),E.forward(fe),z+=fe}let ie=c[M++];for(;z<ie;){if(E.done)break e;let fe=Math.min(E.len,ie-z);St(u,fe,-1),St(w,fe,E.ins==-1?-1:E.off==0?E.ins:0),E.forward(fe),z+=fe}}return{changes:new ct(u,v),filtered:ii.create(w)}}toJSON(){let c=[];for(let u=0;u<this.sections.length;u+=2){let v=this.sections[u],w=this.sections[u+1];w<0?c.push(v):w==0?c.push([v]):c.push([v].concat(this.inserted[u>>1].toJSON()))}return c}static of(c,u,v){let w=[],E=[],M=0,z=null;function j(fe=!1){if(!fe&&!w.length)return;M<u&&St(w,u-M,-1);let be=new ct(w,E);z=z?z.compose(be.map(z)):be,w=[],E=[],M=0}function ie(fe){if(Array.isArray(fe))for(let be of fe)ie(be);else if(fe instanceof ct){if(fe.length!=u)throw new RangeError(`Mismatched change set length (got ${fe.length}, expected ${u})`);j(),z=z?z.compose(fe.map(z)):fe}else{let{from:be,to:Be=be,insert:De}=fe;if(be>Be||be<0||Be>u)throw new RangeError(`Invalid change range ${be} to ${Be} (in doc of length ${u})`);let Zt=De?typeof De=="string"?p.of(De.split(v||si)):De:p.empty,ui=Zt.length;if(be==Be&&ui==0)return;be<M&&j(),be>M&&St(w,be-M,-1),St(w,Be-be,ui),Dt(E,w,Zt),M=Be}}return ie(c),j(!z),z}static empty(c){return new ct(c?[c,-1]:[],[])}static fromJSON(c){if(!Array.isArray(c))throw new RangeError("Invalid JSON representation of ChangeSet");let u=[],v=[];for(let w=0;w<c.length;w++){let E=c[w];if(typeof E=="number")u.push(E,-1);else{if(!Array.isArray(E)||typeof E[0]!="number"||E.some((M,z)=>z&&typeof M!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(E.length==1)u.push(E[0],0);else{for(;v.length<w;)v.push(p.empty);v[w]=p.of(E.slice(1)),u.push(E[0],v[w].length)}}}return new ct(u,v)}static createSet(c,u){return new ct(c,u)}}function St(R,c,u,v=!1){if(c==0&&u<=0)return;let w=R.length-2;w>=0&&u<=0&&u==R[w+1]?R[w]+=c:c==0&&R[w]==0?R[w+1]+=u:v?(R[w]+=c,R[w+1]+=u):R.push(c,u)}function Dt(R,c,u){if(u.length==0)return;let v=c.length-2>>1;if(v<R.length)R[R.length-1]=R[R.length-1].append(u);else{for(;R.length<v;)R.push(p.empty);R.push(u)}}function Mi(R,c,u){let v=R.inserted;for(let w=0,E=0,M=0;M<R.sections.length;){let z=R.sections[M++],j=R.sections[M++];if(j<0)w+=z,E+=z;else{let ie=w,fe=E,be=p.empty;for(;ie+=z,fe+=j,j&&v&&(be=be.append(v[M-2>>1])),!(u||M==R.sections.length||R.sections[M+1]<0);)z=R.sections[M++],j=R.sections[M++];c(w,ie,E,fe,be),w=ie,E=fe}}}function mi(R,c,u,v=!1){let w=[],E=v?[]:null,M=new Ue(R),z=new Ue(c);for(let j=-1;;)if(M.ins==-1&&z.ins==-1){let ie=Math.min(M.len,z.len);St(w,ie,-1),M.forward(ie),z.forward(ie)}else if(z.ins>=0&&(M.ins<0||j==M.i||M.off==0&&(z.len<M.len||z.len==M.len&&!u))){let ie=z.len;for(St(w,z.ins,-1);ie;){let fe=Math.min(M.len,ie);M.ins>=0&&j<M.i&&M.len<=fe&&(St(w,0,M.ins),E&&Dt(E,w,M.text),j=M.i),M.forward(fe),ie-=fe}z.next()}else if(M.ins>=0){let ie=0,fe=M.len;for(;fe;)if(z.ins==-1){let be=Math.min(fe,z.len);ie+=be,fe-=be,z.forward(be)}else if(z.ins==0&&z.len<fe)fe-=z.len,z.next();else break;St(w,ie,j<M.i?M.ins:0),E&&j<M.i&&Dt(E,w,M.text),j=M.i,M.forward(M.len-fe)}else{if(M.done&&z.done)return E?ct.createSet(w,E):ii.create(w);throw new Error("Mismatched change set lengths")}}function wi(R,c,u=!1){let v=[],w=u?[]:null,E=new Ue(R),M=new Ue(c);for(let z=!1;;){if(E.done&&M.done)return w?ct.createSet(v,w):ii.create(v);if(E.ins==0)St(v,E.len,0,z),E.next();else if(M.len==0&&!M.done)St(v,0,M.ins,z),w&&Dt(w,v,M.text),M.next();else{if(E.done||M.done)throw new Error("Mismatched change set lengths");{let j=Math.min(E.len2,M.len),ie=v.length;if(E.ins==-1){let fe=M.ins==-1?-1:M.off?0:M.ins;St(v,j,fe,z),w&&fe&&Dt(w,v,M.text)}else M.ins==-1?(St(v,E.off?0:E.len,j,z),w&&Dt(w,v,E.textBit(j))):(St(v,E.off?0:E.len,M.off?0:M.ins,z),w&&!M.off&&Dt(w,v,M.text));z=(E.ins>j||M.ins>=0&&M.len>j)&&(z||v.length>ie),E.forward2(j),M.forward(j)}}}}class Ue{constructor(c){this.set=c,this.i=0,this.next()}next(){let{sections:c}=this.set;this.i<c.length?(this.len=c[this.i++],this.ins=c[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:c}=this.set,u=this.i-2>>1;return u>=c.length?p.empty:c[u]}textBit(c){let{inserted:u}=this.set,v=this.i-2>>1;return v>=u.length&&!c?p.empty:u[v].slice(this.off,c==null?void 0:this.off+c)}forward(c){c==this.len?this.next():(this.len-=c,this.off+=c)}forward2(c){this.ins==-1?this.forward(c):c==this.ins?this.next():(this.ins-=c,this.off+=c)}}class Tt{constructor(c,u,v){this.from=c,this.to=u,this.flags=v}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let c=this.flags&7;return c==7?null:c}get goalColumn(){let c=this.flags>>6;return c==16777215?void 0:c}map(c,u=-1){let v,w;return this.empty?v=w=c.mapPos(this.from,u):(v=c.mapPos(this.from,1),w=c.mapPos(this.to,-1)),v==this.from&&w==this.to?this:new Tt(v,w,this.flags)}extend(c,u=c){if(c<=this.anchor&&u>=this.anchor)return Ve.range(c,u);let v=Math.abs(c-this.anchor)>Math.abs(u-this.anchor)?c:u;return Ve.range(this.anchor,v)}eq(c){return this.anchor==c.anchor&&this.head==c.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(c){if(!c||typeof c.anchor!="number"||typeof c.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return Ve.range(c.anchor,c.head)}static create(c,u,v){return new Tt(c,u,v)}}class Ve{constructor(c,u){this.ranges=c,this.mainIndex=u}map(c,u=-1){return c.empty?this:Ve.create(this.ranges.map(v=>v.map(c,u)),this.mainIndex)}eq(c){if(this.ranges.length!=c.ranges.length||this.mainIndex!=c.mainIndex)return!1;for(let u=0;u<this.ranges.length;u++)if(!this.ranges[u].eq(c.ranges[u]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new Ve([this.main],0)}addRange(c,u=!0){return Ve.create([c].concat(this.ranges),u?0:this.mainIndex+1)}replaceRange(c,u=this.mainIndex){let v=this.ranges.slice();return v[u]=c,Ve.create(v,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(c=>c.toJSON()),main:this.mainIndex}}static fromJSON(c){if(!c||!Array.isArray(c.ranges)||typeof c.main!="number"||c.main>=c.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Ve(c.ranges.map(u=>Tt.fromJSON(u)),c.main)}static single(c,u=c){return new Ve([Ve.range(c,u)],0)}static create(c,u=0){if(c.length==0)throw new RangeError("A selection needs at least one range");for(let v=0,w=0;w<c.length;w++){let E=c[w];if(E.empty?E.from<=v:E.from<v)return Ve.normalized(c.slice(),u);v=E.to}return new Ve(c,u)}static cursor(c,u=0,v,w){return Tt.create(c,c,(u==0?0:u<0?8:16)|(v==null?7:Math.min(6,v))|(w!=null?w:16777215)<<6)}static range(c,u,v,w){let E=(v!=null?v:16777215)<<6|(w==null?7:Math.min(6,w));return u<c?Tt.create(u,c,48|E):Tt.create(c,u,(u>c?8:0)|E)}static normalized(c,u=0){let v=c[u];c.sort((w,E)=>w.from-E.from),u=c.indexOf(v);for(let w=1;w<c.length;w++){let E=c[w],M=c[w-1];if(E.empty?E.from<=M.to:E.from<M.to){let z=M.from,j=Math.max(E.to,M.to);w<=u&&u--,c.splice(--w,2,E.anchor>E.head?Ve.range(j,z):Ve.range(z,j))}}return new Ve(c,u)}}function oe(R,c){for(let u of R.ranges)if(u.to>c)throw new RangeError("Selection points outside of document")}let Te=0;class ve{constructor(c,u,v,w,E){this.combine=c,this.compareInput=u,this.compare=v,this.isStatic=w,this.id=Te++,this.default=c([]),this.extensions=typeof E=="function"?E(this):E}get reader(){return this}static define(c={}){return new ve(c.combine||(u=>u),c.compareInput||((u,v)=>u===v),c.compare||(c.combine?(u,v)=>u===v:tt),!!c.static,c.enables)}of(c){return new Me([],this,0,c)}compute(c,u){if(this.isStatic)throw new Error("Can't compute a static facet");return new Me(c,this,1,u)}computeN(c,u){if(this.isStatic)throw new Error("Can't compute a static facet");return new Me(c,this,2,u)}from(c,u){return u||(u=v=>v),this.compute([c],v=>u(v.field(c)))}}function tt(R,c){return R==c||R.length==c.length&&R.every((u,v)=>u===c[v])}class Me{constructor(c,u,v,w){this.dependencies=c,this.facet=u,this.type=v,this.value=w,this.id=Te++}dynamicSlot(c){var u;let v=this.value,w=this.facet.compareInput,E=this.id,M=c[E]>>1,z=this.type==2,j=!1,ie=!1,fe=[];for(let be of this.dependencies)be=="doc"?j=!0:be=="selection"?ie=!0:((u=c[be.id])!==null&&u!==void 0?u:1)&1||fe.push(c[be.id]);return{create(be){return be.values[M]=v(be),1},update(be,Be){if(j&&Be.docChanged||ie&&(Be.docChanged||Be.selection)||Ot(be,fe)){let De=v(be);if(z?!it(De,be.values[M],w):!w(De,be.values[M]))return be.values[M]=De,1}return 0},reconfigure:(be,Be)=>{let De,Zt=Be.config.address[E];if(Zt!=null){let ui=N(Be,Zt);if(this.dependencies.every(yi=>yi instanceof ve?Be.facet(yi)===be.facet(yi):yi instanceof Lt?Be.field(yi,!1)==be.field(yi,!1):!0)||(z?it(De=v(be),ui,w):w(De=v(be),ui)))return be.values[M]=ui,0}else De=v(be);return be.values[M]=De,1}}}}function it(R,c,u){if(R.length!=c.length)return!1;for(let v=0;v<R.length;v++)if(!u(R[v],c[v]))return!1;return!0}function Ot(R,c){let u=!1;for(let v of c)I(R,v)&1&&(u=!0);return u}function ci(R,c,u){let v=u.map(j=>R[j.id]),w=u.map(j=>j.type),E=v.filter(j=>!(j&1)),M=R[c.id]>>1;function z(j){let ie=[];for(let fe=0;fe<v.length;fe++){let be=N(j,v[fe]);if(w[fe]==2)for(let Be of be)ie.push(Be);else ie.push(be)}return c.combine(ie)}return{create(j){for(let ie of v)I(j,ie);return j.values[M]=z(j),1},update(j,ie){if(!Ot(j,E))return 0;let fe=z(j);return c.compare(fe,j.values[M])?0:(j.values[M]=fe,1)},reconfigure(j,ie){let fe=Ot(j,v),be=ie.config.facets[c.id],Be=ie.facet(c);if(be&&!fe&&tt(u,be))return j.values[M]=Be,0;let De=z(j);return c.compare(De,Be)?(j.values[M]=Be,0):(j.values[M]=De,1)}}}const Et=ve.define({static:!0});class Lt{constructor(c,u,v,w,E){this.id=c,this.createF=u,this.updateF=v,this.compareF=w,this.spec=E,this.provides=void 0}static define(c){let u=new Lt(Te++,c.create,c.update,c.compare||((v,w)=>v===w),c);return c.provide&&(u.provides=c.provide(u)),u}create(c){let u=c.facet(Et).find(v=>v.field==this);return((u==null?void 0:u.create)||this.createF)(c)}slot(c){let u=c[this.id]>>1;return{create:v=>(v.values[u]=this.create(v),1),update:(v,w)=>{let E=v.values[u],M=this.updateF(E,w);return this.compareF(E,M)?0:(v.values[u]=M,1)},reconfigure:(v,w)=>w.config.address[this.id]!=null?(v.values[u]=w.field(this),0):(v.values[u]=this.create(v),1)}}init(c){return[this,Et.of({field:this,create:c})]}get extension(){return this}}const Nt={lowest:4,low:3,default:2,high:1,highest:0};function Pt(R){return c=>new Vi(c,R)}const gi={highest:Pt(Nt.highest),high:Pt(Nt.high),default:Pt(Nt.default),low:Pt(Nt.low),lowest:Pt(Nt.lowest)};class Vi{constructor(c,u){this.inner=c,this.prec=u}}class Xi{of(c){return new re(this,c)}reconfigure(c){return Xi.reconfigure.of({compartment:this,extension:c})}get(c){return c.config.compartments.get(this)}}class re{constructor(c,u){this.compartment=c,this.inner=u}}class b{constructor(c,u,v,w,E,M){for(this.base=c,this.compartments=u,this.dynamicSlots=v,this.address=w,this.staticValues=E,this.facets=M,this.statusTemplate=[];this.statusTemplate.length<v.length;)this.statusTemplate.push(0)}staticFacet(c){let u=this.address[c.id];return u==null?c.default:this.staticValues[u>>1]}static resolve(c,u,v){let w=[],E=Object.create(null),M=new Map;for(let Be of D(c,u,M))Be instanceof Lt?w.push(Be):(E[Be.facet.id]||(E[Be.facet.id]=[])).push(Be);let z=Object.create(null),j=[],ie=[];for(let Be of w)z[Be.id]=ie.length<<1,ie.push(De=>Be.slot(De));let fe=v==null?void 0:v.config.facets;for(let Be in E){let De=E[Be],Zt=De[0].facet,ui=fe&&fe[Be]||[];if(De.every(yi=>yi.type==0))if(z[Zt.id]=j.length<<1|1,tt(ui,De))j.push(v.facet(Zt));else{let yi=Zt.combine(De.map(Jn=>Jn.value));j.push(v&&Zt.compare(yi,v.facet(Zt))?v.facet(Zt):yi)}else{for(let yi of De)yi.type==0?(z[yi.id]=j.length<<1|1,j.push(yi.value)):(z[yi.id]=ie.length<<1,ie.push(Jn=>yi.dynamicSlot(Jn)));z[Zt.id]=ie.length<<1,ie.push(yi=>ci(yi,Zt,De))}}let be=ie.map(Be=>Be(z));return new b(c,M,be,z,j,E)}}function D(R,c,u){let v=[[],[],[],[],[]],w=new Map;function E(M,z){let j=w.get(M);if(j!=null){if(j<=z)return;let ie=v[j].indexOf(M);ie>-1&&v[j].splice(ie,1),M instanceof re&&u.delete(M.compartment)}if(w.set(M,z),Array.isArray(M))for(let ie of M)E(ie,z);else if(M instanceof re){if(u.has(M.compartment))throw new RangeError("Duplicate use of compartment in extensions");let ie=c.get(M.compartment)||M.inner;u.set(M.compartment,ie),E(ie,z)}else if(M instanceof Vi)E(M.inner,M.prec);else if(M instanceof Lt)v[z].push(M),M.provides&&E(M.provides,z);else if(M instanceof Me)v[z].push(M),M.facet.extensions&&E(M.facet.extensions,Nt.default);else{let ie=M.extension;if(!ie)throw new Error(`Unrecognized extension value in extension set (${M}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);E(ie,z)}}return E(R,Nt.default),v.reduce((M,z)=>M.concat(z))}function I(R,c){if(c&1)return 2;let u=c>>1,v=R.status[u];if(v==4)throw new Error("Cyclic dependency between fields and/or facets");if(v&2)return v;R.status[u]=4;let w=R.computeSlot(R,R.config.dynamicSlots[u]);return R.status[u]=2|w}function N(R,c){return c&1?R.config.staticValues[c>>1]:R.values[c>>1]}const Z=ve.define(),_=ve.define({combine:R=>R.some(c=>c),static:!0}),ce=ve.define({combine:R=>R.length?R[0]:void 0,static:!0}),ye=ve.define(),We=ve.define(),Ee=ve.define(),Xe=ve.define({combine:R=>R.length?R[0]:!1});class qe{constructor(c,u){this.type=c,this.value=u}static define(){return new ft}}class ft{of(c){return new qe(this,c)}}class Qt{constructor(c){this.map=c}of(c){return new kt(this,c)}}class kt{constructor(c,u){this.type=c,this.value=u}map(c){let u=this.type.map(this.value,c);return u===void 0?void 0:u==this.value?this:new kt(this.type,u)}is(c){return this.type==c}static define(c={}){return new Qt(c.map||(u=>u))}static mapEffects(c,u){if(!c.length)return c;let v=[];for(let w of c){let E=w.map(u);E&&v.push(E)}return v}}kt.reconfigure=kt.define(),kt.appendConfig=kt.define();class Gt{constructor(c,u,v,w,E,M){this.startState=c,this.changes=u,this.selection=v,this.effects=w,this.annotations=E,this.scrollIntoView=M,this._doc=null,this._state=null,v&&oe(v,u.newLength),E.some(z=>z.type==Gt.time)||(this.annotations=E.concat(Gt.time.of(Date.now())))}static create(c,u,v,w,E,M){return new Gt(c,u,v,w,E,M)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(c){for(let u of this.annotations)if(u.type==c)return u.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(c){let u=this.annotation(Gt.userEvent);return!!(u&&(u==c||u.length>c.length&&u.slice(0,c.length)==c&&u[c.length]=="."))}}Gt.time=qe.define(),Gt.userEvent=qe.define(),Gt.addToHistory=qe.define(),Gt.remote=qe.define();function Ht(R,c){let u=[];for(let v=0,w=0;;){let E,M;if(v<R.length&&(w==c.length||c[w]>=R[v]))E=R[v++],M=R[v++];else if(w<c.length)E=c[w++],M=c[w++];else return u;!u.length||u[u.length-1]<E?u.push(E,M):u[u.length-1]<M&&(u[u.length-1]=M)}}function _t(R,c,u){var v;let w,E,M;return u?(w=c.changes,E=ct.empty(c.changes.length),M=R.changes.compose(c.changes)):(w=c.changes.map(R.changes),E=R.changes.mapDesc(c.changes,!0),M=R.changes.compose(w)),{changes:M,selection:c.selection?c.selection.map(E):(v=R.selection)===null||v===void 0?void 0:v.map(w),effects:kt.mapEffects(R.effects,w).concat(kt.mapEffects(c.effects,E)),annotations:R.annotations.length?R.annotations.concat(c.annotations):c.annotations,scrollIntoView:R.scrollIntoView||c.scrollIntoView}}function Ft(R,c,u){let v=c.selection,w=yt(c.annotations);return c.userEvent&&(w=w.concat(Gt.userEvent.of(c.userEvent))),{changes:c.changes instanceof ct?c.changes:ct.of(c.changes||[],u,R.facet(ce)),selection:v&&(v instanceof Ve?v:Ve.single(v.anchor,v.head)),effects:yt(c.effects),annotations:w,scrollIntoView:!!c.scrollIntoView}}function Xt(R,c,u){let v=Ft(R,c.length?c[0]:{},R.doc.length);c.length&&c[0].filter===!1&&(u=!1);for(let E=1;E<c.length;E++){c[E].filter===!1&&(u=!1);let M=!!c[E].sequential;v=_t(v,Ft(R,c[E],M?v.changes.newLength:R.doc.length),M)}let w=Gt.create(R,v.changes,v.selection,v.effects,v.annotations,v.scrollIntoView);return jt(u?Ge(w):w)}function Ge(R){let c=R.startState,u=!0;for(let w of c.facet(ye)){let E=w(R);if(E===!1){u=!1;break}Array.isArray(E)&&(u=u===!0?E:Ht(u,E))}if(u!==!0){let w,E;if(u===!1)E=R.changes.invertedDesc,w=ct.empty(c.doc.length);else{let M=R.changes.filter(u);w=M.changes,E=M.filtered.mapDesc(M.changes).invertedDesc}R=Gt.create(c,w,R.selection&&R.selection.map(E),kt.mapEffects(R.effects,E),R.annotations,R.scrollIntoView)}let v=c.facet(We);for(let w=v.length-1;w>=0;w--){let E=v[w](R);E instanceof Gt?R=E:Array.isArray(E)&&E.length==1&&E[0]instanceof Gt?R=E[0]:R=Xt(c,yt(E),!1)}return R}function jt(R){let c=R.startState,u=c.facet(Ee),v=R;for(let w=u.length-1;w>=0;w--){let E=u[w](R);E&&Object.keys(E).length&&(v=_t(v,Ft(c,E,R.changes.newLength),!0))}return v==R?R:Gt.create(c,R.changes,R.selection,v.effects,v.annotations,v.scrollIntoView)}const je=[];function yt(R){return R==null?je:Array.isArray(R)?R:[R]}var ut=function(R){return R[R.Word=0]="Word",R[R.Space=1]="Space",R[R.Other=2]="Other",R}(ut||(ut={}));const Rt=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let rt;try{rt=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function st(R){if(rt)return rt.test(R);for(let c=0;c<R.length;c++){let u=R[c];if(/\w/.test(u)||u>"\x80"&&(u.toUpperCase()!=u.toLowerCase()||Rt.test(u)))return!0}return!1}function Vt(R){return c=>{if(!/\S/.test(c))return ut.Space;if(st(c))return ut.Word;for(let u=0;u<R.length;u++)if(c.indexOf(R[u])>-1)return ut.Word;return ut.Other}}class Qe{constructor(c,u,v,w,E,M){this.config=c,this.doc=u,this.selection=v,this.values=w,this.status=c.statusTemplate.slice(),this.computeSlot=E,M&&(M._state=this);for(let z=0;z<this.config.dynamicSlots.length;z++)I(this,z<<1);this.computeSlot=null}field(c,u=!0){let v=this.config.address[c.id];if(v==null){if(u)throw new RangeError("Field is not present in this state");return}return I(this,v),N(this,v)}update(...c){return Xt(this,c,!0)}applyTransaction(c){let u=this.config,{base:v,compartments:w}=u;for(let M of c.effects)M.is(Xi.reconfigure)?(u&&(w=new Map,u.compartments.forEach((z,j)=>w.set(j,z)),u=null),w.set(M.value.compartment,M.value.extension)):M.is(kt.reconfigure)?(u=null,v=M.value):M.is(kt.appendConfig)&&(u=null,v=yt(v).concat(M.value));let E;u?E=c.startState.values.slice():(u=b.resolve(v,w,this),E=new Qe(u,this.doc,this.selection,u.dynamicSlots.map(()=>null),(z,j)=>j.reconfigure(z,this),null).values),new Qe(u,c.newDoc,c.newSelection,E,(M,z)=>z.update(M,c),c)}replaceSelection(c){return typeof c=="string"&&(c=this.toText(c)),this.changeByRange(u=>({changes:{from:u.from,to:u.to,insert:c},range:Ve.cursor(u.from+c.length)}))}changeByRange(c){let u=this.selection,v=c(u.ranges[0]),w=this.changes(v.changes),E=[v.range],M=yt(v.effects);for(let z=1;z<u.ranges.length;z++){let j=c(u.ranges[z]),ie=this.changes(j.changes),fe=ie.map(w);for(let Be=0;Be<z;Be++)E[Be]=E[Be].map(fe);let be=w.mapDesc(ie,!0);E.push(j.range.map(be)),w=w.compose(fe),M=kt.mapEffects(M,fe).concat(kt.mapEffects(yt(j.effects),be))}return{changes:w,selection:Ve.create(E,u.mainIndex),effects:M}}changes(c=[]){return c instanceof ct?c:ct.of(c,this.doc.length,this.facet(Qe.lineSeparator))}toText(c){return p.of(c.split(this.facet(Qe.lineSeparator)||si))}sliceDoc(c=0,u=this.doc.length){return this.doc.sliceString(c,u,this.lineBreak)}facet(c){let u=this.config.address[c.id];return u==null?c.default:(I(this,u),N(this,u))}toJSON(c){let u={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(c)for(let v in c){let w=c[v];w instanceof Lt&&this.config.address[w.id]!=null&&(u[v]=w.spec.toJSON(this.field(c[v]),this))}return u}static fromJSON(c,u={},v){if(!c||typeof c.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let w=[];if(v){for(let E in v)if(Object.prototype.hasOwnProperty.call(c,E)){let M=v[E],z=c[E];w.push(M.init(j=>M.spec.fromJSON(z,j)))}}return Qe.create({doc:c.doc,selection:Ve.fromJSON(c.selection),extensions:u.extensions?w.concat([u.extensions]):w})}static create(c={}){let u=b.resolve(c.extensions||[],new Map),v=c.doc instanceof p?c.doc:p.of((c.doc||"").split(u.staticFacet(Qe.lineSeparator)||si)),w=c.selection?c.selection instanceof Ve?c.selection:Ve.single(c.selection.anchor,c.selection.head):Ve.single(0);return oe(w,v.length),u.staticFacet(_)||(w=w.asSingle()),new Qe(u,v,w,u.dynamicSlots.map(()=>null),(E,M)=>M.create(E),null)}get tabSize(){return this.facet(Qe.tabSize)}get lineBreak(){return this.facet(Qe.lineSeparator)||`
`}get readOnly(){return this.facet(Xe)}phrase(c,...u){for(let v of this.facet(Qe.phrases))if(Object.prototype.hasOwnProperty.call(v,c)){c=v[c];break}return u.length&&(c=c.replace(/\$(\$|\d*)/g,(v,w)=>{if(w=="$")return"$";let E=+(w||1);return!E||E>u.length?v:u[E-1]})),c}languageDataAt(c,u,v=-1){let w=[];for(let E of this.facet(Z))for(let M of E(this,u,v))Object.prototype.hasOwnProperty.call(M,c)&&w.push(M[c]);return w}charCategorizer(c){return Vt(this.languageDataAt("wordChars",c).join(""))}wordAt(c){let{text:u,from:v,length:w}=this.doc.lineAt(c),E=this.charCategorizer(c),M=c-v,z=c-v;for(;M>0;){let j=hi(u,M,!1);if(E(u.slice(j,M))!=ut.Word)break;M=j}for(;z<w;){let j=hi(u,z);if(E(u.slice(z,j))!=ut.Word)break;z=j}return M==z?null:Ve.range(M+v,z+v)}}Qe.allowMultipleSelections=_,Qe.tabSize=ve.define({combine:R=>R.length?R[0]:4}),Qe.lineSeparator=ce,Qe.readOnly=Xe,Qe.phrases=ve.define({compare(R,c){let u=Object.keys(R),v=Object.keys(c);return u.length==v.length&&u.every(w=>R[w]==c[w])}}),Qe.languageData=Z,Qe.changeFilter=ye,Qe.transactionFilter=We,Qe.transactionExtender=Ee,Xi.reconfigure=kt.define();function Yt(R,c,u={}){let v={};for(let w of R)for(let E of Object.keys(w)){let M=w[E],z=v[E];if(z===void 0)v[E]=M;else if(!(z===M||M===void 0))if(Object.hasOwnProperty.call(u,E))v[E]=u[E](z,M);else throw new Error("Config merge conflict for field "+E)}for(let w in c)v[w]===void 0&&(v[w]=c[w]);return v}class Pi{eq(c){return this==c}range(c,u=c){return Ri.create(c,u,this)}}Pi.prototype.startSide=Pi.prototype.endSide=0,Pi.prototype.point=!1,Pi.prototype.mapMode=Ut.TrackDel;class Ri{constructor(c,u,v){this.from=c,this.to=u,this.value=v}static create(c,u,v){return new Ri(c,u,v)}}function oi(R,c){return R.from-c.from||R.value.startSide-c.value.startSide}class Yi{constructor(c,u,v,w){this.from=c,this.to=u,this.value=v,this.maxPoint=w}get length(){return this.to[this.to.length-1]}findIndex(c,u,v,w=0){let E=v?this.to:this.from;for(let M=w,z=E.length;;){if(M==z)return M;let j=M+z>>1,ie=E[j]-c||(v?this.value[j].endSide:this.value[j].startSide)-u;if(j==M)return ie>=0?M:z;ie>=0?z=j:M=j+1}}between(c,u,v,w){for(let E=this.findIndex(u,-1e9,!0),M=this.findIndex(v,1e9,!1,E);E<M;E++)if(w(this.from[E]+c,this.to[E]+c,this.value[E])===!1)return!1}map(c,u){let v=[],w=[],E=[],M=-1,z=-1;for(let j=0;j<this.value.length;j++){let ie=this.value[j],fe=this.from[j]+c,be=this.to[j]+c,Be,De;if(fe==be){let Zt=u.mapPos(fe,ie.startSide,ie.mapMode);if(Zt==null||(Be=De=Zt,ie.startSide!=ie.endSide&&(De=u.mapPos(fe,ie.endSide),De<Be)))continue}else if(Be=u.mapPos(fe,ie.startSide),De=u.mapPos(be,ie.endSide),Be>De||Be==De&&ie.startSide>0&&ie.endSide<=0)continue;(De-Be||ie.endSide-ie.startSide)<0||(M<0&&(M=Be),ie.point&&(z=Math.max(z,De-Be)),v.push(ie),w.push(Be-M),E.push(De-M))}return{mapped:v.length?new Yi(w,E,v,z):null,pos:M}}}class ei{constructor(c,u,v,w){this.chunkPos=c,this.chunk=u,this.nextLayer=v,this.maxPoint=w}static create(c,u,v,w){return new ei(c,u,v,w)}get length(){let c=this.chunk.length-1;return c<0?0:Math.max(this.chunkEnd(c),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let c=this.nextLayer.size;for(let u of this.chunk)c+=u.value.length;return c}chunkEnd(c){return this.chunkPos[c]+this.chunk[c].length}update(c){let{add:u=[],sort:v=!1,filterFrom:w=0,filterTo:E=this.length}=c,M=c.filter;if(u.length==0&&!M)return this;if(v&&(u=u.slice().sort(oi)),this.isEmpty)return u.length?ei.of(u):this;let z=new Ni(this,null,-1).goto(0),j=0,ie=[],fe=new ki;for(;z.value||j<u.length;)if(j<u.length&&(z.from-u[j].from||z.startSide-u[j].value.startSide)>=0){let be=u[j++];fe.addInner(be.from,be.to,be.value)||ie.push(be)}else z.rangeIndex==1&&z.chunkIndex<this.chunk.length&&(j==u.length||this.chunkEnd(z.chunkIndex)<u[j].from)&&(!M||w>this.chunkEnd(z.chunkIndex)||E<this.chunkPos[z.chunkIndex])&&fe.addChunk(this.chunkPos[z.chunkIndex],this.chunk[z.chunkIndex])?z.nextChunk():((!M||w>z.to||E<z.from||M(z.from,z.to,z.value))&&(fe.addInner(z.from,z.to,z.value)||ie.push(Ri.create(z.from,z.to,z.value))),z.next());return fe.finishInner(this.nextLayer.isEmpty&&!ie.length?ei.empty:this.nextLayer.update({add:ie,filter:M,filterFrom:w,filterTo:E}))}map(c){if(c.empty||this.isEmpty)return this;let u=[],v=[],w=-1;for(let M=0;M<this.chunk.length;M++){let z=this.chunkPos[M],j=this.chunk[M],ie=c.touchesRange(z,z+j.length);if(ie===!1)w=Math.max(w,j.maxPoint),u.push(j),v.push(c.mapPos(z));else if(ie===!0){let{mapped:fe,pos:be}=j.map(z,c);fe&&(w=Math.max(w,fe.maxPoint),u.push(fe),v.push(be))}}let E=this.nextLayer.map(c);return u.length==0?E:new ei(v,u,E||ei.empty,w)}between(c,u,v){if(!this.isEmpty){for(let w=0;w<this.chunk.length;w++){let E=this.chunkPos[w],M=this.chunk[w];if(u>=E&&c<=E+M.length&&M.between(E,c-E,u-E,v)===!1)return}this.nextLayer.between(c,u,v)}}iter(c=0){return Bi.from([this]).goto(c)}get isEmpty(){return this.nextLayer==this}static iter(c,u=0){return Bi.from(c).goto(u)}static compare(c,u,v,w,E=-1){let M=c.filter(be=>be.maxPoint>0||!be.isEmpty&&be.maxPoint>=E),z=u.filter(be=>be.maxPoint>0||!be.isEmpty&&be.maxPoint>=E),j=nn(M,z,v),ie=new vn(M,j,E),fe=new vn(z,j,E);v.iterGaps((be,Be,De)=>Li(ie,be,fe,Be,De,w)),v.empty&&v.length==0&&Li(ie,0,fe,0,0,w)}static eq(c,u,v=0,w){w==null&&(w=1e9-1);let E=c.filter(fe=>!fe.isEmpty&&u.indexOf(fe)<0),M=u.filter(fe=>!fe.isEmpty&&c.indexOf(fe)<0);if(E.length!=M.length)return!1;if(!E.length)return!0;let z=nn(E,M),j=new vn(E,z,0).goto(v),ie=new vn(M,z,0).goto(v);for(;;){if(j.to!=ie.to||!qi(j.active,ie.active)||j.point&&(!ie.point||!j.point.eq(ie.point)))return!1;if(j.to>w)return!0;j.next(),ie.next()}}static spans(c,u,v,w,E=-1){let M=new vn(c,null,E).goto(u),z=u,j=M.openStart;for(;;){let ie=Math.min(M.to,v);if(M.point){let fe=M.activeForPoint(M.to),be=M.pointFrom<u?fe.length+1:Math.min(fe.length,j);w.point(z,ie,M.point,fe,be,M.pointRank),j=Math.min(M.openEnd(ie),fe.length)}else ie>z&&(w.span(z,ie,M.active,j),j=M.openEnd(ie));if(M.to>v)return j+(M.point&&M.to>v?1:0);z=M.to,M.next()}}static of(c,u=!1){let v=new ki;for(let w of c instanceof Ri?[c]:u?Si(c):c)v.add(w.from,w.to,w.value);return v.finish()}}ei.empty=new ei([],[],null,-1);function Si(R){if(R.length>1)for(let c=R[0],u=1;u<R.length;u++){let v=R[u];if(oi(c,v)>0)return R.slice().sort(oi);c=v}return R}ei.empty.nextLayer=ei.empty;class ki{finishChunk(c){this.chunks.push(new Yi(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,c&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(c,u,v){this.addInner(c,u,v)||(this.nextLayer||(this.nextLayer=new ki)).add(c,u,v)}addInner(c,u,v){let w=c-this.lastTo||v.startSide-this.last.endSide;if(w<=0&&(c-this.lastFrom||v.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return w<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=c),this.from.push(c-this.chunkStart),this.to.push(u-this.chunkStart),this.last=v,this.lastFrom=c,this.lastTo=u,this.value.push(v),v.point&&(this.maxPoint=Math.max(this.maxPoint,u-c)),!0)}addChunk(c,u){if((c-this.lastTo||u.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,u.maxPoint),this.chunks.push(u),this.chunkPos.push(c);let v=u.value.length-1;return this.last=u.value[v],this.lastFrom=u.from[v]+c,this.lastTo=u.to[v]+c,!0}finish(){return this.finishInner(ei.empty)}finishInner(c){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return c;let u=ei.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(c):c,this.setMaxPoint);return this.from=null,u}}function nn(R,c,u){let v=new Map;for(let E of R)for(let M=0;M<E.chunk.length;M++)E.chunk[M].maxPoint<=0&&v.set(E.chunk[M],E.chunkPos[M]);let w=new Set;for(let E of c)for(let M=0;M<E.chunk.length;M++){let z=v.get(E.chunk[M]);z!=null&&(u?u.mapPos(z):z)==E.chunkPos[M]&&!(u!=null&&u.touchesRange(z,z+E.chunk[M].length))&&w.add(E.chunk[M])}return w}class Ni{constructor(c,u,v,w=0){this.layer=c,this.skip=u,this.minPoint=v,this.rank=w}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(c,u=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(c,u,!1),this}gotoInner(c,u,v){for(;this.chunkIndex<this.layer.chunk.length;){let w=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(w)||this.layer.chunkEnd(this.chunkIndex)<c||w.maxPoint<this.minPoint))break;this.chunkIndex++,v=!1}if(this.chunkIndex<this.layer.chunk.length){let w=this.layer.chunk[this.chunkIndex].findIndex(c-this.layer.chunkPos[this.chunkIndex],u,!0);(!v||this.rangeIndex<w)&&this.setRangeIndex(w)}this.next()}forward(c,u){(this.to-c||this.endSide-u)<0&&this.gotoInner(c,u,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let c=this.layer.chunkPos[this.chunkIndex],u=this.layer.chunk[this.chunkIndex],v=c+u.from[this.rangeIndex];if(this.from=v,this.to=c+u.to[this.rangeIndex],this.value=u.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(c){if(c==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=c}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(c){return this.from-c.from||this.startSide-c.startSide||this.rank-c.rank||this.to-c.to||this.endSide-c.endSide}}class Bi{constructor(c){this.heap=c}static from(c,u=null,v=-1){let w=[];for(let E=0;E<c.length;E++)for(let M=c[E];!M.isEmpty;M=M.nextLayer)M.maxPoint>=v&&w.push(new Ni(M,u,v,E));return w.length==1?w[0]:new Bi(w)}get startSide(){return this.value?this.value.startSide:0}goto(c,u=-1e9){for(let v of this.heap)v.goto(c,u);for(let v=this.heap.length>>1;v>=0;v--)Fi(this.heap,v);return this.next(),this}forward(c,u){for(let v of this.heap)v.forward(c,u);for(let v=this.heap.length>>1;v>=0;v--)Fi(this.heap,v);(this.to-c||this.value.endSide-u)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let c=this.heap[0];this.from=c.from,this.to=c.to,this.value=c.value,this.rank=c.rank,c.value&&c.next(),Fi(this.heap,0)}}}function Fi(R,c){for(let u=R[c];;){let v=(c<<1)+1;if(v>=R.length)break;let w=R[v];if(v+1<R.length&&w.compare(R[v+1])>=0&&(w=R[v+1],v++),u.compare(w)<0)break;R[v]=u,R[c]=w,c=v}}class vn{constructor(c,u,v){this.minPoint=v,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Bi.from(c,u,v)}goto(c,u=-1e9){return this.cursor.goto(c,u),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=c,this.endSide=u,this.openStart=-1,this.next(),this}forward(c,u){for(;this.minActive>-1&&(this.activeTo[this.minActive]-c||this.active[this.minActive].endSide-u)<0;)this.removeActive(this.minActive);this.cursor.forward(c,u)}removeActive(c){fi(this.active,c),fi(this.activeTo,c),fi(this.activeRank,c),this.minActive=lr(this.active,this.activeTo)}addActive(c){let u=0,{value:v,to:w,rank:E}=this.cursor;for(;u<this.activeRank.length&&this.activeRank[u]<=E;)u++;fn(this.active,u,v),fn(this.activeTo,u,w),fn(this.activeRank,u,E),c&&fn(c,u,this.cursor.from),this.minActive=lr(this.active,this.activeTo)}next(){let c=this.to,u=this.point;this.point=null;let v=this.openStart<0?[]:null;for(;;){let w=this.minActive;if(w>-1&&(this.activeTo[w]-this.cursor.from||this.active[w].endSide-this.cursor.startSide)<0){if(this.activeTo[w]>c){this.to=this.activeTo[w],this.endSide=this.active[w].endSide;break}this.removeActive(w),v&&fi(v,w)}else if(this.cursor.value)if(this.cursor.from>c){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let E=this.cursor.value;if(!E.point)this.addActive(v),this.cursor.next();else if(u&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=E,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=E.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(v){this.openStart=0;for(let w=v.length-1;w>=0&&v[w]<c;w--)this.openStart++}}activeForPoint(c){if(!this.active.length)return this.active;let u=[];for(let v=this.active.length-1;v>=0&&!(this.activeRank[v]<this.pointRank);v--)(this.activeTo[v]>c||this.activeTo[v]==c&&this.active[v].endSide>=this.point.endSide)&&u.push(this.active[v]);return u.reverse()}openEnd(c){let u=0;for(let v=this.activeTo.length-1;v>=0&&this.activeTo[v]>c;v--)u++;return u}}function Li(R,c,u,v,w,E){R.goto(c),u.goto(v);let M=v+w,z=v,j=v-c;for(;;){let ie=R.to+j-u.to||R.endSide-u.endSide,fe=ie<0?R.to+j:u.to,be=Math.min(fe,M);if(R.point||u.point?R.point&&u.point&&(R.point==u.point||R.point.eq(u.point))&&qi(R.activeForPoint(R.to),u.activeForPoint(u.to))||E.comparePoint(z,be,R.point,u.point):be>z&&!qi(R.active,u.active)&&E.compareRange(z,be,R.active,u.active),fe>M)break;z=fe,ie<=0&&R.next(),ie>=0&&u.next()}}function qi(R,c){if(R.length!=c.length)return!1;for(let u=0;u<R.length;u++)if(R[u]!=c[u]&&!R[u].eq(c[u]))return!1;return!0}function fi(R,c){for(let u=c,v=R.length-1;u<v;u++)R[u]=R[u+1];R.pop()}function fn(R,c,u){for(let v=R.length-1;v>=c;v--)R[v+1]=R[v];R[c]=u}function lr(R,c){let u=-1,v=1e9;for(let w=0;w<c.length;w++)(c[w]-v||R[w].endSide-R[u].endSide)<0&&(u=w,v=c[w]);return u}function Kn(R,c,u=R.length){let v=0;for(let w=0;w<u;)R.charCodeAt(w)==9?(v+=c-v%c,w++):(v++,w=hi(R,w));return v}function bn(R,c,u,v){for(let w=0,E=0;;){if(E>=c)return w;if(w==R.length)break;E+=R.charCodeAt(w)==9?u-E%u:1,w=hi(R,w)}return v===!0?-1:R.length}},65329:(yn,Wt,Q)=>{Q.d(Wt,{p:()=>Ge,Nm:()=>j,tk:()=>ze,SJ:()=>Dn,lg:()=>fi,l9:()=>Ft,S2:()=>To,Uw:()=>It,qr:()=>Xo,Sd:()=>jr,gB:()=>wl,v5:()=>Cl,ZO:()=>bo,HQ:()=>Ks,AE:()=>Qo,bF:()=>al,$f:()=>zn,Eu:()=>ul,OO:()=>Fi,W$:()=>So,Zs:()=>nl,$1:()=>io,mH:()=>Ro,hJ:()=>ao});for(var p=Q(1727),Se=Q(37207),ue={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},L={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},G=typeof navigator!="undefined"&&/Mac/.test(navigator.platform),ke=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Ie=0;Ie<10;Ie++)ue[48+Ie]=ue[96+Ie]=String(Ie);for(var Ie=1;Ie<=24;Ie++)ue[Ie+111]="F"+Ie;for(var Ie=65;Ie<=90;Ie++)ue[Ie]=String.fromCharCode(Ie+32),L[Ie]=String.fromCharCode(Ie);for(var xt in ue)L.hasOwnProperty(xt)||(L[xt]=ue[xt]);function ht(s){var e=G&&s.metaKey&&s.shiftKey&&!s.ctrlKey&&!s.altKey||ke&&s.shiftKey&&s.key&&s.key.length==1||s.key=="Unidentified",t=!e&&s.key||(s.shiftKey?L:ue)[s.keyCode]||s.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function wt(s){let e;return s.nodeType==11?e=s.getSelection?s:s.ownerDocument:e=s,e.getSelection()}function Je(s,e){return e?s==e||s.contains(e.nodeType!=1?e.parentNode:e):!1}function vt(s){let e=s.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function et(s,e){if(!e.anchorNode)return!1;try{return Je(s,e.anchorNode)}catch{return!1}}function gt(s){return s.nodeType==3?St(s,0,s.nodeValue.length).getClientRects():s.nodeType==1?s.getClientRects():[]}function hi(s,e,t,n){return t?ge(s,e,t,n,-1)||ge(s,e,t,n,1):!1}function li(s){for(var e=0;;e++)if(s=s.previousSibling,!s)return e}function ge(s,e,t,n,r){for(;;){if(s==t&&e==n)return!0;if(e==(r<0?0:ot(s))){if(s.nodeName=="DIV")return!1;let h=s.parentNode;if(!h||h.nodeType!=1)return!1;e=li(s)+(r<0?0:1),s=h}else if(s.nodeType==1){if(s=s.childNodes[e+(r<0?-1:0)],s.nodeType==1&&s.contentEditable=="false")return!1;e=r<0?ot(s):0}else return!1}}function ot(s){return s.nodeType==3?s.nodeValue.length:s.childNodes.length}function Jt(s,e){let t=e?s.left:s.right;return{left:t,right:t,top:s.top,bottom:s.bottom}}function pi(s){return{left:0,right:s.innerWidth,top:0,bottom:s.innerHeight}}function Oi(s,e,t,n,r,h,d,y){let x=s.ownerDocument,C=x.defaultView||window;for(let A=s,W=!1;A&&!W;)if(A.nodeType==1){let $,X=A==x.body,ee=1,le=1;if(X)$=pi(C);else{if(/^(fixed|sticky)$/.test(getComputedStyle(A).position)&&(W=!0),A.scrollHeight<=A.clientHeight&&A.scrollWidth<=A.clientWidth){A=A.assignedSlot||A.parentNode;continue}let Ke=A.getBoundingClientRect();ee=Ke.width/A.offsetWidth,le=Ke.height/A.offsetHeight,$={left:Ke.left,right:Ke.left+A.clientWidth*ee,top:Ke.top,bottom:Ke.top+A.clientHeight*le}}let ne=0,de=0;if(r=="nearest")e.top<$.top?(de=-($.top-e.top+d),t>0&&e.bottom>$.bottom+de&&(de=e.bottom-$.bottom+de+d)):e.bottom>$.bottom&&(de=e.bottom-$.bottom+d,t<0&&e.top-de<$.top&&(de=-($.top+de-e.top+d)));else{let Ke=e.bottom-e.top,mt=$.bottom-$.top;de=(r=="center"&&Ke<=mt?e.top+Ke/2-mt/2:r=="start"||r=="center"&&t<0?e.top-d:e.bottom-mt+d)-$.top}if(n=="nearest"?e.left<$.left?(ne=-($.left-e.left+h),t>0&&e.right>$.right+ne&&(ne=e.right-$.right+ne+h)):e.right>$.right&&(ne=e.right-$.right+h,t<0&&e.left<$.left+ne&&(ne=-($.left+ne-e.left+h))):ne=(n=="center"?e.left+(e.right-e.left)/2-($.right-$.left)/2:n=="start"==y?e.left-h:e.right-($.right-$.left)+h)-$.left,ne||de)if(X)C.scrollBy(ne,de);else{let Ke=0,mt=0;if(de){let $e=A.scrollTop;A.scrollTop+=de/le,mt=(A.scrollTop-$e)*le}if(ne){let $e=A.scrollLeft;A.scrollLeft+=ne/ee,Ke=(A.scrollLeft-$e)*ee}e={left:e.left-Ke,top:e.top-mt,right:e.right-Ke,bottom:e.bottom-mt},Ke&&Math.abs(Ke-ne)<1&&(n="nearest"),mt&&Math.abs(mt-de)<1&&(r="nearest")}if(X)break;A=A.assignedSlot||A.parentNode}else if(A.nodeType==11)A=A.host;else break}function At(s){let e=s.ownerDocument;for(let t=s.parentNode;t&&t!=e.body;)if(t.nodeType==1){if(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)return t;t=t.assignedSlot||t.parentNode}else if(t.nodeType==11)t=t.host;else break;return null}class si{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?ot(t):0),n,Math.min(e.focusOffset,n?ot(n):0))}set(e,t,n,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=r}}let Ut=null;function ii(s){if(s.setActive)return s.setActive();if(Ut)return s.focus(Ut);let e=[];for(let t=s;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(s.focus(Ut==null?{get preventScroll(){return Ut={preventScroll:!0},!0}}:void 0),!Ut){Ut=!1;for(let t=0;t<e.length;){let n=e[t++],r=e[t++],h=e[t++];n.scrollTop!=r&&(n.scrollTop=r),n.scrollLeft!=h&&(n.scrollLeft=h)}}}let ct;function St(s,e,t=e){let n=ct||(ct=document.createRange());return n.setEnd(s,t),n.setStart(s,e),n}function Dt(s,e,t){let n={key:e,code:e,keyCode:t,which:t,cancelable:!0},r=new KeyboardEvent("keydown",n);r.synthetic=!0,s.dispatchEvent(r);let h=new KeyboardEvent("keyup",n);return h.synthetic=!0,s.dispatchEvent(h),r.defaultPrevented||h.defaultPrevented}function Mi(s){for(;s;){if(s&&(s.nodeType==9||s.nodeType==11&&s.host))return s;s=s.assignedSlot||s.parentNode}return null}function mi(s){for(;s.attributes.length;)s.removeAttributeNode(s.attributes[0])}function wi(s,e){let t=e.focusNode,n=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=n)return!1;for(n=Math.min(n,ot(t));;)if(n){if(t.nodeType!=1)return!1;let r=t.childNodes[n-1];r.contentEditable=="false"?n--:(t=r,n=ot(t))}else{if(t==s)return!0;n=li(t),t=t.parentNode}}function Ue(s){return s.scrollTop>Math.max(1,s.scrollHeight-s.clientHeight-4)}class Tt{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new Tt(e.parentNode,li(e),t)}static after(e,t){return new Tt(e.parentNode,li(e)+1,t)}}const Ve=[];class oe{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let n=this.dom,r=null,h;for(let d of this.children){if(d.flags&7){if(!d.dom&&(h=r?r.nextSibling:n.firstChild)){let y=oe.get(h);(!y||!y.parent&&y.canReuseDOM(d))&&d.reuseDOM(h)}d.sync(e,t),d.flags&=-8}if(h=r?r.nextSibling:n.firstChild,t&&!t.written&&t.node==n&&h!=d.dom&&(t.written=!0),d.dom.parentNode==n)for(;h&&h!=d.dom;)h=Te(h);else n.insertBefore(d.dom,h);r=d.dom}for(h=r?r.nextSibling:n.firstChild,h&&t&&t.node==n&&(t.written=!0);h;)h=Te(h)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,t),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let r=ot(e)==0?0:t==0?-1:1;for(;;){let h=e.parentNode;if(h==this.dom)break;r==0&&h.firstChild!=h.lastChild&&(e==h.firstChild?r=-1:r=1),e=h}r<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!oe.get(n);)n=n.nextSibling;if(!n)return this.length;for(let r=0,h=0;;r++){let d=this.children[r];if(d.dom==n)return h;h+=d.length+d.breakAfter}}domBoundsAround(e,t,n=0){let r=-1,h=-1,d=-1,y=-1;for(let x=0,C=n,A=n;x<this.children.length;x++){let W=this.children[x],$=C+W.length;if(C<e&&$>t)return W.domBoundsAround(e,t,C);if($>=e&&r==-1&&(r=x,h=C),C>t&&W.dom.parentNode==this.dom){d=x,y=A;break}A=$,C=$+W.breakAfter}return{from:h,to:y<0?n+this.length:y,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:d<this.children.length&&d>=0?this.children[d].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=Ve){this.markDirty();for(let r=e;r<t;r++){let h=this.children[r];h.parent==this&&h.destroy()}this.children.splice(e,t-e,...n);for(let r=0;r<n.length;r++)n[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new ve(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,r,h,d){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){this.parent=null}}oe.prototype.breakAfter=0;function Te(s){let e=s.nextSibling;return s.parentNode.removeChild(s),e}class ve{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function tt(s,e,t,n,r,h,d,y,x){let{children:C}=s,A=C.length?C[e]:null,W=h.length?h[h.length-1]:null,$=W?W.breakAfter:d;if(!(e==n&&A&&!d&&!$&&h.length<2&&A.merge(t,r,h.length?W:null,t==0,y,x))){if(n<C.length){let X=C[n];X&&(r<X.length||X.breakAfter&&(W!=null&&W.breakAfter))?(e==n&&(X=X.split(r),r=0),!$&&W&&X.merge(0,r,W,!0,0,x)?h[h.length-1]=X:((r||X.children.length&&!X.children[0].length)&&X.merge(0,r,null,!1,0,x),h.push(X))):X!=null&&X.breakAfter&&(W?W.breakAfter=1:d=1),n++}for(A&&(A.breakAfter=d,t>0&&(!d&&h.length&&A.merge(t,A.length,h[0],!1,y,0)?A.breakAfter=h.shift().breakAfter:(t<A.length||A.children.length&&A.children[A.children.length-1].length==0)&&A.merge(t,A.length,null,!1,y,0),e++));e<n&&h.length;)if(C[n-1].become(h[h.length-1]))n--,h.pop(),x=h.length?0:y;else if(C[e].become(h[0]))e++,h.shift(),y=h.length?0:x;else break;!h.length&&e&&n<C.length&&!C[e-1].breakAfter&&C[n].merge(0,0,C[e-1],!1,y,x)&&e--,(e<n||h.length)&&s.replaceChildren(e,n,h)}}function Me(s,e,t,n,r,h){let d=s.childCursor(),{i:y,off:x}=d.findPos(t,1),{i:C,off:A}=d.findPos(e,-1),W=e-t;for(let $ of n)W+=$.length;s.length+=W,tt(s,C,A,y,x,n,0,r,h)}let it=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""},Ot=typeof document!="undefined"?document:{documentElement:{style:{}}};const ci=/Edge\/(\d+)/.exec(it.userAgent),Et=/MSIE \d/.test(it.userAgent),Lt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(it.userAgent),Nt=!!(Et||Lt||ci),Pt=!Nt&&/gecko\/(\d+)/i.test(it.userAgent),gi=!Nt&&/Chrome\/(\d+)/.exec(it.userAgent),Vi="webkitFontSmoothing"in Ot.documentElement.style,Xi=!Nt&&/Apple Computer/.test(it.vendor),re=Xi&&(/Mobile\/\w+/.test(it.userAgent)||it.maxTouchPoints>2);var b={mac:re||/Mac/.test(it.platform),windows:/Win/.test(it.platform),linux:/Linux|X11/.test(it.platform),ie:Nt,ie_version:Et?Ot.documentMode||6:Lt?+Lt[1]:ci?+ci[1]:0,gecko:Pt,gecko_version:Pt?+(/Firefox\/(\d+)/.exec(it.userAgent)||[0,0])[1]:0,chrome:!!gi,chrome_version:gi?+gi[1]:0,ios:re,android:/Android\b/.test(it.userAgent),webkit:Vi,safari:Xi,webkit_version:Vi?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:Ot.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const D=256;class I extends oe{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,n){return this.flags&8||n&&(!(n instanceof I)||this.length-(t-e)+n.length>D||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new I(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new Tt(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return Z(this.dom,e,t)}}class N extends oe{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let r of t)r.setParent(this)}setAttrs(e){if(mi(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,r,h,d){return n&&(!(n instanceof N&&n.mark.eq(this.mark))||e&&h<=0||t<this.length&&d<=0)?!1:(Me(this,e,t,n?n.children:[],h-1,d-1),this.markDirty(),!0)}split(e){let t=[],n=0,r=-1,h=0;for(let y of this.children){let x=n+y.length;x>e&&t.push(n<e?y.split(e-n):y),r<0&&n>=e&&(r=h),n=x,h++}let d=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new N(this.mark,t,d)}domAtPos(e){return ye(this,e)}coordsAt(e,t){return Ee(this,e,t)}}function Z(s,e,t){let n=s.nodeValue.length;e>n&&(e=n);let r=e,h=e,d=0;e==0&&t<0||e==n&&t>=0?b.chrome||b.gecko||(e?(r--,d=1):h<n&&(h++,d=-1)):t<0?r--:h<n&&h++;let y=St(s,r,h).getClientRects();if(!y.length)return null;let x=y[(d?d<0:t>=0)?0:y.length-1];return b.safari&&!d&&x.width==0&&(x=Array.prototype.find.call(y,C=>C.width)||x),d?Jt(x,d<0):x||null}class _ extends oe{static create(e,t,n){return new _(e,t,n)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(e){let t=_.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,n,r,h,d){return n&&(!(n instanceof _)||!this.widget.compare(n.widget)||e>0&&h<=0||t<this.length&&d<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e instanceof _&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return p.xv.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,r=this.posAtStart;return n?n.slice(r,r+this.length):p.xv.empty}domAtPos(e){return(this.length?e==0:this.side>0)?Tt.before(this.dom):Tt.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let r=this.dom.getClientRects(),h=null;if(!r.length)return null;let d=this.side?this.side<0:e>0;for(let y=d?r.length-1:0;h=r[y],!(e>0?y==0:y==r.length-1||h.top<h.bottom);y+=d?-1:1);return Jt(h,!d)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class ce extends oe{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof ce&&e.side==this.side}split(){return new ce(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Tt.before(this.dom):Tt.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return p.xv.empty}get isHidden(){return!0}}I.prototype.children=_.prototype.children=ce.prototype.children=Ve;function ye(s,e){let t=s.dom,{children:n}=s,r=0;for(let h=0;r<n.length;r++){let d=n[r],y=h+d.length;if(!(y==h&&d.getSide()<=0)){if(e>h&&e<y&&d.dom.parentNode==t)return d.domAtPos(e-h);if(e<=h)break;h=y}}for(let h=r;h>0;h--){let d=n[h-1];if(d.dom.parentNode==t)return d.domAtPos(d.length)}for(let h=r;h<n.length;h++){let d=n[h];if(d.dom.parentNode==t)return d.domAtPos(0)}return new Tt(t,0)}function We(s,e,t){let n,{children:r}=s;t>0&&e instanceof N&&r.length&&(n=r[r.length-1])instanceof N&&n.mark.eq(e.mark)?We(n,e.children[0],t-1):(r.push(e),e.setParent(s)),s.length+=e.length}function Ee(s,e,t){let n=null,r=-1,h=null,d=-1;function y(C,A){for(let W=0,$=0;W<C.children.length&&$<=A;W++){let X=C.children[W],ee=$+X.length;ee>=A&&(X.children.length?y(X,A-$):(!h||h.isHidden&&t>0)&&(ee>A||$==ee&&X.getSide()>0)?(h=X,d=A-$):($<A||$==ee&&X.getSide()<0&&!X.isHidden)&&(n=X,r=A-$)),$=ee}}y(s,e);let x=(t<0?n:h)||n||h;return x?x.coordsAt(Math.max(0,x==n?r:d),t):Xe(s)}function Xe(s){let e=s.dom.lastChild;if(!e)return s.dom.getBoundingClientRect();let t=gt(e);return t[t.length-1]||null}function qe(s,e){for(let t in s)t=="class"&&e.class?e.class+=" "+s.class:t=="style"&&e.style?e.style+=";"+s.style:e[t]=s[t];return e}const ft=Object.create(null);function Qt(s,e,t){if(s==e)return!0;s||(s=ft),e||(e=ft);let n=Object.keys(s),r=Object.keys(e);if(n.length-(t&&n.indexOf(t)>-1?1:0)!=r.length-(t&&r.indexOf(t)>-1?1:0))return!1;for(let h of n)if(h!=t&&(r.indexOf(h)==-1||s[h]!==e[h]))return!1;return!0}function kt(s,e,t){let n=!1;if(e)for(let r in e)t&&r in t||(n=!0,r=="style"?s.style.cssText="":s.removeAttribute(r));if(t)for(let r in t)e&&e[r]==t[r]||(n=!0,r=="style"?s.style.cssText=t[r]:s.setAttribute(r,t[r]));return n}function Gt(s){let e=Object.create(null);for(let t=0;t<s.attributes.length;t++){let n=s.attributes[t];e[n.name]=n.value}return e}class Ht extends oe{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,r,h,d){if(n){if(!(n instanceof Ht))return!1;this.dom||n.transferDOM(this)}return r&&this.setDeco(n?n.attrs:null),Me(this,e,t,n?n.children:[],h,d),!0}split(e){let t=new Ht;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:n,off:r}=this.childPos(e);r&&(t.append(this.children[n].split(r),0),this.children[n].merge(r,this.children[n].length,null,!1,0,0),n++);for(let h=n;h<this.children.length;h++)t.append(this.children[h],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Qt(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){We(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=qe(t,this.attrs||{})),n&&(this.attrs=qe({class:n},this.attrs||{}))}domAtPos(e){return ye(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var n;this.dom?this.flags&4&&(mi(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(kt(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let r=this.dom.lastChild;for(;r&&oe.get(r)instanceof N;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((n=oe.get(r))===null||n===void 0?void 0:n.isEditable)==!1&&(!b.ios||!this.children.some(h=>h instanceof I))){let h=document.createElement("BR");h.cmIgnore=!0,this.dom.appendChild(h)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let n of this.children){if(!(n instanceof I)||/[^ -~]/.test(n.text))return null;let r=gt(n.dom);if(r.length!=1)return null;e+=r[0].width,t=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let n=Ee(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:r}=this.parent.view.viewState,h=n.bottom-n.top;if(Math.abs(h-r.lineHeight)<2&&r.textHeight<h){let d=(h-r.textHeight)/2;return{top:n.top+d,bottom:n.bottom-d,left:n.left,right:n.left}}}return n}become(e){return!1}covers(){return!0}static find(e,t){for(let n=0,r=0;n<e.children.length;n++){let h=e.children[n],d=r+h.length;if(d>=t){if(h instanceof Ht)return h;if(d>t)break}r=d+h.breakAfter}return null}}class _t extends oe{constructor(e,t,n){super(),this.widget=e,this.length=t,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,r,h,d){return n&&(!(n instanceof _t)||!this.widget.compare(n.widget)||e>0&&h<=0||t<this.length&&d<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?Tt.before(this.dom):Tt.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new _t(this.widget,t,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return Ve}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):p.xv.empty}domBoundsAround(){return null}become(e){return e instanceof _t&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:n}=this.deco;return t==n?!1:e<0?t<0:n>0}}class Ft{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}destroy(e){}}var Xt=function(s){return s[s.Text=0]="Text",s[s.WidgetBefore=1]="WidgetBefore",s[s.WidgetAfter=2]="WidgetAfter",s[s.WidgetRange=3]="WidgetRange",s}(Xt||(Xt={}));class Ge extends p.uU{constructor(e,t,n,r){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=r}get heightRelevant(){return!1}static mark(e){return new jt(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new yt(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,r;if(e.isBlockGap)n=-5e8,r=4e8;else{let{start:h,end:d}=ut(e,t);n=(h?t?-3e8:-1:5e8)-1,r=(d?t?2e8:1:-6e8)+1}return new yt(e,n,r,t,e.widget||null,!0)}static line(e){return new je(e)}static set(e,t=!1){return p.Xs.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Ge.none=p.Xs.empty;class jt extends Ge{constructor(e){let{start:t,end:n}=ut(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,n;return this==e||e instanceof jt&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&Qt(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}jt.prototype.point=!1;class je extends Ge{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof je&&this.spec.class==e.spec.class&&Qt(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}je.prototype.mapMode=p.gc.TrackBefore,je.prototype.point=!0;class yt extends Ge{constructor(e,t,n,r,h,d){super(t,n,h,e),this.block=r,this.isReplace=d,this.mapMode=r?t<=0?p.gc.TrackBefore:p.gc.TrackAfter:p.gc.TrackDel}get type(){return this.startSide!=this.endSide?Xt.WidgetRange:this.startSide<=0?Xt.WidgetBefore:Xt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof yt&&Rt(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}yt.prototype.point=!0;function ut(s,e=!1){let{inclusiveStart:t,inclusiveEnd:n}=s;return t==null&&(t=s.inclusive),n==null&&(n=s.inclusive),{start:t!=null?t:e,end:n!=null?n:e}}function Rt(s,e){return s==e||!!(s&&e&&s.compare(e))}function rt(s,e,t,n=0){let r=t.length-1;r>=0&&t[r]+n>=s?t[r]=Math.max(t[r],e):t.push(s,e)}class st{constructor(e,t,n,r){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof _t&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Ht),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Vt(new ce(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof _t)&&this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:h,lineBreak:d,done:y}=this.cursor.next(this.skip);if(this.skip=0,y)throw new Error("Ran out of text content when drawing inline views");if(d){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=h,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(Vt(new I(this.text.slice(this.textOff,this.textOff+r)),t),n),this.atCursorPos=!0,this.textOff+=r,e-=r,n=0}}span(e,t,n,r){this.buildText(t-e,n,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,n,r,h,d){if(this.disallowBlockEffectsFor[d]&&n instanceof yt){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let y=t-e;if(n instanceof yt)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new _t(n.widget||new Qe("div"),y,n));else{let x=_.create(n.widget||new Qe("span"),y,y?0:n.startSide),C=this.atCursorPos&&!x.isEditable&&h<=r.length&&(e<t||n.startSide>0),A=!x.isEditable&&(e<t||h>r.length||n.startSide<=0),W=this.getLine();this.pendingBuffer==2&&!C&&!x.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),C&&(W.append(Vt(new ce(1),r),h),h=r.length+Math.max(0,h-r.length)),W.append(Vt(x,r),h),this.atCursorPos=A,this.pendingBuffer=A?e<t||h>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);y&&(this.textOff+y<=this.text.length?this.textOff+=y:(this.skip+=y-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=h)}static build(e,t,n,r,h){let d=new st(e,t,n,h);return d.openEnd=p.Xs.spans(r,t,n,d),d.openStart<0&&(d.openStart=d.openEnd),d.finish(d.openEnd),d}}function Vt(s,e){for(let t of e)s=new N(t,[s],s.length);return s}class Qe extends Ft{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const Yt=p.r$.define(),Pi=p.r$.define(),Ri=p.r$.define(),oi=p.r$.define(),Yi=p.r$.define(),ei=p.r$.define(),Si=p.r$.define(),ki=p.r$.define({combine:s=>s.some(e=>e)}),nn=p.r$.define({combine:s=>s.some(e=>e)});class Ni{constructor(e,t="nearest",n="nearest",r=5,h=5,d=!1){this.range=e,this.y=t,this.x=n,this.yMargin=r,this.xMargin=h,this.isSnapshot=d}map(e){return e.empty?this:new Ni(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Ni(p.jT.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Bi=p.Py.define({map:(s,e)=>s.map(e)});function Fi(s,e,t){let n=s.facet(oi);n.length?n[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const vn=p.r$.define({combine:s=>s.length?s[0]:!0});let Li=0;const qi=p.r$.define();class fi{constructor(e,t,n,r,h){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=r,this.extension=h(this)}static define(e,t){const{eventHandlers:n,eventObservers:r,provide:h,decorations:d}=t||{};return new fi(Li++,e,n,r,y=>{let x=[qi.of(y)];return d&&x.push(bn.of(C=>{let A=C.plugin(y);return A?d(A):Ge.none})),h&&x.push(h(y)),x})}static fromClass(e,t){return fi.define(n=>new e(n),t)}}class fn{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(Fi(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){Fi(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(n){Fi(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const lr=p.r$.define(),Kn=p.r$.define(),bn=p.r$.define(),R=p.r$.define(),c=p.r$.define();function u(s,e,t){let n=s.state.facet(c);if(!n.length)return n;let r=n.map(d=>d instanceof Function?d(s):d),h=[];return p.Xs.spans(r,e,t,{point(){},span(d,y,x,C){let A=h;for(let W=x.length-1;W>=0;W--,C--){let $=x[W].spec.bidiIsolate,X;if($!=null)if(C>0&&A.length&&(X=A[A.length-1]).to==d&&X.direction==$)X.to=y,A=X.inner;else{let ee={from:d,to:y,direction:$,inner:[]};A.push(ee),A=ee.inner}}}}),h}const v=p.r$.define();function w(s){let e=0,t=0,n=0,r=0;for(let h of s.state.facet(v)){let d=h(s);d&&(d.left!=null&&(e=Math.max(e,d.left)),d.right!=null&&(t=Math.max(t,d.right)),d.top!=null&&(n=Math.max(n,d.top)),d.bottom!=null&&(r=Math.max(r,d.bottom)))}return{left:e,right:t,top:n,bottom:r}}const E=p.r$.define();class M{constructor(e,t,n,r){this.fromA=e,this.toA=t,this.fromB=n,this.toB=r}join(e){return new M(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>n.toA)){if(r.toA<n.fromA)break;n=n.join(r),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(t.length==0)return e;let n=[];for(let r=0,h=0,d=0,y=0;;r++){let x=r==e.length?null:e[r],C=d-y,A=x?x.fromB:1e9;for(;h<t.length&&t[h]<A;){let W=t[h],$=t[h+1],X=Math.max(y,W),ee=Math.min(A,$);if(X<=ee&&new M(X+C,ee+C,X,ee).addToSet(n),$>A)break;h+=2}if(!x)return n;new M(x.fromA,x.toA,x.fromB,x.toB).addToSet(n),d=x.toA,y=x.toB}}}class z{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=p.as.empty(this.startState.doc.length);for(let h of n)this.changes=this.changes.compose(h.changes);let r=[];this.changes.iterChangedRanges((h,d,y,x)=>r.push(new M(h,d,y,x))),this.changedRanges=r}static create(e,t,n){return new z(e,t,n)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var j=function(s){return s[s.LTR=0]="LTR",s[s.RTL=1]="RTL",s}(j||(j={}));const ie=j.LTR,fe=j.RTL;function be(s){let e=[];for(let t=0;t<s.length;t++)e.push(1<<+s[t]);return e}const Be=be("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),De=be("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Zt=Object.create(null),ui=[];for(let s of["()","[]","{}"]){let e=s.charCodeAt(0),t=s.charCodeAt(1);Zt[e]=t,Zt[t]=-e}function yi(s){return s<=247?Be[s]:1424<=s&&s<=1524?2:1536<=s&&s<=1785?De[s-1536]:1774<=s&&s<=2220?4:8192<=s&&s<=8203?256:64336<=s&&s<=65023?4:s==8204?256:1}const Jn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class xn{get dir(){return this.level%2?fe:ie}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,n,r){let h=-1;for(let d=0;d<e.length;d++){let y=e[d];if(y.from<=t&&y.to>=t){if(y.level==n)return d;(h<0||(r!=0?r<0?y.from<t:y.to>t:e[h].level>y.level))&&(h=d)}}if(h<0)throw new RangeError("Index out of range");return h}}function ar(s,e){if(s.length!=e.length)return!1;for(let t=0;t<s.length;t++){let n=s[t],r=e[t];if(n.from!=r.from||n.to!=r.to||n.direction!=r.direction||!ar(n.inner,r.inner))return!1}return!0}const zt=[];function Ur(s,e,t,n,r){for(let h=0;h<=n.length;h++){let d=h?n[h-1].to:e,y=h<n.length?n[h].from:t,x=h?256:r;for(let C=d,A=x,W=x;C<y;C++){let $=yi(s.charCodeAt(C));$==512?$=A:$==8&&W==4&&($=16),zt[C]=$==4?2:$,$&7&&(W=$),A=$}for(let C=d,A=x,W=x;C<y;C++){let $=zt[C];if($==128)C<y-1&&A==zt[C+1]&&A&24?$=zt[C]=A:zt[C]=256;else if($==64){let X=C+1;for(;X<y&&zt[X]==64;)X++;let ee=C&&A==8||X<t&&zt[X]==8?W==1?1:8:256;for(let le=C;le<X;le++)zt[le]=ee;C=X-1}else $==8&&W==1&&(zt[C]=1);A=$,$&7&&(W=$)}}}function Er(s,e,t,n,r){let h=r==1?2:1;for(let d=0,y=0,x=0;d<=n.length;d++){let C=d?n[d-1].to:e,A=d<n.length?n[d].from:t;for(let W=C,$,X,ee;W<A;W++)if(X=Zt[$=s.charCodeAt(W)])if(X<0){for(let le=y-3;le>=0;le-=3)if(ui[le+1]==-X){let ne=ui[le+2],de=ne&2?r:ne&4?ne&1?h:r:0;de&&(zt[W]=zt[ui[le]]=de),y=le;break}}else{if(ui.length==189)break;ui[y++]=W,ui[y++]=$,ui[y++]=x}else if((ee=zt[W])==2||ee==1){let le=ee==r;x=le?0:1;for(let ne=y-3;ne>=0;ne-=3){let de=ui[ne+2];if(de&2)break;if(le)ui[ne+2]|=2;else{if(de&4)break;ui[ne+2]|=4}}}}}function Dr(s,e,t,n){for(let r=0,h=n;r<=t.length;r++){let d=r?t[r-1].to:s,y=r<t.length?t[r].from:e;for(let x=d;x<y;){let C=zt[x];if(C==256){let A=x+1;for(;;)if(A==y){if(r==t.length)break;A=t[r++].to,y=r<t.length?t[r].from:e}else if(zt[A]==256)A++;else break;let W=h==1,$=(A<e?zt[A]:n)==1,X=W==$?W?1:2:n;for(let ee=A,le=r,ne=le?t[le-1].to:s;ee>x;)ee==ne&&(ee=t[--le].from,ne=le?t[le-1].to:s),zt[--ee]=X;x=A}else h=C,x++}}}function Un(s,e,t,n,r,h,d){let y=n%2?2:1;if(n%2==r%2)for(let x=e,C=0;x<t;){let A=!0,W=!1;if(C==h.length||x<h[C].from){let le=zt[x];le!=y&&(A=!1,W=le==16)}let $=!A&&y==1?[]:null,X=A?n:n+1,ee=x;e:for(;;)if(C<h.length&&ee==h[C].from){if(W)break e;let le=h[C];if(!A)for(let ne=le.to,de=C+1;;){if(ne==t)break e;if(de<h.length&&h[de].from==ne)ne=h[de++].to;else{if(zt[ne]==y)break e;break}}if(C++,$)$.push(le);else{le.from>x&&d.push(new xn(x,le.from,X));let ne=le.direction==ie!=!(X%2);Or(s,ne?n+1:n,r,le.inner,le.from,le.to,d),x=le.to}ee=le.to}else{if(ee==t||(A?zt[ee]!=y:zt[ee]==y))break;ee++}$?Un(s,x,ee,n+1,r,$,d):x<ee&&d.push(new xn(x,ee,X)),x=ee}else for(let x=t,C=h.length;x>e;){let A=!0,W=!1;if(!C||x>h[C-1].to){let le=zt[x-1];le!=y&&(A=!1,W=le==16)}let $=!A&&y==1?[]:null,X=A?n:n+1,ee=x;e:for(;;)if(C&&ee==h[C-1].to){if(W)break e;let le=h[--C];if(!A)for(let ne=le.from,de=C;;){if(ne==e)break e;if(de&&h[de-1].to==ne)ne=h[--de].from;else{if(zt[ne-1]==y)break e;break}}if($)$.push(le);else{le.to<x&&d.push(new xn(le.to,x,X));let ne=le.direction==ie!=!(X%2);Or(s,ne?n+1:n,r,le.inner,le.from,le.to,d),x=le.from}ee=le.from}else{if(ee==e||(A?zt[ee-1]!=y:zt[ee-1]==y))break;ee--}$?Un(s,ee,x,n+1,r,$,d):ee<x&&d.push(new xn(ee,x,X)),x=ee}}function Or(s,e,t,n,r,h,d){let y=e%2?2:1;Ur(s,r,h,n,y),Er(s,r,h,n,y),Dr(r,h,n,y),Un(s,r,h,e,t,n,d)}function hr(s,e,t){if(!s)return[new xn(0,0,e==fe?1:0)];if(e==ie&&!t.length&&!Jn.test(s))return Pr(s.length);if(t.length)for(;s.length>zt.length;)zt[zt.length]=256;let n=[],r=e==ie?0:1;return Or(s,r,r,t,0,s.length,n),n}function Pr(s){return[new xn(0,s,0)]}let Gr="";function O(s,e,t,n,r){var h;let d=n.head-s.from,y=-1;if(d==0){if(!r||!s.length)return null;e[0].level!=t&&(d=e[0].side(!1,t),y=0)}else if(d==s.length){if(r)return null;let $=e[e.length-1];$.level!=t&&(d=$.side(!0,t),y=e.length-1)}y<0&&(y=xn.find(e,d,(h=n.bidiLevel)!==null&&h!==void 0?h:-1,n.assoc));let x=e[y];d==x.side(r,t)&&(x=e[y+=r?1:-1],d=x.side(!r,t));let C=r==(x.dir==t),A=(0,p.cp)(s.text,d,C);if(Gr=s.text.slice(Math.min(d,A),Math.max(d,A)),A!=x.side(r,t))return p.jT.cursor(A+s.from,C?-1:1,x.level);let W=y==(r?e.length-1:0)?null:e[y+(r?1:-1)];return!W&&x.level!=t?p.jT.cursor(r?s.to:s.from,r?-1:1,t):W&&W.level<x.level?p.jT.cursor(W.side(!r,t)+s.from,r?1:-1,W.level):p.jT.cursor(A+s.from,r?-1:1,x.level)}class g extends oe{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Ht],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new M(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:C,toA:A})=>A<this.minWidthFrom||C>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let r=-1;this.view.inputState.composing>=0&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?r=this.domChanged.newSel.head:!Kt(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let h=r>-1?K(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:C,to:A}=this.hasComposition;n=new M(C,A,e.changes.mapPos(C,-1),e.changes.mapPos(A,1)).addToSet(n.slice())}this.hasComposition=h?{from:h.range.fromB,to:h.range.toB}:null,(b.ie||b.chrome)&&!h&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let d=this.decorations,y=this.updateDeco(),x=Ze(d,y,e.changes);return n=M.extendWithRanges(n,x),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,h),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,n);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let d=b.chrome||b.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,d),this.flags&=-8,d&&(d.written||r.selectionRange.focusNode!=d.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(d=>d.flags&=-9);let h=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let d of this.children)d instanceof _t&&d.widget instanceof P&&h.push(d.dom);r.updateGaps(h)}updateChildren(e,t,n){let r=n?n.range.addToSet(e.slice()):e,h=this.childCursor(t);for(let d=r.length-1;;d--){let y=d>=0?r[d]:null;if(!y)break;let{fromA:x,toA:C,fromB:A,toB:W}=y,$,X,ee,le;if(n&&n.range.fromB<W&&n.range.toB>A){let $e=st.build(this.view.state.doc,A,n.range.fromB,this.decorations,this.dynamicDecorationMap),_e=st.build(this.view.state.doc,n.range.toB,W,this.decorations,this.dynamicDecorationMap);X=$e.breakAtStart,ee=$e.openStart,le=_e.openEnd;let Ct=this.compositionView(n);_e.breakAtStart?Ct.breakAfter=1:_e.content.length&&Ct.merge(Ct.length,Ct.length,_e.content[0],!1,_e.openStart,0)&&(Ct.breakAfter=_e.content[0].breakAfter,_e.content.shift()),$e.content.length&&Ct.merge(0,0,$e.content[$e.content.length-1],!0,0,$e.openEnd)&&$e.content.pop(),$=$e.content.concat(Ct).concat(_e.content)}else({content:$,breakAtStart:X,openStart:ee,openEnd:le}=st.build(this.view.state.doc,A,W,this.decorations,this.dynamicDecorationMap));let{i:ne,off:de}=h.findPos(C,1),{i:Ke,off:mt}=h.findPos(x,-1);tt(this,Ke,mt,ne,de,$,X,ee,le)}n&&this.fixCompositionDOM(n)}compositionView(e){let t=new I(e.text.nodeValue);t.flags|=8;for(let{deco:r}of e.marks)t=new N(r,[t],t.length);let n=new Ht;return n.append(t,0),n}fixCompositionDOM(e){let t=(h,d)=>{d.flags|=8|(d.children.some(x=>x.flags&7)?1:0),this.markedForComposition.add(d);let y=oe.get(h);y&&y!=d&&(y.dom=null),d.setDOM(h)},n=this.childPos(e.range.fromB,1),r=this.children[n.i];t(e.line,r);for(let h=e.marks.length-1;h>=-1;h--)n=r.childPos(n.off,1),r=r.children[n.i],t(h>=0?e.marks[h].node:e.text,r)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,r=n==this.dom,h=!r&&et(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(r||t||h))return;let d=this.forceSelection;this.forceSelection=!1;let y=this.view.state.selection.main,x=this.moveToLine(this.domAtPos(y.anchor)),C=y.empty?x:this.moveToLine(this.domAtPos(y.head));if(b.gecko&&y.empty&&!this.hasComposition&&S(x)){let W=document.createTextNode("");this.view.observer.ignore(()=>x.node.insertBefore(W,x.node.childNodes[x.offset]||null)),x=C=new Tt(W,0),d=!0}let A=this.view.observer.selectionRange;(d||!A.focusNode||!hi(x.node,x.offset,A.anchorNode,A.anchorOffset)||!hi(C.node,C.offset,A.focusNode,A.focusOffset))&&(this.view.observer.ignore(()=>{b.android&&b.chrome&&this.dom.contains(A.focusNode)&&Ye(A.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let W=wt(this.view.root);if(W)if(y.empty){if(b.gecko){let $=se(x.node,x.offset);if($&&$!=3){let X=U(x.node,x.offset,$==1?1:-1);X&&(x=new Tt(X.node,X.offset))}}W.collapse(x.node,x.offset),y.bidiLevel!=null&&W.caretBidiLevel!==void 0&&(W.caretBidiLevel=y.bidiLevel)}else if(W.extend){W.collapse(x.node,x.offset);try{W.extend(C.node,C.offset)}catch{}}else{let $=document.createRange();y.anchor>y.head&&([x,C]=[C,x]),$.setEnd(C.node,C.offset),$.setStart(x.node,x.offset),W.removeAllRanges(),W.addRange($)}h&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(x,C)),this.impreciseAnchor=x.precise?null:new Tt(A.anchorNode,A.anchorOffset),this.impreciseHead=C.precise?null:new Tt(A.focusNode,A.focusOffset)}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=wt(e.root),{anchorNode:r,anchorOffset:h}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let d=Ht.find(this,t.head);if(!d)return;let y=d.posAtStart;if(t.head==y||t.head==y+d.length)return;let x=this.coordsAt(t.head,-1),C=this.coordsAt(t.head,1);if(!x||!C||x.bottom>C.top)return;let A=this.domAtPos(t.head+t.assoc);n.collapse(A.node,A.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let W=e.observer.selectionRange;e.docView.posFromDOM(W.anchorNode,W.anchorOffset)!=t.from&&n.collapse(r,h)}moveToLine(e){let t=this.dom,n;if(e.node!=t)return e;for(let r=e.offset;!n&&r<t.childNodes.length;r++){let h=oe.get(t.childNodes[r]);h instanceof Ht&&(n=h.domAtPos(0))}for(let r=e.offset-1;!n&&r>=0;r--){let h=oe.get(t.childNodes[r]);h instanceof Ht&&(n=h.domAtPos(h.length))}return n?new Tt(n.node,n.offset,!0):e}nearest(e){for(let t=e;t;){let n=oe.get(t);if(n&&n.rootView==this)return n;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let r=this.children[t];if(n<r.length||r instanceof Ht)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){let n=null,r=0;for(let h=this.length,d=this.children.length-1;d>=0;d--){let y=this.children[d],x=h-y.breakAfter,C=x-y.length;if(x<e)break;C<=e&&(C<e||y.covers(-1))&&(x>e||y.covers(1))&&(!n||y instanceof Ht&&!(n instanceof Ht&&t>=0))&&(n=y,r=C),h=C}return n?n.coordsAt(e-r,t):null}coordsForChar(e){let{i:t,off:n}=this.childPos(e,1),r=this.children[t];if(!(r instanceof Ht))return null;for(;r.children.length;){let{i:y,off:x}=r.childPos(n,1);for(;;y++){if(y==r.children.length)return null;if((r=r.children[y]).length)break}n=x}if(!(r instanceof I))return null;let h=(0,p.cp)(r.text,n);if(h==n)return null;let d=St(r.dom,n,h).getClientRects();for(let y=0;y<d.length;y++){let x=d[y];if(y==d.length-1||x.top<x.bottom&&x.left<x.right)return x}return null}measureVisibleLineHeights(e){let t=[],{from:n,to:r}=e,h=this.view.contentDOM.clientWidth,d=h>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,y=-1,x=this.view.textDirection==j.LTR;for(let C=0,A=0;A<this.children.length;A++){let W=this.children[A],$=C+W.length;if($>r)break;if(C>=n){let X=W.dom.getBoundingClientRect();if(t.push(X.height),d){let ee=W.dom.lastChild,le=ee?gt(ee):[];if(le.length){let ne=le[le.length-1],de=x?ne.right-X.left:X.right-ne.left;de>y&&(y=de,this.minWidth=h,this.minWidthFrom=C,this.minWidthTo=$)}}}C=$+W.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?j.RTL:j.LTR}measureTextSize(){for(let h of this.children)if(h instanceof Ht){let d=h.measureTextSize();if(d)return d}let e=document.createElement("div"),t,n,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let h=gt(e.firstChild)[0];t=e.getBoundingClientRect().height,n=h?h.width/27:7,r=h?h.height:t,e.remove()}),{lineHeight:t,charWidth:n,textHeight:r}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new ve(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,r=0;;r++){let h=r==t.viewports.length?null:t.viewports[r],d=h?h.from-1:this.length;if(d>n){let y=(t.lineBlockAt(d).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(Ge.replace({widget:new P(y),block:!0,inclusive:!0,isBlockGap:!0}).range(n,d))}if(!h)break;n=h.to+1}return Ge.set(e)}updateDeco(){let e=this.view.state.facet(bn).map((t,n)=>(this.dynamicDecorationMap[n]=typeof t=="function")?t(this.view):t);for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){if(e.isSnapshot){let C=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=C.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!n)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,r.left),top:Math.min(n.top,r.top),right:Math.max(n.right,r.right),bottom:Math.max(n.bottom,r.bottom)});let h=w(this.view),d={left:n.left-h.left,top:n.top-h.top,right:n.right+h.right,bottom:n.bottom+h.bottom},{offsetWidth:y,offsetHeight:x}=this.view.scrollDOM;Oi(this.view.scrollDOM,d,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,y),-y),Math.max(Math.min(e.yMargin,x),-x),this.view.textDirection==j.LTR)}}function S(s){return s.node.nodeType==1&&s.node.firstChild&&(s.offset==0||s.node.childNodes[s.offset-1].contentEditable=="false")&&(s.offset==s.node.childNodes.length||s.node.childNodes[s.offset].contentEditable=="false")}class P extends Ft{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function F(s,e){let t=s.observer.selectionRange,n=t.focusNode&&U(t.focusNode,t.focusOffset,0);if(!n)return null;let r=e-n.offset;return{from:r,to:r+n.node.nodeValue.length,node:n.node}}function K(s,e,t){let n=F(s,t);if(!n)return null;let{node:r,from:h,to:d}=n,y=r.nodeValue;if(/[\n\r]/.test(y)||s.state.doc.sliceString(n.from,n.to)!=y)return null;let x=e.invertedDesc,C=new M(x.mapPos(h),x.mapPos(d),h,d),A=[];for(let W=r.parentNode;;W=W.parentNode){let $=oe.get(W);if($ instanceof N)A.push({node:W,deco:$.mark});else{if($ instanceof Ht||W.nodeName=="DIV"&&W.parentNode==s.contentDOM)return{range:C,text:r,marks:A,line:W};if(W!=s.contentDOM)A.push({node:W,deco:new jt({inclusive:!0,attributes:Gt(W),tagName:W.tagName.toLowerCase()})});else return null}}}function U(s,e,t){if(t<=0)for(let n=s,r=e;;){if(n.nodeType==3)return{node:n,offset:r};if(n.nodeType==1&&r>0)n=n.childNodes[r-1],r=ot(n);else break}if(t>=0)for(let n=s,r=e;;){if(n.nodeType==3)return{node:n,offset:r};if(n.nodeType==1&&r<n.childNodes.length&&t>=0)n=n.childNodes[r],r=0;else break}return null}function se(s,e){return s.nodeType!=1?0:(e&&s.childNodes[e-1].contentEditable=="false"?1:0)|(e<s.childNodes.length&&s.childNodes[e].contentEditable=="false"?2:0)}let ae=class{constructor(){this.changes=[]}compareRange(e,t){rt(e,t,this.changes)}comparePoint(e,t){rt(e,t,this.changes)}};function Ze(s,e,t){let n=new ae;return p.Xs.compare(s,e,t,n),n.changes}function Ye(s,e){for(let t=s;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function Kt(s,e){let t=!1;return e&&s.iterChangedRanges((n,r)=>{n<e.to&&r>e.from&&(t=!0)}),t}function Qi(s,e,t=1){let n=s.charCategorizer(e),r=s.doc.lineAt(e),h=e-r.from;if(r.length==0)return p.jT.cursor(e);h==0?t=1:h==r.length&&(t=-1);let d=h,y=h;t<0?d=(0,p.cp)(r.text,h,!1):y=(0,p.cp)(r.text,h);let x=n(r.text.slice(d,y));for(;d>0;){let C=(0,p.cp)(r.text,d,!1);if(n(r.text.slice(C,d))!=x)break;d=C}for(;y<r.length;){let C=(0,p.cp)(r.text,y);if(n(r.text.slice(y,C))!=x)break;y=C}return p.jT.range(d+r.from,y+r.from)}function zi(s,e){return e.left>s?e.left-s:Math.max(0,s-e.right)}function wn(s,e){return e.top>s?e.top-s:Math.max(0,s-e.bottom)}function ln(s,e){return s.top<e.bottom-1&&s.bottom>e.top+1}function cr(s,e){return e<s.top?{top:e,left:s.left,right:s.right,bottom:s.bottom}:s}function Bt(s,e){return e>s.bottom?{top:s.top,left:s.left,right:s.right,bottom:e}:s}function Sn(s,e,t){let n,r,h,d,y=!1,x,C,A,W;for(let ee=s.firstChild;ee;ee=ee.nextSibling){let le=gt(ee);for(let ne=0;ne<le.length;ne++){let de=le[ne];r&&ln(r,de)&&(de=cr(Bt(de,r.bottom),r.top));let Ke=zi(e,de),mt=wn(t,de);if(Ke==0&&mt==0)return ee.nodeType==3?un(ee,e,t):Sn(ee,e,t);if(!n||d>mt||d==mt&&h>Ke){n=ee,r=de,h=Ke,d=mt;let $e=mt?t<de.top?-1:1:Ke?e<de.left?-1:1:0;y=!$e||($e>0?ne<le.length-1:ne>0)}Ke==0?t>de.bottom&&(!A||A.bottom<de.bottom)?(x=ee,A=de):t<de.top&&(!W||W.top>de.top)&&(C=ee,W=de):A&&ln(A,de)?A=Bt(A,de.bottom):W&&ln(W,de)&&(W=cr(W,de.top))}}if(A&&A.bottom>=t?(n=x,r=A):W&&W.top<=t&&(n=C,r=W),!n)return{node:s,offset:0};let $=Math.max(r.left,Math.min(r.right,e));if(n.nodeType==3)return un(n,$,t);if(y&&n.contentEditable!="false")return Sn(n,$,t);let X=Array.prototype.indexOf.call(s.childNodes,n)+(e>=(r.left+r.right)/2?1:0);return{node:s,offset:X}}function un(s,e,t){let n=s.nodeValue.length,r=-1,h=1e9,d=0;for(let y=0;y<n;y++){let x=St(s,y,y+1).getClientRects();for(let C=0;C<x.length;C++){let A=x[C];if(A.top==A.bottom)continue;d||(d=e-A.left);let W=(A.top>t?A.top-t:t-A.bottom)-1;if(A.left-1<=e&&A.right+1>=e&&W<h){let $=e>=(A.left+A.right)/2,X=$;if((b.chrome||b.gecko)&&St(s,y).getBoundingClientRect().left==A.right&&(X=!$),W<=0)return{node:s,offset:y+(X?1:0)};r=y+(X?1:0),h=W}}}return{node:s,offset:r>-1?r:d>0?s.nodeValue.length:0}}function Gn(s,e,t,n=-1){var r,h;let d=s.contentDOM.getBoundingClientRect(),y=d.top+s.viewState.paddingTop,x,{docHeight:C}=s.viewState,{x:A,y:W}=e,$=W-y;if($<0)return 0;if($>C)return s.state.doc.length;for(let $e=s.viewState.heightOracle.textHeight/2,_e=!1;x=s.elementAtHeight($),x.type!=Xt.Text;)for(;$=n>0?x.bottom+$e:x.top-$e,!($>=0&&$<=C);){if(_e)return t?null:0;_e=!0,n=-n}W=y+$;let X=x.from;if(X<s.viewport.from)return s.viewport.from==0?0:t?null:Nn(s,d,x,A,W);if(X>s.viewport.to)return s.viewport.to==s.state.doc.length?s.state.doc.length:t?null:Nn(s,d,x,A,W);let ee=s.dom.ownerDocument,le=s.root.elementFromPoint?s.root:ee,ne=le.elementFromPoint(A,W);ne&&!s.contentDOM.contains(ne)&&(ne=null),ne||(A=Math.max(d.left+1,Math.min(d.right-1,A)),ne=le.elementFromPoint(A,W),ne&&!s.contentDOM.contains(ne)&&(ne=null));let de,Ke=-1;if(ne&&((r=s.docView.nearest(ne))===null||r===void 0?void 0:r.isEditable)!=!1){if(ee.caretPositionFromPoint){let $e=ee.caretPositionFromPoint(A,W);$e&&({offsetNode:de,offset:Ke}=$e)}else if(ee.caretRangeFromPoint){let $e=ee.caretRangeFromPoint(A,W);$e&&({startContainer:de,startOffset:Ke}=$e,(!s.contentDOM.contains(de)||b.safari&&an(de,Ke,A)||b.chrome&&Rr(de,Ke,A))&&(de=void 0))}}if(!de||!s.docView.dom.contains(de)){let $e=Ht.find(s.docView,X);if(!$e)return $>x.top+x.height/2?x.to:x.from;({node:de,offset:Ke}=Sn($e.dom,A,W))}let mt=s.docView.nearest(de);if(!mt)return null;if(mt.isWidget&&((h=mt.dom)===null||h===void 0?void 0:h.nodeType)==1){let $e=mt.dom.getBoundingClientRect();return e.y<$e.top||e.y<=$e.bottom&&e.x<=($e.left+$e.right)/2?mt.posAtStart:mt.posAtEnd}else return mt.localPosFromDOM(de,Ke)+mt.posAtStart}function Nn(s,e,t,n,r){let h=Math.round((n-e.left)*s.defaultCharacterWidth);if(s.lineWrapping&&t.height>s.defaultLineHeight*1.5){let y=s.viewState.heightOracle.textHeight,x=Math.floor((r-t.top-(s.defaultLineHeight-y)*.5)/y);h+=x*s.viewState.heightOracle.lineLength}let d=s.state.sliceDoc(t.from,t.to);return t.from+(0,p.Gz)(d,h,s.state.tabSize)}function an(s,e,t){let n;if(s.nodeType!=3||e!=(n=s.nodeValue.length))return!1;for(let r=s.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return St(s,n-1,n).getBoundingClientRect().left>t}function Rr(s,e,t){if(e!=0)return!1;for(let r=s;;){let h=r.parentNode;if(!h||h.nodeType!=1||h.firstChild!=r)return!1;if(h.classList.contains("cm-line"))break;r=h}let n=s.nodeType==1?s.getBoundingClientRect():St(s,0,Math.max(s.nodeValue.length,1)).getBoundingClientRect();return t-n.left>5}function fr(s,e){let t=s.lineBlockAt(e);if(Array.isArray(t.type)){for(let n of t.type)if(n.to>e||n.to==e&&(n.to==t.to||n.type==Xt.Text))return n}return t}function Br(s,e,t,n){let r=fr(s,e.head),h=!n||r.type!=Xt.Text||!(s.lineWrapping||r.widgetLineBreaks)?null:s.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(h){let d=s.dom.getBoundingClientRect(),y=s.textDirectionAt(r.from),x=s.posAtCoords({x:t==(y==j.LTR)?d.right-1:d.left+1,y:(h.top+h.bottom)/2});if(x!=null)return p.jT.cursor(x,t?-1:1)}return p.jT.cursor(t?r.to:r.from,t?-1:1)}function Pn(s,e,t,n){let r=s.state.doc.lineAt(e.head),h=s.bidiSpans(r),d=s.textDirectionAt(r.from);for(let y=e,x=null;;){let C=O(r,h,d,y,t),A=Gr;if(!C){if(r.number==(t?s.state.doc.lines:1))return y;A=`
`,r=s.state.doc.line(r.number+(t?1:-1)),h=s.bidiSpans(r),C=p.jT.cursor(t?r.from:r.to)}if(x){if(!x(A))return y}else{if(!n)return C;x=n(A)}y=C}}function Xn(s,e,t){let n=s.state.charCategorizer(e),r=n(t);return h=>{let d=n(h);return r==p.D0.Space&&(r=d),r==d}}function Yn(s,e,t,n){let r=e.head,h=t?1:-1;if(r==(t?s.state.doc.length:0))return p.jT.cursor(r,e.assoc);let d=e.goalColumn,y,x=s.contentDOM.getBoundingClientRect(),C=s.coordsAtPos(r,e.assoc||-1),A=s.documentTop;if(C)d==null&&(d=C.left-x.left),y=h<0?C.top:C.bottom;else{let X=s.viewState.lineBlockAt(r);d==null&&(d=Math.min(x.right-x.left,s.defaultCharacterWidth*(r-X.from))),y=(h<0?X.top:X.bottom)+A}let W=x.left+d,$=n!=null?n:s.viewState.heightOracle.textHeight>>1;for(let X=0;;X+=10){let ee=y+($+X)*h,le=Gn(s,{x:W,y:ee},!1,h);if(ee<x.top||ee>x.bottom||(h<0?le<r:le>r)){let ne=s.docView.coordsForChar(le),de=!ne||ee<ne.top?-1:1;return p.jT.cursor(le,de,void 0,d)}}}function Xr(s,e,t){for(;;){let n=0;for(let r of s)r.between(e-1,e+1,(h,d,y)=>{if(e>h&&e<d){let x=n||t||(e-h<d-e?-1:1);e=x<0?h:d,n=x}});if(!n)return e}}function Lr(s,e,t){let n=Xr(s.state.facet(R).map(r=>r(s)),t.from,e.head>t.from?-1:1);return n==t.from?t:p.jT.cursor(n,n<t.from?1:-1)}class Ss{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,b.safari&&e.contentDOM.addEventListener("input",()=>null),b.gecko&&xe(e.contentDOM.ownerDocument)}handleEvent(e){!qr(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let n=this.handlers[e];if(n){for(let r of n.observers)r(this.view,t);for(let r of n.handlers){if(t.defaultPrevented)break;if(r(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=ks(e),n=this.handlers,r=this.view.contentDOM;for(let h in t)if(h!="scroll"){let d=!t[h].handlers.length,y=n[h];y&&d!=!y.handlers.length&&(r.removeEventListener(h,this.handleEvent),y=null),y||r.addEventListener(h,this.handleEvent,{passive:d})}for(let h in n)h!="scroll"&&!t[h]&&r.removeEventListener(h,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(e.keyCode!=27&&Cs.indexOf(e.keyCode)<0&&(this.view.inputState.lastEscPress=0),b.android&&b.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return b.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=Yr.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||qs.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(){let e=this.pendingIOSKey;return e?(this.pendingIOSKey=void 0,Dt(this.view.contentDOM,e.key,e.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:b.safari&&!b.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Ys(s,e){return(t,n)=>{try{return e.call(s,n,t)}catch(r){Fi(t.state,r)}}}function ks(s){let e=Object.create(null);function t(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of s){let r=n.spec;if(r&&r.domEventHandlers)for(let h in r.domEventHandlers){let d=r.domEventHandlers[h];d&&t(h).handlers.push(Ys(n.value,d))}if(r&&r.domEventObservers)for(let h in r.domEventObservers){let d=r.domEventObservers[h];d&&t(h).observers.push(Ys(n.value,d))}}for(let n in $i)t(n).handlers.push($i[n]);for(let n in dn)t(n).observers.push(dn[n]);return e}const Yr=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],qs="dthko",Cs=[16,17,18,20,91,92,224,225],ti=6;function ur(s){return Math.max(0,s)*.7+8}function As(s,e){return Math.max(Math.abs(s.clientX-e.clientX),Math.abs(s.clientY-e.clientY))}class dr{constructor(e,t,n,r){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=At(e.contentDOM),this.atoms=e.state.facet(R).map(d=>d(e));let h=e.contentDOM.ownerDocument;h.addEventListener("mousemove",this.move=this.move.bind(this)),h.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(p.yy.allowMultipleSelections)&&qn(e,t),this.dragging=Ts(e,t)&&cs(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){var t;if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&As(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,r=0,h=((t=this.scrollParent)===null||t===void 0?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},d=w(this.view);e.clientX-d.left<=h.left+ti?n=-ur(h.left-e.clientX):e.clientX+d.right>=h.right-ti&&(n=ur(e.clientX-h.right)),e.clientY-d.top<=h.top+ti?r=-ur(h.top-e.clientY):e.clientY+d.bottom>=h.bottom-ti&&(r=ur(e.clientY-h.bottom)),this.setScrollSpeed(n,r)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let r=e.ranges[n],h=null;if(r.empty){let d=Xr(this.atoms,r.from,0);d!=r.from&&(h=p.jT.cursor(d,-1))}else{let d=Xr(this.atoms,r.from,-1),y=Xr(this.atoms,r.to,1);(d!=r.from||y!=r.to)&&(h=p.jT.range(r.from==r.anchor?d:y,r.from==r.head?d:y))}h&&(t||(t=e.ranges.slice()),t[n]=h)}return t?p.jT.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection)||n.main.assoc!=t.state.selection.main.assoc&&this.dragging===!1)&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function qn(s,e){let t=s.state.facet(Yt);return t.length?t[0](e):b.mac?e.metaKey:e.ctrlKey}function as(s,e){let t=s.state.facet(Pi);return t.length?t[0](e):b.mac?!e.altKey:!e.ctrlKey}function Ts(s,e){let{main:t}=s.state.selection;if(t.empty)return!1;let n=wt(s.root);if(!n||n.rangeCount==0)return!0;let r=n.getRangeAt(0).getClientRects();for(let h=0;h<r.length;h++){let d=r[h];if(d.left<=e.clientX&&d.right>=e.clientX&&d.top<=e.clientY&&d.bottom>=e.clientY)return!0}return!1}function qr(s,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,n;t!=s.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(n=oe.get(t))&&n.ignoreEvent(e))return!1;return!0}const $i=Object.create(null),dn=Object.create(null),Ms=b.ie&&b.ie_version<15||b.ios&&b.webkit_version<604;function Qr(s){let e=s.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{s.focus(),t.remove(),pr(s,t.value)},50)}function pr(s,e){let{state:t}=s,n,r=1,h=t.toText(e),d=h.lines==t.selection.ranges.length;if(H!=null&&t.selection.ranges.every(x=>x.empty)&&H==h.toString()){let x=-1;n=t.changeByRange(C=>{let A=t.doc.lineAt(C.from);if(A.from==x)return{range:C};x=A.from;let W=t.toText((d?h.line(r++).text:e)+t.lineBreak);return{changes:{from:A.from,insert:W},range:p.jT.cursor(C.from+W.length)}})}else d?n=t.changeByRange(x=>{let C=h.line(r++);return{changes:{from:x.from,to:x.to,insert:C.text},range:p.jT.cursor(x.from+C.length)}}):n=t.replaceSelection(h);s.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}dn.scroll=s=>{s.inputState.lastScrollTop=s.scrollDOM.scrollTop,s.inputState.lastScrollLeft=s.scrollDOM.scrollLeft},$i.keydown=(s,e)=>(s.inputState.setSelectionOrigin("select"),e.keyCode==27&&(s.inputState.lastEscPress=Date.now()),!1),dn.touchstart=(s,e)=>{s.inputState.lastTouchTime=Date.now(),s.inputState.setSelectionOrigin("select.pointer")},dn.touchmove=s=>{s.inputState.setSelectionOrigin("select.pointer")},$i.mousedown=(s,e)=>{if(s.observer.flush(),s.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let n of s.state.facet(Ri))if(t=n(s,e),t)break;if(!t&&e.button==0&&(t=_s(s,e)),t){let n=!s.hasFocus;s.inputState.startMouseSelection(new dr(s,e,t,n)),n&&s.observer.ignore(()=>ii(s.contentDOM));let r=s.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}return!1};function Ir(s,e,t,n){if(n==1)return p.jT.cursor(e,t);if(n==2)return Qi(s.state,e,t);{let r=Ht.find(s.docView,e),h=s.state.doc.lineAt(r?r.posAtEnd:e),d=r?r.posAtStart:h.from,y=r?r.posAtEnd:h.to;return y<s.state.doc.length&&y==h.to&&y++,p.jT.range(d,y)}}let hs=(s,e)=>s>=e.top&&s<=e.bottom,Es=(s,e,t)=>hs(e,t)&&s>=t.left&&s<=t.right;function Qs(s,e,t,n){let r=Ht.find(s.docView,e);if(!r)return 1;let h=e-r.posAtStart;if(h==0)return 1;if(h==r.length)return-1;let d=r.coordsAt(h,-1);if(d&&Es(t,n,d))return-1;let y=r.coordsAt(h,1);return y&&Es(t,n,y)?1:d&&hs(n,d)?-1:1}function Ds(s,e){let t=s.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:Qs(s,t,e.clientX,e.clientY)}}const Os=b.ie&&b.ie_version<=11;let _r=null,es=0,Ps=0;function cs(s){if(!Os)return s.detail;let e=_r,t=Ps;return _r=s,Ps=Date.now(),es=!e||t>Date.now()-400&&Math.abs(e.clientX-s.clientX)<2&&Math.abs(e.clientY-s.clientY)<2?(es+1)%3:1}function _s(s,e){let t=Ds(s,e),n=cs(e),r=s.state.selection;return{update(h){h.docChanged&&(t.pos=h.changes.mapPos(t.pos),r=r.map(h.changes))},get(h,d,y){let x=Ds(s,h),C,A=Ir(s,x.pos,x.bias,n);if(t.pos!=x.pos&&!d){let W=Ir(s,t.pos,t.bias,n),$=Math.min(W.from,A.from),X=Math.max(W.to,A.to);A=$<A.from?p.jT.range($,X):p.jT.range(X,$)}return d?r.replaceRange(r.main.extend(A.from,A.to)):y&&n==1&&r.ranges.length>1&&(C=eo(r,x.pos))?C:y?r.addRange(A):p.jT.create([A])}}}function eo(s,e){for(let t=0;t<s.ranges.length;t++){let{from:n,to:r}=s.ranges[t];if(n<=e&&r>=e)return p.jT.create(s.ranges.slice(0,t).concat(s.ranges.slice(t+1)),s.mainIndex==t?0:s.mainIndex-(s.mainIndex>t?1:0))}return null}$i.dragstart=(s,e)=>{let{selection:{main:t}}=s.state;if(e.target.draggable){let r=s.docView.nearest(e.target);if(r&&r.isWidget){let h=r.posAtStart,d=h+r.length;(h>=t.to||d<=t.from)&&(t=p.jT.range(h,d))}}let{inputState:n}=s;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",s.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove"),!1},$i.dragend=s=>(s.inputState.draggedContent=null,!1);function Rs(s,e,t,n){if(!t)return;let r=s.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:h}=s.inputState,d=n&&h&&as(s,e)?{from:h.from,to:h.to}:null,y={from:r,insert:t},x=s.state.changes(d?[d,y]:y);s.focus(),s.dispatch({changes:x,selection:{anchor:x.mapPos(r,-1),head:x.mapPos(r,1)},userEvent:d?"move.drop":"input.drop"}),s.inputState.draggedContent=null}$i.drop=(s,e)=>{if(!e.dataTransfer)return!1;if(s.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let n=Array(t.length),r=0,h=()=>{++r==t.length&&Rs(s,e,n.filter(d=>d!=null).join(s.state.lineBreak),!1)};for(let d=0;d<t.length;d++){let y=new FileReader;y.onerror=h,y.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(y.result)||(n[d]=y.result),h()},y.readAsText(t[d])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return Rs(s,e,n,!0),!0}return!1},$i.paste=(s,e)=>{if(s.state.readOnly)return!0;s.observer.flush();let t=Ms?null:e.clipboardData;return t?(pr(s,t.getData("text/plain")||t.getData("text/uri-text")),!0):(Qr(s),!1)};function to(s,e){let t=s.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),s.focus()},50)}function V(s){let e=[],t=[],n=!1;for(let r of s.selection.ranges)r.empty||(e.push(s.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:h}of s.selection.ranges){let d=s.doc.lineAt(h);d.number>r&&(e.push(d.text),t.push({from:d.from,to:Math.min(s.doc.length,d.to+1)})),r=d.number}n=!0}return{text:e.join(s.lineBreak),ranges:t,linewise:n}}let H=null;$i.copy=$i.cut=(s,e)=>{let{text:t,ranges:n,linewise:r}=V(s.state);if(!t&&!r)return!1;H=r?t:null,e.type=="cut"&&!s.state.readOnly&&s.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let h=Ms?null:e.clipboardData;return h?(h.clearData(),h.setData("text/plain",t),!0):(to(s,t),!1)};const Y=p.q6.define();function te(s,e){let t=[];for(let n of s.facet(Si)){let r=n(s,e);r&&t.push(r)}return t?s.update({effects:t,annotations:Y.of(!0)}):null}function he(s){setTimeout(()=>{let e=s.hasFocus;if(e!=s.inputState.notifiedFocused){let t=te(s.state,e);t?s.dispatch(t):s.update([])}},10)}dn.focus=s=>{s.inputState.lastFocusTime=Date.now(),!s.scrollDOM.scrollTop&&(s.inputState.lastScrollTop||s.inputState.lastScrollLeft)&&(s.scrollDOM.scrollTop=s.inputState.lastScrollTop,s.scrollDOM.scrollLeft=s.inputState.lastScrollLeft),he(s)},dn.blur=s=>{s.observer.clearSelectionRange(),he(s)},dn.compositionstart=dn.compositionupdate=s=>{s.inputState.compositionFirstChange==null&&(s.inputState.compositionFirstChange=!0),s.inputState.composing<0&&(s.inputState.composing=0)},dn.compositionend=s=>{s.inputState.composing=-1,s.inputState.compositionEndedAt=Date.now(),s.inputState.compositionPendingKey=!0,s.inputState.compositionPendingChange=s.observer.pendingRecords().length>0,s.inputState.compositionFirstChange=null,b.chrome&&b.android?s.observer.flushSoon():s.inputState.compositionPendingChange?Promise.resolve().then(()=>s.observer.flush()):setTimeout(()=>{s.inputState.composing<0&&s.docView.hasComposition&&s.update([])},50)},dn.contextmenu=s=>{s.inputState.lastContextMenu=Date.now()},$i.beforeinput=(s,e)=>{var t;let n;if(b.chrome&&b.android&&(n=Yr.find(r=>r.inputType==e.inputType))&&(s.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let r=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var h;(((h=window.visualViewport)===null||h===void 0?void 0:h.height)||0)>r+10&&s.hasFocus&&(s.contentDOM.blur(),s.focus())},100)}return!1};const me=new Set;function xe(s){me.has(s)||(me.add(s),s.addEventListener("copy",()=>{}),s.addEventListener("cut",()=>{}))}const Le=["pre-wrap","normal","pre-line","break-spaces"];class $t{constructor(e){this.lineWrapping=e,this.doc=p.xv.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Le.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let r=e[n];r<0?n++:this.heightSamples[Math.floor(r*10)]||(t=!0,this.heightSamples[Math.floor(r*10)]=!0)}return t}refresh(e,t,n,r,h,d){let y=Le.indexOf(e)>-1,x=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=y;if(this.lineWrapping=y,this.lineHeight=t,this.charWidth=n,this.textHeight=r,this.lineLength=h,x){this.heightSamples={};for(let C=0;C<d.length;C++){let A=d[C];A<0?C++:this.heightSamples[Math.floor(A*10)]=!0}}return x}}class dt{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Ne{constructor(e,t,n,r,h){this.from=e,this.length=t,this.top=n,this.height=r,this._content=h}get type(){return typeof this._content=="number"?Xt.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof yt?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Ne(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var we=function(s){return s[s.ByPos=0]="ByPos",s[s.ByHeight=1]="ByHeight",s[s.ByPosNoHeight=2]="ByPosNoHeight",s}(we||(we={}));const He=.001;class nt{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>He&&(e.heightChanged=!0),this.height=t)}replace(e,t,n){return nt.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,r){let h=this,d=n.doc;for(let y=r.length-1;y>=0;y--){let{fromA:x,toA:C,fromB:A,toB:W}=r[y],$=h.lineAt(x,we.ByPosNoHeight,n.setDoc(t),0,0),X=$.to>=C?$:h.lineAt(C,we.ByPosNoHeight,n,0,0);for(W+=X.to-C,C=X.to;y>0&&$.from<=r[y-1].toA;)x=r[y-1].fromA,A=r[y-1].fromB,y--,x<$.from&&($=h.lineAt(x,we.ByPosNoHeight,n,0,0));A+=$.from-x,x=$.from;let ee=Wi.build(n.setDoc(d),e,A,W);h=h.replace(x,C,ee)}return h.updateHeight(n,0)}static empty(){return new Mt(0,0)}static of(e){if(e.length==1)return e[0];let t=0,n=e.length,r=0,h=0;for(;;)if(t==n)if(r>h*2){let y=e[t-1];y.break?e.splice(--t,1,y.left,null,y.right):e.splice(--t,1,y.left,y.right),n+=1+y.break,r-=y.size}else if(h>r*2){let y=e[n];y.break?e.splice(n,1,y.left,null,y.right):e.splice(n,1,y.left,y.right),n+=2+y.break,h-=y.size}else break;else if(r<h){let y=e[t++];y&&(r+=y.size)}else{let y=e[--n];y&&(h+=y.size)}let d=0;return e[t-1]==null?(d=1,t--):e[t]==null&&(d=1,n++),new ji(nt.of(e.slice(0,t)),d,nt.of(e.slice(n)))}}nt.prototype.size=1;class pt extends nt{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,r){return new Ne(r,this.length,n,this.height,this.deco||0)}lineAt(e,t,n,r,h){return this.blockAt(0,n,r,h)}forEachLine(e,t,n,r,h,d){e<=h+this.length&&t>=h&&d(this.blockAt(0,n,r,h))}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(e,r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Mt extends pt{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,n,r){return new Ne(r,this.length,n,this.height,this.breaks)}replace(e,t,n){let r=n[0];return n.length==1&&(r instanceof Mt||r instanceof bt&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof bt?r=new Mt(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):nt.of(n)}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more?this.setHeight(e,r.heights[r.index++]):(n||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class bt extends nt{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,h=r-n+1,d,y=0;if(e.lineWrapping){let x=Math.min(this.height,e.lineHeight*h);d=x/h,this.length>h+1&&(y=(this.height-x)/(this.length-h-1))}else d=this.height/h;return{firstLine:n,lastLine:r,perLine:d,perChar:y}}blockAt(e,t,n,r){let{firstLine:h,lastLine:d,perLine:y,perChar:x}=this.heightMetrics(t,r);if(t.lineWrapping){let C=r+Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length),A=t.doc.lineAt(C),W=y+A.length*x,$=Math.max(n,e-W/2);return new Ne(A.from,A.length,$,W,0)}else{let C=Math.max(0,Math.min(d-h,Math.floor((e-n)/y))),{from:A,length:W}=t.doc.line(h+C);return new Ne(A,W,n+y*C,y,0)}}lineAt(e,t,n,r,h){if(t==we.ByHeight)return this.blockAt(e,n,r,h);if(t==we.ByPosNoHeight){let{from:X,to:ee}=n.doc.lineAt(e);return new Ne(X,ee-X,0,0,0)}let{firstLine:d,perLine:y,perChar:x}=this.heightMetrics(n,h),C=n.doc.lineAt(e),A=y+C.length*x,W=C.number-d,$=r+y*W+x*(C.from-h-W);return new Ne(C.from,C.length,Math.max(r,Math.min($,r+this.height-A)),A,0)}forEachLine(e,t,n,r,h,d){e=Math.max(e,h),t=Math.min(t,h+this.length);let{firstLine:y,perLine:x,perChar:C}=this.heightMetrics(n,h);for(let A=e,W=r;A<=t;){let $=n.doc.lineAt(A);if(A==e){let ee=$.number-y;W+=x*ee+C*(e-h-ee)}let X=x+C*$.length;d(new Ne($.from,$.length,W,X,0)),W+=X,A=$.to+1}}replace(e,t,n){let r=this.length-t;if(r>0){let h=n[n.length-1];h instanceof bt?n[n.length-1]=new bt(h.length+r):n.push(null,new bt(r-1))}if(e>0){let h=n[0];h instanceof bt?n[0]=new bt(e+h.length):n.unshift(new bt(e-1),null)}return nt.of(n)}decomposeLeft(e,t){t.push(new bt(e-1),null)}decomposeRight(e,t){t.push(null,new bt(this.length-e-1))}updateHeight(e,t=0,n=!1,r){let h=t+this.length;if(r&&r.from<=t+this.length&&r.more){let d=[],y=Math.max(t,r.from),x=-1;for(r.from>t&&d.push(new bt(r.from-t-1).updateHeight(e,t));y<=h&&r.more;){let A=e.doc.lineAt(y).length;d.length&&d.push(null);let W=r.heights[r.index++];x==-1?x=W:Math.abs(W-x)>=He&&(x=-2);let $=new Mt(A,W);$.outdated=!1,d.push($),y+=A+1}y<=h&&d.push(null,new bt(h-y).updateHeight(e,y));let C=nt.of(d);return(x<0||Math.abs(C.height-this.height)>=He||Math.abs(x-this.heightMetrics(e,t).perLine)>=He)&&(e.heightChanged=!0),C}else(n||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class ji extends nt{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,t,n,r){let h=n+this.left.height;return e<h?this.left.blockAt(e,t,n,r):this.right.blockAt(e,t,h,r+this.left.length+this.break)}lineAt(e,t,n,r,h){let d=r+this.left.height,y=h+this.left.length+this.break,x=t==we.ByHeight?e<d:e<y,C=x?this.left.lineAt(e,t,n,r,h):this.right.lineAt(e,t,n,d,y);if(this.break||(x?C.to<y:C.from>y))return C;let A=t==we.ByPosNoHeight?we.ByPosNoHeight:we.ByPos;return x?C.join(this.right.lineAt(y,A,n,d,y)):this.left.lineAt(y,A,n,r,h).join(C)}forEachLine(e,t,n,r,h,d){let y=r+this.left.height,x=h+this.left.length+this.break;if(this.break)e<x&&this.left.forEachLine(e,t,n,r,h,d),t>=x&&this.right.forEachLine(e,t,n,y,x,d);else{let C=this.lineAt(x,we.ByPos,n,r,h);e<C.from&&this.left.forEachLine(e,C.from-1,n,r,h,d),C.to>=e&&C.from<=t&&d(C),t>C.to&&this.right.forEachLine(C.to+1,t,n,y,x,d)}}replace(e,t,n){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,n));let h=[];e>0&&this.decomposeLeft(e,h);let d=h.length;for(let y of n)h.push(y);if(e>0&&Zi(h,d-1),t<this.length){let y=h.length;this.decomposeRight(t,h),Zi(h,y)}return nt.of(h)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,r=n+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?nt.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,r){let{left:h,right:d}=this,y=t+h.length+this.break,x=null;return r&&r.from<=t+h.length&&r.more?x=h=h.updateHeight(e,t,n,r):h.updateHeight(e,t,n),r&&r.from<=y+d.length&&r.more?x=d=d.updateHeight(e,y,n,r):d.updateHeight(e,y,n),x?this.balanced(h,d):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Zi(s,e){let t,n;s[e]==null&&(t=s[e-1])instanceof bt&&(n=s[e+1])instanceof bt&&s.splice(e-1,3,new bt(t.length+1+n.length))}const Ei=5;class Wi{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let n=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof Mt?r.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Mt(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let r=n.widget?n.widget.estimatedHeight:0,h=n.widget?n.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let d=t-e;n.block?this.addBlock(new pt(d,r,n)):(d||h||r>=Ei)&&this.addLineDeco(r,h,d)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Mt(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new bt(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Mt)return e;let t=new Mt(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let r=this.ensureLine();r.length+=n,r.collapsed+=n,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Mt)&&!this.isCovered?this.nodes.push(new Mt(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let r of this.nodes)r instanceof Mt&&r.updateHeight(this.oracle,n),n+=r?r.length:1;return this.nodes}static build(e,t,n,r){let h=new Wi(n,e);return p.Xs.spans(t,n,r,h,0),h.finish(n)}}function rn(s,e,t){let n=new qt;return p.Xs.compare(s,e,t,n,0),n.changes}class qt{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,r){(e<t||n&&n.heightRelevant||r&&r.heightRelevant)&&rt(e,t,this.changes,5)}}function pn(s,e){let t=s.getBoundingClientRect(),n=s.ownerDocument,r=n.defaultView||window,h=Math.max(0,t.left),d=Math.min(r.innerWidth,t.right),y=Math.max(0,t.top),x=Math.min(r.innerHeight,t.bottom);for(let C=s.parentNode;C&&C!=n.body;)if(C.nodeType==1){let A=C,W=window.getComputedStyle(A);if((A.scrollHeight>A.clientHeight||A.scrollWidth>A.clientWidth)&&W.overflow!="visible"){let $=A.getBoundingClientRect();h=Math.max(h,$.left),d=Math.min(d,$.right),y=Math.max(y,$.top),x=C==s.parentNode?$.bottom:Math.min(x,$.bottom)}C=W.position=="absolute"||W.position=="fixed"?A.offsetParent:A.parentNode}else if(C.nodeType==11)C=C.host;else break;return{left:h-t.left,right:Math.max(h,d)-t.left,top:y-(t.top+e),bottom:Math.max(y,x)-(t.top+e)}}function ai(s,e){let t=s.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class vi{constructor(e,t,n){this.from=e,this.to=t,this.size=n}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let r=e[n],h=t[n];if(r.from!=h.from||r.to!=h.to||r.size!=h.size)return!1}return!0}draw(e,t){return Ge.replace({widget:new _i(this.size*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class _i extends Ft{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class kn{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=mr,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=j.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(Kn).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new $t(t),this.stateDeco=e.facet(bn).filter(n=>typeof n!="function"),this.heightMap=nt.empty().applyChanges(this.stateDeco,p.xv.empty,this.heightOracle.setDoc(e.doc),[new M(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ge.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let r=n?t.head:t.anchor;if(!e.some(({from:h,to:d})=>r>=h&&r<=d)){let{from:h,to:d}=this.lineBlockAt(r);e.push(new Tn(h,d))}}this.viewports=e.sort((n,r)=>n.from-r.from),this.scaler=this.heightMap.height<=7e6?mr:new Cn(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:Rn(e,this.scaler))})}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(bn).filter(A=>typeof A!="function");let r=e.changedRanges,h=M.extendWithRanges(r,rn(n,this.stateDeco,e?e.changes:p.as.empty(this.state.doc.length))),d=this.heightMap.height,y=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),h),this.heightMap.height!=d&&(e.flags|=2),y?(this.scrollAnchorPos=e.changes.mapPos(y.from,-1),this.scrollAnchorHeight=y.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let x=h.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<x.from||t.range.head>x.to)||!this.viewportIsAppropriate(x))&&(x=this.getViewport(0,t));let C=!e.changes.empty||e.flags&2||x.from!=this.viewport.from||x.to!=this.viewport.to;this.viewport=x,this.updateForViewport(),C&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(nn)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),r=this.heightOracle,h=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?j.RTL:j.LTR;let d=this.heightOracle.mustRefreshForWrapping(h),y=t.getBoundingClientRect(),x=d||this.mustMeasureContent||this.contentDOMHeight!=y.height;this.contentDOMHeight=y.height,this.mustMeasureContent=!1;let C=0,A=0;if(y.width&&y.height){let $e=y.width/t.offsetWidth,_e=y.height/t.offsetHeight;($e>.995&&$e<1.005||!isFinite($e)||Math.abs(y.width-t.offsetWidth)<1)&&($e=1),(_e>.995&&_e<1.005||!isFinite(_e)||Math.abs(y.height-t.offsetHeight)<1)&&(_e=1),(this.scaleX!=$e||this.scaleY!=_e)&&(this.scaleX=$e,this.scaleY=_e,C|=8,d=x=!0)}let W=(parseInt(n.paddingTop)||0)*this.scaleY,$=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=W||this.paddingBottom!=$)&&(this.paddingTop=W,this.paddingBottom=$,C|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(x=!0),this.editorWidth=e.scrollDOM.clientWidth,C|=8);let X=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=X&&(this.scrollAnchorHeight=-1,this.scrollTop=X),this.scrolledToBottom=Ue(e.scrollDOM);let ee=(this.printing?ai:pn)(t,this.paddingTop),le=ee.top-this.pixelViewport.top,ne=ee.bottom-this.pixelViewport.bottom;this.pixelViewport=ee;let de=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(de!=this.inView&&(this.inView=de,de&&(x=!0)),!this.inView&&!this.scrollTarget)return 0;let Ke=y.width;if((this.contentDOMWidth!=Ke||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=y.width,this.editorHeight=e.scrollDOM.clientHeight,C|=8),x){let $e=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights($e)&&(d=!0),d||r.lineWrapping&&Math.abs(Ke-this.contentDOMWidth)>r.charWidth){let{lineHeight:_e,charWidth:Ct,textHeight:Ti}=e.docView.measureTextSize();d=_e>0&&r.refresh(h,_e,Ct,Ti,Ke/Ct,$e),d&&(e.docView.minWidth=0,C|=8)}le>0&&ne>0?A=Math.max(le,ne):le<0&&ne<0&&(A=Math.min(le,ne)),r.heightChanged=!1;for(let _e of this.viewports){let Ct=_e.from==this.viewport.from?$e:e.docView.measureVisibleLineHeights(_e);this.heightMap=(d?nt.empty().applyChanges(this.stateDeco,p.xv.empty,this.heightOracle,[new M(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,d,new dt(_e.from,Ct))}r.heightChanged&&(C|=2)}let mt=!this.viewportIsAppropriate(this.viewport,A)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return mt&&(this.viewport=this.getViewport(A,this.scrollTarget)),this.updateForViewport(),(C&2||mt)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(d?[]:this.lineGaps,e)),C|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),C}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,h=this.heightOracle,{visibleTop:d,visibleBottom:y}=this,x=new Tn(r.lineAt(d-n*1e3,we.ByHeight,h,0,0).from,r.lineAt(y+(1-n)*1e3,we.ByHeight,h,0,0).to);if(t){let{head:C}=t.range;if(C<x.from||C>x.to){let A=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),W=r.lineAt(C,we.ByPos,h,0,0),$;t.y=="center"?$=(W.top+W.bottom)/2-A/2:t.y=="start"||t.y=="nearest"&&C<x.from?$=W.top:$=W.bottom-A,x=new Tn(r.lineAt($-1e3/2,we.ByHeight,h,0,0).from,r.lineAt($+A+1e3/2,we.ByHeight,h,0,0).to)}}return x}mapViewport(e,t){let n=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new Tn(this.heightMap.lineAt(n,we.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,we.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,we.ByPos,this.heightOracle,0,0),{bottom:h}=this.heightMap.lineAt(t,we.ByPos,this.heightOracle,0,0),{visibleTop:d,visibleBottom:y}=this;return(e==0||r<=d-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||h>=y+Math.max(10,Math.min(n,250)))&&r>d-2*1e3&&h<y+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let r of e)t.touchesRange(r.from,r.to)||n.push(new vi(t.mapPos(r.from),t.mapPos(r.to),r.size));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,r=n?1e4:2e3,h=r>>1,d=r<<1;if(this.defaultTextDirection!=j.LTR&&!n)return[];let y=[],x=(C,A,W,$)=>{if(A-C<h)return;let X=this.state.selection.main,ee=[X.from];X.empty||ee.push(X.to);for(let ne of ee)if(ne>C&&ne<A){x(C,ne-10,W,$),x(ne+10,A,W,$);return}let le=ts(e,ne=>ne.from>=W.from&&ne.to<=W.to&&Math.abs(ne.from-C)<h&&Math.abs(ne.to-A)<h&&!ee.some(de=>ne.from<de&&ne.to>de));if(!le){if(A<W.to&&t&&n&&t.visibleRanges.some(ne=>ne.from<=A&&ne.to>=A)){let ne=t.moveToLineBoundary(p.jT.cursor(A),!1,!0).head;ne>C&&(A=ne)}le=new vi(C,A,this.gapSize(W,C,A,$))}y.push(le)};for(let C of this.viewportLines){if(C.length<d)continue;let A=Ci(C.from,C.to,this.stateDeco);if(A.total<d)continue;let W=this.scrollTarget?this.scrollTarget.range.head:null,$,X;if(n){let ee=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,le,ne;if(W!=null){let de=Ai(A,W),Ke=((this.visibleBottom-this.visibleTop)/2+ee)/C.height;le=de-Ke,ne=de+Ke}else le=(this.visibleTop-C.top-ee)/C.height,ne=(this.visibleBottom-C.top+ee)/C.height;$=en(A,le),X=en(A,ne)}else{let ee=A.total*this.heightOracle.charWidth,le=r*this.heightOracle.charWidth,ne,de;if(W!=null){let Ke=Ai(A,W),mt=((this.pixelViewport.right-this.pixelViewport.left)/2+le)/ee;ne=Ke-mt,de=Ke+mt}else ne=(this.pixelViewport.left-le)/ee,de=(this.pixelViewport.right+le)/ee;$=en(A,ne),X=en(A,de)}$>C.from&&x(C.from,$,C,A),X<C.to&&x(X,C.to,C,A)}return y}gapSize(e,t,n,r){let h=Ai(r,n)-Ai(r,t);return this.heightOracle.lineWrapping?e.height*h:r.total*this.heightOracle.charWidth*h}updateLineGaps(e){vi.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Ge.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];p.Xs.spans(e,this.viewport.from,this.viewport.to,{span(r,h){t.push({from:r,to:h})},point(){}},20);let n=t.length!=this.visibleRanges.length||this.visibleRanges.some((r,h)=>r.from!=t[h].from||r.to!=t[h].to);return this.visibleRanges=t,n?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Rn(this.heightMap.lineAt(e,we.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return Rn(this.heightMap.lineAt(this.scaler.fromDOM(e),we.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Rn(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Tn{constructor(e,t){this.from=e,this.to=t}}function Ci(s,e,t){let n=[],r=s,h=0;return p.Xs.spans(t,s,e,{span(){},point(d,y){d>r&&(n.push({from:r,to:d}),h+=d-r),r=y}},20),r<e&&(n.push({from:r,to:e}),h+=e-r),{total:h,ranges:n}}function en({total:s,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let n=Math.floor(s*t);for(let r=0;;r++){let{from:h,to:d}=e[r],y=d-h;if(n<=y)return h+n;n-=y}}function Ai(s,e){let t=0;for(let{from:n,to:r}of s.ranges){if(e<=r){t+=e-n;break}t+=r-n}return t/s.total}function ts(s,e){for(let t of s)if(e(t))return t}const mr={toDOM(s){return s},fromDOM(s){return s},scale:1};class Cn{constructor(e,t,n){let r=0,h=0,d=0;this.viewports=n.map(({from:y,to:x})=>{let C=t.lineAt(y,we.ByPos,e,0,0).top,A=t.lineAt(x,we.ByPos,e,0,0).bottom;return r+=A-C,{from:y,to:x,top:C,bottom:A,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r);for(let y of this.viewports)y.domTop=d+(y.top-h)*this.scale,d=y.domBottom=y.domTop+(y.bottom-y.top),h=y.bottom}toDOM(e){for(let t=0,n=0,r=0;;t++){let h=t<this.viewports.length?this.viewports[t]:null;if(!h||e<h.top)return r+(e-n)*this.scale;if(e<=h.bottom)return h.domTop+(e-h.top);n=h.bottom,r=h.domBottom}}fromDOM(e){for(let t=0,n=0,r=0;;t++){let h=t<this.viewports.length?this.viewports[t]:null;if(!h||e<h.domTop)return n+(e-r)/this.scale;if(e<=h.domBottom)return h.top+(e-h.domTop);n=h.bottom,r=h.domBottom}}}function Rn(s,e){if(e.scale==1)return s;let t=e.toDOM(s.top),n=e.toDOM(s.bottom);return new Ne(s.from,s.length,t,n-t,Array.isArray(s._content)?s._content.map(r=>Rn(r,e)):s._content)}const gr=p.r$.define({combine:s=>s.join(" ")}),yr=p.r$.define({combine:s=>s.indexOf(!0)>-1}),ni=Se.V.newName(),mn=Se.V.newName(),hn=Se.V.newName(),Qn={"&light":"."+mn,"&dark":"."+hn};function vr(s,e,t){return new Se.V(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,r=>{if(r=="&")return s;if(!t||!t[r])throw new RangeError(`Unsupported selector: ${r}`);return t[r]}):s+" "+n}})}const cn=vr("."+ni,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Qn),Bn="\uFFFF";class _n{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(p.yy.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Bn}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let r=e;;){this.findPointBefore(n,r);let h=this.text.length;this.readNode(r);let d=r.nextSibling;if(d==t)break;let y=oe.get(r),x=oe.get(d);(y&&x?y.breakAfter:(y?y.breakAfter:Fn(r))||Fn(d)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>h)&&this.lineBreak(),r=d}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let h=-1,d=1,y;if(this.lineSeparator?(h=t.indexOf(this.lineSeparator,n),d=this.lineSeparator.length):(y=r.exec(t))&&(h=y.index,d=y[0].length),this.append(t.slice(n,h<0?t.length:h)),h<0)break;if(this.lineBreak(),d>1)for(let x of this.points)x.node==e&&x.pos>this.text.length&&(x.pos-=d-1);n=h+d}}readNode(e){if(e.cmIgnore)return;let t=oe.get(e),n=t&&t.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let r=n.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(er(e,n.node,n.offset)?t:0))}}function er(s,e,t){for(;;){if(!e||t<ot(e))return!1;if(e==s)return!0;t=li(e)+1,e=e.parentNode}}function Fn(s){return s.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(s.nodeName)}class br{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class fs{constructor(e,t,n,r){this.typeOver=r,this.bounds=null,this.text="";let{impreciseHead:h,impreciseAnchor:d}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let y=h||d?[]:Ln(e),x=new _n(y,e.state);x.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=x.text,this.newSel=xr(y,this.bounds.from)}else{let y=e.observer.selectionRange,x=h&&h.node==y.focusNode&&h.offset==y.focusOffset||!Je(e.contentDOM,y.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(y.focusNode,y.focusOffset),C=d&&d.node==y.anchorNode&&d.offset==y.anchorOffset||!Je(e.contentDOM,y.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(y.anchorNode,y.anchorOffset);this.newSel=p.jT.single(C,x)}}}function Mn(s,e){let t,{newSel:n}=e,r=s.state.selection.main,h=s.inputState.lastKeyTime>Date.now()-100?s.inputState.lastKeyCode:-1;if(e.bounds){let{from:d,to:y}=e.bounds,x=r.from,C=null;(h===8||b.android&&e.text.length<y-d)&&(x=r.to,C="end");let A=Wn(s.state.doc.sliceString(d,y,Bn),e.text,x-d,C);A&&(b.chrome&&h==13&&A.toB==A.from+2&&e.text.slice(A.from,A.toB)==Bn+Bn&&A.toB--,t={from:d+A.from,to:d+A.toA,insert:p.xv.of(e.text.slice(A.from,A.toB).split(Bn))})}else n&&(!s.hasFocus&&s.state.facet(vn)||n.main.eq(r))&&(n=null);if(!t&&!n)return!1;if(!t&&e.typeOver&&!r.empty&&n&&n.main.empty?t={from:r.from,to:r.to,insert:s.state.doc.slice(r.from,r.to)}:t&&t.from>=r.from&&t.to<=r.to&&(t.from!=r.from||t.to!=r.to)&&r.to-r.from-(t.to-t.from)<=4?t={from:r.from,to:r.to,insert:s.state.doc.slice(r.from,t.from).append(t.insert).append(s.state.doc.slice(t.to,r.to))}:(b.mac||b.android)&&t&&t.from==t.to&&t.from==r.head-1&&/^\. ?$/.test(t.insert.toString())&&s.contentDOM.getAttribute("autocorrect")=="off"?(n&&t.insert.length==2&&(n=p.jT.single(n.main.anchor-1,n.main.head-1)),t={from:r.from,to:r.to,insert:p.xv.of([" "])}):b.chrome&&t&&t.from==t.to&&t.from==r.head&&t.insert.toString()==`
 `&&s.lineWrapping&&(n&&(n=p.jT.single(n.main.anchor-1,n.main.head-1)),t={from:r.from,to:r.to,insert:p.xv.of([" "])}),t){if(b.ios&&s.inputState.flushIOSKey()||b.android&&(t.from==r.from&&t.to==r.to&&t.insert.length==1&&t.insert.lines==2&&Dt(s.contentDOM,"Enter",13)||(t.from==r.from-1&&t.to==r.to&&t.insert.length==0||h==8&&t.insert.length<t.to-t.from&&t.to>r.head)&&Dt(s.contentDOM,"Backspace",8)||t.from==r.from&&t.to==r.to+1&&t.insert.length==0&&Dt(s.contentDOM,"Delete",46)))return!0;let d=t.insert.toString();s.inputState.composing>=0&&s.inputState.composing++;let y,x=()=>y||(y=Ki(s,t,n));return s.state.facet(ei).some(C=>C(s,t.from,t.to,d,x))||s.dispatch(x()),!0}else if(n&&!n.main.eq(r)){let d=!1,y="select";return s.inputState.lastSelectionTime>Date.now()-50&&(s.inputState.lastSelectionOrigin=="select"&&(d=!0),y=s.inputState.lastSelectionOrigin),s.dispatch({selection:n,scrollIntoView:d,userEvent:y}),!0}else return!1}function Ki(s,e,t){let n,r=s.state,h=r.selection.main;if(e.from>=h.from&&e.to<=h.to&&e.to-e.from>=(h.to-h.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&s.inputState.composing<0){let y=h.from<e.from?r.sliceDoc(h.from,e.from):"",x=h.to>e.to?r.sliceDoc(e.to,h.to):"";n=r.replaceSelection(s.state.toText(y+e.insert.sliceString(0,void 0,s.state.lineBreak)+x))}else{let y=r.changes(e),x=t&&t.main.to<=y.newLength?t.main:void 0;if(r.selection.ranges.length>1&&s.inputState.composing>=0&&e.to<=h.to&&e.to>=h.to-10){let C=s.state.sliceDoc(e.from,e.to),A,W=t&&F(s,t.main.head);if(W){let ee=e.insert.length-(e.to-e.from);A={from:W.from,to:W.to-ee}}else A=s.state.doc.lineAt(h.head);let $=h.to-e.to,X=h.to-h.from;n=r.changeByRange(ee=>{if(ee.from==h.from&&ee.to==h.to)return{changes:y,range:x||ee.map(y)};let le=ee.to-$,ne=le-C.length;if(ee.to-ee.from!=X||s.state.sliceDoc(ne,le)!=C||ee.to>=A.from&&ee.from<=A.to)return{range:ee};let de=r.changes({from:ne,to:le,insert:e.insert}),Ke=ee.to-h.to;return{changes:de,range:x?p.jT.range(Math.max(0,x.anchor+Ke),Math.max(0,x.head+Ke)):ee.map(de)}})}else n={changes:y,selection:x&&r.selection.replaceRange(x)}}let d="input.type";return(s.composing||s.inputState.compositionPendingChange&&s.inputState.compositionEndedAt>Date.now()-50)&&(s.inputState.compositionPendingChange=!1,d+=".compose",s.inputState.compositionFirstChange&&(d+=".start",s.inputState.compositionFirstChange=!1)),r.update(n,{userEvent:d,scrollIntoView:!0})}function Wn(s,e,t,n){let r=Math.min(s.length,e.length),h=0;for(;h<r&&s.charCodeAt(h)==e.charCodeAt(h);)h++;if(h==r&&s.length==e.length)return null;let d=s.length,y=e.length;for(;d>0&&y>0&&s.charCodeAt(d-1)==e.charCodeAt(y-1);)d--,y--;if(n=="end"){let x=Math.max(0,h-Math.min(d,y));t-=d+x-h}if(d<h&&s.length<e.length){let x=t<=h&&t>=d?h-t:0;h-=x,y=h+(y-d),d=h}else if(y<h){let x=t<=h&&t>=y?h-t:0;h-=x,d=h+(d-y),y=h}return{from:h,toA:d,toB:y}}function Ln(s){let e=[];if(s.root.activeElement!=s.contentDOM)return e;let{anchorNode:t,anchorOffset:n,focusNode:r,focusOffset:h}=s.observer.selectionRange;return t&&(e.push(new br(t,n)),(r!=t||h!=n)&&e.push(new br(r,h))),e}function xr(s,e){if(s.length==0)return null;let t=s[0].pos,n=s.length==2?s[1].pos:t;return t>-1&&n>-1?p.jT.single(t+e,n+e):null}const is={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},tr=b.ie&&b.ie_version<=11;class Hn{constructor(e){this.view=e,this.active=!1,this.selectionRange=new si,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let n of t)this.queue.push(n);(b.ie&&b.ie_version<=11||b.ios&&e.composing)&&t.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),tr&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,r=this.selectionRange;if(n.state.facet(vn)?n.root.activeElement!=this.dom:!et(n.dom,r))return;let h=r.anchorNode&&n.docView.nearest(r.anchorNode);if(h&&h.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(b.ie&&b.ie_version<=11||b.android&&b.chrome)&&!n.state.selection.main.empty&&r.focusNode&&hi(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=b.safari&&e.root.nodeType==11&&vt(this.dom.ownerDocument)==this.dom&&Vn(this.view)||wt(e.root);if(!t||this.selectionRange.eq(t))return!1;let n=et(this.dom,t);return n&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&wi(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),n&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(n.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=t)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,is),tr&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),tr&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let r=()=>{let h=this.delayedAndroidKey;h&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=h.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&h.force&&Dt(this.dom,h.key,h.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,r=!1;for(let h of e){let d=this.readMutation(h);d&&(d.typeOver&&(r=!0),t==-1?{from:t,to:n}=d:(t=Math.min(d.from,t),n=Math.max(d.to,n)))}return{from:t,to:n,typeOver:r}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),r=this.selectionChanged&&et(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let h=new fs(this.view,e,t,n);return this.view.docView.domChanged={newSel:h.newSel?h.newSel.main:null},h}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,r=Mn(this.view,t);return this.view.state==n&&this.view.update([]),r}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let n=Ji(t,e.previousSibling||e.target.previousSibling,-1),r=Ji(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function Ji(s,e,t){for(;e;){let n=oe.get(e);if(n&&n.parent==s)return n;let r=e.parentNode;e=r!=s.dom?r:t>0?e.nextSibling:e.previousSibling}return null}function Vn(s){let e=null;function t(x){x.preventDefault(),x.stopImmediatePropagation(),e=x.getTargetRanges()[0]}if(s.contentDOM.addEventListener("beforeinput",t,!0),s.dom.ownerDocument.execCommand("indent"),s.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let n=e.startContainer,r=e.startOffset,h=e.endContainer,d=e.endOffset,y=s.docView.domAtPos(s.state.selection.main.anchor);return hi(y.node,y.offset,h,d)&&([n,r,h,d]=[h,d,n,r]),{anchorNode:n,anchorOffset:r,focusNode:h,focusOffset:d}}class ze{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM);let{dispatch:t}=e;this.dispatchTransactions=e.dispatchTransactions||t&&(n=>n.forEach(r=>t(r,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=e.root||Mi(e.parent)||document,this.viewState=new kn(e.state||p.yy.create(e)),e.scrollTo&&e.scrollTo.is(Bi)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(qi).map(n=>new fn(n));for(let n of this.plugins)n.update(this);this.observer=new Hn(this),this.inputState=new Ss(this),this.inputState.ensureHandlers(this.plugins),this.docView=new g(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}dispatch(...e){let t=e.length==1&&e[0]instanceof p.YW?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,r,h=this.state;for(let $ of e){if($.startState!=h)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");h=$.state}if(this.destroyed){this.viewState.state=h;return}let d=this.hasFocus,y=0,x=null;e.some($=>$.annotation(Y))?(this.inputState.notifiedFocused=d,y=1):d!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=d,x=te(h,d),x||(y=1));let C=this.observer.delayedAndroidKey,A=null;if(C?(this.observer.clearDelayedAndroidKey(),A=this.observer.readChange(),(A&&!this.state.doc.eq(h.doc)||!this.state.selection.eq(h.selection))&&(A=null)):this.observer.clear(),h.facet(p.yy.phrases)!=this.state.facet(p.yy.phrases))return this.setState(h);r=z.create(this,h,e),r.flags|=y;let W=this.viewState.scrollTarget;try{this.updateState=2;for(let $ of e){if(W&&(W=W.map($.changes)),$.scrollIntoView){let{main:X}=$.state.selection;W=new Ni(X.empty?X:p.jT.cursor(X.head,X.head>X.anchor?-1:1))}for(let X of $.effects)X.is(Bi)&&(W=X.value.clip(this.state))}this.viewState.update(r,W),this.bidiCache=wr.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),t=this.docView.update(r),this.state.facet(E)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some($=>$.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(gr)!=r.state.facet(gr)&&(this.viewState.mustMeasureContent=!0),(t||n||W||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!r.empty)for(let $ of this.state.facet(Yi))try{$(r)}catch(X){Fi(this.state,X,"update listener")}(x||A)&&Promise.resolve().then(()=>{x&&this.state==x.startState&&this.dispatch(x),A&&!Mn(this,A)&&C.force&&Dt(this.contentDOM,C.key,C.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new kn(e),this.plugins=e.facet(qi).map(n=>new fn(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView=new g(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(qi),n=e.state.facet(qi);if(t!=n){let r=[];for(let h of n){let d=t.indexOf(h);if(d<0)r.push(new fn(h));else{let y=this.plugins[d];y.mustUpdate=e,r.push(y)}}for(let h of this.plugins)h.mustUpdate!=e&&h.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,r=n.scrollTop*this.scaleY,{scrollAnchorPos:h,scrollAnchorHeight:d}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(d=-1),this.viewState.scrollAnchorHeight=-1;try{for(let y=0;;y++){if(d<0)if(Ue(n))h=-1,d=this.viewState.heightMap.height;else{let X=this.viewState.scrollAnchorAt(r);h=X.from,d=X.top}this.updateState=1;let x=this.viewState.measure(this);if(!x&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(y>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let C=[];x&4||([this.measureRequests,C]=[C,this.measureRequests]);let A=C.map(X=>{try{return X.read(this)}catch(ee){return Fi(this.state,ee),Fr}}),W=z.create(this,this.state,[]),$=!1;W.flags|=x,t?t.flags|=x:t=W,this.updateState=2,W.empty||(this.updatePlugins(W),this.inputState.update(W),this.updateAttrs(),$=this.docView.update(W));for(let X=0;X<C.length;X++)if(A[X]!=Fr)try{let ee=C[X];ee.write&&ee.write(A[X],this)}catch(ee){Fi(this.state,ee)}if($&&this.docView.updateSelection(!0),!W.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null;continue}else{let ee=(h<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(h).top)-d;if(ee>1||ee<-1){r=r+ee,n.scrollTop=r/this.scaleY,d=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let y of this.state.facet(Yi))y(t)}get themeClasses(){return ni+" "+(this.state.facet(yr)?hn:mn)+" "+this.state.facet(gr)}updateAttrs(){let e=Sr(this,lr,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(vn)?"true":"false",class:"cm-content",style:`${b.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),Sr(this,Kn,t);let n=this.observer.ignore(()=>{let r=kt(this.contentDOM,this.contentAttrs,t),h=kt(this.dom,this.editorAttrs,e);return r||h});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let r of n.effects)if(r.is(ze.announce)){t&&(this.announceDOM.textContent=""),t=!1;let h=this.announceDOM.appendChild(document.createElement("div"));h.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(E);let e=this.state.facet(ze.cspNonce);Se.V.mount(this.root,this.styleModules.concat(cn).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(n=>n.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return Lr(this,e,Pn(this,e,t,n))}moveByGroup(e,t){return Lr(this,e,Pn(this,e,t,n=>Xn(this,e.head,n)))}moveToLineBoundary(e,t,n=!0){return Br(this,e,t,n)}moveVertically(e,t,n){return Lr(this,e,Yn(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),Gn(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let r=this.state.doc.lineAt(e),h=this.bidiSpans(r),d=h[xn.find(h,e-r.from,-1,t)];return Jt(n,d.dir==j.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(ki)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Nr)return Pr(e.length);let t=this.textDirectionAt(e.from),n;for(let h of this.bidiCache)if(h.from==e.from&&h.dir==t&&(h.fresh||ar(h.isolates,n=u(this,e.from,e.to))))return h.order;n||(n=u(this,e.from,e.to));let r=hr(e.text,t,n);return this.bidiCache.push(new wr(e.from,e.to,t,n,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||b.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{ii(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Bi.of(new Ni(typeof e=="number"?p.jT.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return Bi.of(new Ni(p.jT.cursor(n.from),"start","start",n.top-e,t,!0))}static domEventHandlers(e){return fi.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return fi.define(()=>({}),{eventObservers:e})}static theme(e,t){let n=Se.V.newName(),r=[gr.of(n),E.of(vr(`.${n}`,e))];return t&&t.dark&&r.push(yr.of(!0)),r}static baseTheme(e){return p.Wl.lowest(E.of(vr("."+ni,e,Qn)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),r=n&&oe.get(n)||oe.get(e);return((t=r==null?void 0:r.rootView)===null||t===void 0?void 0:t.view)||null}}ze.styleModule=E,ze.inputHandler=ei,ze.focusChangeEffect=Si,ze.perLineTextDirection=ki,ze.exceptionSink=oi,ze.updateListener=Yi,ze.editable=vn,ze.mouseSelectionStyle=Ri,ze.dragMovesSelection=Pi,ze.clickAddsSelectionRange=Yt,ze.decorations=bn,ze.atomicRanges=R,ze.bidiIsolatedRanges=c,ze.scrollMargins=v,ze.darkTheme=yr,ze.cspNonce=p.r$.define({combine:s=>s.length?s[0]:""}),ze.contentAttributes=Kn,ze.editorAttributes=lr,ze.lineWrapping=ze.contentAttributes.of({class:"cm-lineWrapping"}),ze.announce=p.Py.define();const Nr=4096,Fr={};class wr{constructor(e,t,n,r,h,d){this.from=e,this.to=t,this.dir=n,this.isolates=r,this.fresh=h,this.order=d}static update(e,t){if(t.empty&&!e.some(h=>h.fresh))return e;let n=[],r=e.length?e[e.length-1].dir:j.LTR;for(let h=Math.max(0,e.length-10);h<e.length;h++){let d=e[h];d.dir==r&&!t.touchesRange(d.from,d.to)&&n.push(new wr(t.mapPos(d.from,1),t.mapPos(d.to,-1),d.dir,d.isolates,!1,d.order))}return n}}function Sr(s,e,t){for(let n=s.state.facet(e),r=n.length-1;r>=0;r--){let h=n[r],d=typeof h=="function"?h(s):h;d&&qe(d,t)}return t}const Wr=b.mac?"mac":b.windows?"win":b.linux?"linux":"key";function tn(s,e){const t=s.split(/-(?!$)/);let n=t[t.length-1];n=="Space"&&(n=" ");let r,h,d,y;for(let x=0;x<t.length-1;++x){const C=t[x];if(/^(cmd|meta|m)$/i.test(C))y=!0;else if(/^a(lt)?$/i.test(C))r=!0;else if(/^(c|ctrl|control)$/i.test(C))h=!0;else if(/^s(hift)?$/i.test(C))d=!0;else if(/^mod$/i.test(C))e=="mac"?y=!0:h=!0;else throw new Error("Unrecognized modifier name: "+C)}return r&&(n="Alt-"+n),h&&(n="Ctrl-"+n),y&&(n="Meta-"+n),d&&(n="Shift-"+n),n}function Oe(s,e,t){return e.altKey&&(s="Alt-"+s),e.ctrlKey&&(s="Ctrl-"+s),e.metaKey&&(s="Meta-"+s),t!==!1&&e.shiftKey&&(s="Shift-"+s),s}const di=p.Wl.default(ze.domEventHandlers({keydown(s,e){return ns(Hr(e.state),s,e,"editor")}})),zn=p.r$.define({enables:di}),gn=new WeakMap;function Hr(s){let e=s.facet(zn),t=gn.get(e);return t||gn.set(e,t=no(e.reduce((n,r)=>n.concat(r),[]))),t}function io(s,e,t){return ns(Hr(s.state),e,s,t)}let En=null;const us=4e3;function no(s,e=Wr){let t=Object.create(null),n=Object.create(null),r=(d,y)=>{let x=n[d];if(x==null)n[d]=y;else if(x!=y)throw new Error("Key binding "+d+" is used both as a regular binding and as a multi-stroke prefix")},h=(d,y,x,C,A)=>{var W,$;let X=t[d]||(t[d]=Object.create(null)),ee=y.split(/ (?!$)/).map(de=>tn(de,e));for(let de=1;de<ee.length;de++){let Ke=ee.slice(0,de).join(" ");r(Ke,!0),X[Ke]||(X[Ke]={preventDefault:!0,stopPropagation:!1,run:[mt=>{let $e=En={view:mt,prefix:Ke,scope:d};return setTimeout(()=>{En==$e&&(En=null)},us),!0}]})}let le=ee.join(" ");r(le,!1);let ne=X[le]||(X[le]={preventDefault:!1,stopPropagation:!1,run:(($=(W=X._any)===null||W===void 0?void 0:W.run)===null||$===void 0?void 0:$.slice())||[]});x&&ne.run.push(x),C&&(ne.preventDefault=!0),A&&(ne.stopPropagation=!0)};for(let d of s){let y=d.scope?d.scope.split(" "):["editor"];if(d.any)for(let C of y){let A=t[C]||(t[C]=Object.create(null));A._any||(A._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let W in A)A[W].run.push(d.any)}let x=d[e]||d.key;if(x)for(let C of y)h(C,x,d.run,d.preventDefault,d.stopPropagation),d.shift&&h(C,"Shift-"+x,d.shift,d.preventDefault,d.stopPropagation)}return t}function ns(s,e,t,n){let r=ht(e),h=(0,p.gm)(r,0),d=(0,p.nZ)(h)==r.length&&r!=" ",y="",x=!1,C=!1,A=!1;En&&En.view==t&&En.scope==n&&(y=En.prefix+" ",Cs.indexOf(e.keyCode)<0&&(C=!0,En=null));let W=new Set,$=ne=>{if(ne){for(let de of ne.run)if(!W.has(de)&&(W.add(de),de(t,e)))return ne.stopPropagation&&(A=!0),!0;ne.preventDefault&&(ne.stopPropagation&&(A=!0),C=!0)}return!1},X=s[n],ee,le;return X&&($(X[y+Oe(r,e,!d)])?x=!0:d&&(e.altKey||e.metaKey||e.ctrlKey)&&!(b.windows&&e.ctrlKey&&e.altKey)&&(ee=ue[e.keyCode])&&ee!=r?($(X[y+Oe(ee,e,!0)])||e.shiftKey&&(le=L[e.keyCode])!=r&&le!=ee&&$(X[y+Oe(le,e,!1)]))&&(x=!0):d&&e.shiftKey&&$(X[y+Oe(r,e,!0)])&&(x=!0),!x&&$(X._any)&&(x=!0)),C&&(x=!0),x&&A&&e.stopPropagation(),x}class Ii{constructor(e,t,n,r,h){this.className=e,this.left=t,this.top=n,this.width=r,this.height=h}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let r=e.coordsAtPos(n.head,n.assoc||1);if(!r)return[];let h=$n(e);return[new Ii(t,r.left-h.left,r.top-h.top,null,r.bottom-r.top)]}else return Bs(e,t,n)}}function $n(s){let e=s.scrollDOM.getBoundingClientRect();return{left:(s.textDirection==j.LTR?e.left:e.right-s.scrollDOM.clientWidth*s.scaleX)-s.scrollDOM.scrollLeft*s.scaleX,top:e.top-s.scrollDOM.scrollTop*s.scaleY}}function ds(s,e,t){let n=p.jT.cursor(e);return{from:Math.max(t.from,s.moveToLineBoundary(n,!1,!0).from),to:Math.min(t.to,s.moveToLineBoundary(n,!0,!0).from),type:Xt.Text}}function Bs(s,e,t){if(t.to<=s.viewport.from||t.from>=s.viewport.to)return[];let n=Math.max(t.from,s.viewport.from),r=Math.min(t.to,s.viewport.to),h=s.textDirection==j.LTR,d=s.contentDOM,y=d.getBoundingClientRect(),x=$n(s),C=d.querySelector(".cm-line"),A=C&&window.getComputedStyle(C),W=y.left+(A?parseInt(A.paddingLeft)+Math.min(0,parseInt(A.textIndent)):0),$=y.right-(A?parseInt(A.paddingRight):0),X=fr(s,n),ee=fr(s,r),le=X.type==Xt.Text?X:null,ne=ee.type==Xt.Text?ee:null;if(le&&(s.lineWrapping||X.widgetLineBreaks)&&(le=ds(s,n,le)),ne&&(s.lineWrapping||ee.widgetLineBreaks)&&(ne=ds(s,r,ne)),le&&ne&&le.from==ne.from)return Ke(mt(t.from,t.to,le));{let _e=le?mt(t.from,null,le):$e(X,!1),Ct=ne?mt(null,t.to,ne):$e(ee,!0),Ti=[];return(le||X).to<(ne||ee).from-(le&&ne?1:0)||X.widgetLineBreaks>1&&_e.bottom+s.defaultLineHeight/2<Ct.top?Ti.push(de(W,_e.bottom,$,Ct.top)):_e.bottom<Ct.top&&s.elementAtHeight((_e.bottom+Ct.top)/2).type==Xt.Text&&(_e.bottom=Ct.top=(_e.bottom+Ct.top)/2),Ke(_e).concat(Ti).concat(Ke(Ct))}function de(_e,Ct,Ti,Ui){return new Ii(e,_e-x.left,Ct-x.top-.01,Ti-_e,Ui-Ct+.01)}function Ke({top:_e,bottom:Ct,horizontal:Ti}){let Ui=[];for(let jn=0;jn<Ti.length;jn+=2)Ui.push(de(Ti[jn],_e,Ti[jn+1],Ct));return Ui}function mt(_e,Ct,Ti){let Ui=1e9,jn=-1e9,po=[];function Zo(Kr,kr,ls,Cr,ws){let nr=s.coordsAtPos(Kr,Kr==Ti.to?-2:2),rr=s.coordsAtPos(ls,ls==Ti.from?2:-2);!nr||!rr||(Ui=Math.min(nr.top,rr.top,Ui),jn=Math.max(nr.bottom,rr.bottom,jn),ws==j.LTR?po.push(h&&kr?W:nr.left,h&&Cr?$:rr.right):po.push(!h&&Cr?W:rr.left,!h&&kr?$:nr.right))}let Js=_e!=null?_e:Ti.from,Us=Ct!=null?Ct:Ti.to;for(let Kr of s.visibleRanges)if(Kr.to>Js&&Kr.from<Us)for(let kr=Math.max(Kr.from,Js),ls=Math.min(Kr.to,Us);;){let Cr=s.state.doc.lineAt(kr);for(let ws of s.bidiSpans(Cr)){let nr=ws.from+Cr.from,rr=ws.to+Cr.from;if(nr>=ls)break;rr>kr&&Zo(Math.max(nr,kr),_e==null&&nr<=Js,Math.min(rr,ls),Ct==null&&rr>=Us,ws.dir)}if(kr=Cr.to+1,kr>=ls)break}return po.length==0&&Zo(Js,_e==null,Us,Ct==null,s.textDirection),{top:Ui,bottom:jn,horizontal:po}}function $e(_e,Ct){let Ti=y.top+(Ct?_e.top:_e.bottom);return{top:Ti,bottom:Ti,horizontal:[]}}}function In(s,e){return s.constructor==e.constructor&&s.eq(e)}class Pe{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Ce)!=e.state.facet(Ce)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}setOrder(e){let t=0,n=e.facet(Ce);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,n)=>!In(t,this.drawn[n]))){let t=this.dom.firstChild,n=0;for(let r of e)r.update&&t&&r.constructor&&this.drawn[n].constructor&&r.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(r.draw(),t);for(;t;){let r=t.nextSibling;t.remove(),t=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Ce=p.r$.define();function Ae(s){return[fi.define(e=>new Pe(e,s)),Ce.of(s)]}const Fe=!b.ios,lt=p.r$.define({combine(s){return(0,p.BO)(s,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function It(s={}){return[lt.of(s),An,Ls,Uo,nn.of(!0)]}function bi(s){return s.facet(lt)}function xi(s){return s.startState.facet(lt)!=s.state.facet(lt)}const An=Ae({above:!0,markers(s){let{state:e}=s,t=e.facet(lt),n=[];for(let r of e.selection.ranges){let h=r==e.selection.main;if(r.empty?!h||Fe:t.drawRangeCursor){let d=h?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",y=r.empty?r:p.jT.cursor(r.head,r.head>r.anchor?-1:1);for(let x of Ii.forRange(s,d,y))n.push(x)}}return n},update(s,e){s.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=xi(s);return t&&rs(s.state,e),s.docChanged||s.selectionSet||t},mount(s,e){rs(e.state,s)},class:"cm-cursorLayer"});function rs(s,e){e.style.animationDuration=s.facet(lt).cursorBlinkRate+"ms"}const Ls=Ae({above:!1,markers(s){return s.state.selection.ranges.map(e=>e.empty?[]:Ii.forRange(s,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(s,e){return s.docChanged||s.selectionSet||s.viewportChanged||xi(s)},class:"cm-selectionLayer"}),ps={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};Fe&&(ps[".cm-line"].caretColor="transparent !important");const Uo=p.Wl.highest(ze.theme(ps)),Is=p.Py.define({map(s,e){return s==null?null:e.mapPos(s)}}),Vr=p.QQ.define({create(){return null},update(s,e){return s!=null&&(s=e.changes.mapPos(s)),e.effects.reduce((t,n)=>n.is(Is)?n.value:t,s)}}),Go=fi.fromClass(class{constructor(s){this.view=s,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(s){var e;let t=s.state.field(Vr);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(s.startState.field(Vr)!=t||s.docChanged||s.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:s}=this,e=s.state.field(Vr),t=e!=null&&s.coordsAtPos(e);if(!t)return null;let n=s.scrollDOM.getBoundingClientRect();return{left:t.left-n.left+s.scrollDOM.scrollLeft*s.scaleX,top:t.top-n.top+s.scrollDOM.scrollTop*s.scaleY,height:t.bottom-t.top}}drawCursor(s){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;s?(this.cursor.style.left=s.left/e+"px",this.cursor.style.top=s.top/t+"px",this.cursor.style.height=s.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(s){this.view.state.field(Vr)!=s&&this.view.dispatch({effects:Is.of(s)})}},{eventObservers:{dragover(s){this.setDropPos(this.view.posAtCoords({x:s.clientX,y:s.clientY}))},dragleave(s){(s.target==this.view.contentDOM||!this.view.contentDOM.contains(s.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Xo(){return[Vr,Go]}function zr(s,e,t,n,r){e.lastIndex=0;for(let h=s.iterRange(t,n),d=t,y;!h.next().done;d+=h.value.length)if(!h.lineBreak)for(;y=e.exec(h.value);)r(d+y.index,y)}function ms(s,e){let t=s.visibleRanges;if(t.length==1&&t[0].from==s.viewport.from&&t[0].to==s.viewport.to)return t;let n=[];for(let{from:r,to:h}of t)r=Math.max(s.state.doc.lineAt(r).from,r-e),h=Math.min(s.state.doc.lineAt(h).to,h+e),n.length&&n[n.length-1].to>=r?n[n.length-1].to=h:n.push({from:r,to:h});return n}class ro{constructor(e){const{regexp:t,decoration:n,decorate:r,boundary:h,maxLength:d=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,r)this.addMatch=(y,x,C,A)=>r(A,C,C+y[0].length,y,x);else if(typeof n=="function")this.addMatch=(y,x,C,A)=>{let W=n(y,x,C);W&&A(C,C+y[0].length,W)};else if(n)this.addMatch=(y,x,C,A)=>A(C,C+y[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=h,this.maxLength=d}createDeco(e){let t=new p.f_,n=t.add.bind(t);for(let{from:r,to:h}of ms(e,this.maxLength))zr(e.state.doc,this.regexp,r,h,(d,y)=>this.addMatch(y,e,d,n));return t.finish()}updateDeco(e,t){let n=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((h,d,y,x)=>{x>e.view.viewport.from&&y<e.view.viewport.to&&(n=Math.min(y,n),r=Math.max(x,r))}),e.viewportChanged||r-n>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),n,r):t}updateRange(e,t,n,r){for(let h of e.visibleRanges){let d=Math.max(h.from,n),y=Math.min(h.to,r);if(y>d){let x=e.state.doc.lineAt(d),C=x.to<y?e.state.doc.lineAt(y):x,A=Math.max(h.from,x.from),W=Math.min(h.to,C.to);if(this.boundary){for(;d>x.from;d--)if(this.boundary.test(x.text[d-1-x.from])){A=d;break}for(;y<C.to;y++)if(this.boundary.test(C.text[y-C.from])){W=y;break}}let $=[],X,ee=(le,ne,de)=>$.push(de.range(le,ne));if(x==C)for(this.regexp.lastIndex=A-x.from;(X=this.regexp.exec(x.text))&&X.index<W-x.from;)this.addMatch(X,e,X.index+x.from,ee);else zr(e.state.doc,this.regexp,A,W,(le,ne)=>this.addMatch(ne,e,le,ee));t=t.update({filterFrom:A,filterTo:W,filter:(le,ne)=>le<A||ne>W,add:$})}}return t}}const ir=/x/.unicode!=null?"gu":"g",so=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,ir),Yo={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Ns=null;function qo(){var s;if(Ns==null&&typeof document!="undefined"&&document.body){let e=document.body.style;Ns=((s=e.tabSize)!==null&&s!==void 0?s:e.MozTabSize)!=null}return Ns||!1}const Fs=p.r$.define({combine(s){let e=(0,p.BO)(s,{render:null,specialChars:so,addSpecialChars:null});return(e.replaceTabs=!qo())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,ir)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,ir)),e}});function Qo(s={}){return[Fs.of(s),vl()]}let _o=null;function vl(){return _o||(_o=fi.fromClass(class{constructor(s){this.view=s,this.decorations=Ge.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(s.state.facet(Fs)),this.decorations=this.decorator.createDeco(s)}makeDecorator(s){return new ro({regexp:s.specialChars,decoration:(e,t,n)=>{let{doc:r}=t.state,h=(0,p.gm)(e[0],0);if(h==9){let d=r.lineAt(n),y=t.state.tabSize,x=(0,p.IS)(d.text,y,n-d.from);return Ge.replace({widget:new bl((y-x%y)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[h]||(this.decorationCache[h]=Ge.replace({widget:new tl(s,h)}))},boundary:s.replaceTabs?void 0:/[^]/})}update(s){let e=s.state.facet(Fs);s.startState.facet(Fs)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(s.view)):this.decorations=this.decorator.updateDeco(s,this.decorations)}},{decorations:s=>s.decorations}))}const el="\u2022";function yo(s){return s>=32?el:s==10?"\u2424":String.fromCharCode(9216+s)}class tl extends Ft{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=yo(this.code),n=e.state.phrase("Control character")+" "+(Yo[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,n,t);if(r)return r;let h=document.createElement("span");return h.textContent=t,h.title=n,h.setAttribute("aria-label",n),h.className="cm-specialChar",h}ignoreEvent(){return!1}}class bl extends Ft{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}const vo=null;function xl(){return[vo,Kn.of(s=>{var e;return((e=s.plugin(vo))===null||e===void 0?void 0:e.attrs)||null})]}function bo(){return il}const xo=Ge.line({class:"cm-activeLine"}),il=fi.fromClass(class{constructor(s){this.decorations=this.getDeco(s)}update(s){(s.docChanged||s.selectionSet)&&(this.decorations=this.getDeco(s.view))}getDeco(s){let e=-1,t=[];for(let n of s.state.selection.ranges){let r=s.lineBlockAt(n.head);r.from>e&&(t.push(xo.range(r.from)),e=r.from)}return Ge.set(t)}},{decorations:s=>s.decorations});class wo extends Ft{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(e){let t=e.firstChild?gt(e.firstChild):[];if(!t.length)return null;let n=window.getComputedStyle(e.parentNode),r=Jt(t[0],n.direction!="rtl"),h=parseInt(n.lineHeight);return r.bottom-r.top>h*1.5?{left:r.left,right:r.right,top:r.top,bottom:r.top+h}:r}ignoreEvent(){return!1}}function So(s){return fi.fromClass(class{constructor(e){this.view=e,this.placeholder=s?Ge.set([Ge.widget({widget:new wo(s),side:1}).range(0)]):Ge.none}get decorations(){return this.view.state.doc.length?Ge.none:this.placeholder}},{decorations:e=>e.decorations})}const ko=2e3;function gs(s,e,t){let n=Math.min(e.line,t.line),r=Math.max(e.line,t.line),h=[];if(e.off>ko||t.off>ko||e.col<0||t.col<0){let d=Math.min(e.off,t.off),y=Math.max(e.off,t.off);for(let x=n;x<=r;x++){let C=s.doc.line(x);C.length<=y&&h.push(p.jT.range(C.from+d,C.to+y))}}else{let d=Math.min(e.col,t.col),y=Math.max(e.col,t.col);for(let x=n;x<=r;x++){let C=s.doc.line(x),A=(0,p.Gz)(C.text,d,s.tabSize,!0);if(A<0)h.push(p.jT.cursor(C.to));else{let W=(0,p.Gz)(C.text,y,s.tabSize);h.push(p.jT.range(C.from+A,C.from+W))}}}return h}function $r(s,e){let t=s.coordsAtPos(s.viewport.from);return t?Math.round(Math.abs((t.left-e)/s.defaultCharacterWidth)):-1}function Ws(s,e){let t=s.posAtCoords({x:e.clientX,y:e.clientY},!1),n=s.state.doc.lineAt(t),r=t-n.from,h=r>ko?-1:r==n.length?$r(s,e.clientX):(0,p.IS)(n.text,s.state.tabSize,t-n.from);return{line:n.number,col:h,off:r}}function Co(s,e){let t=Ws(s,e),n=s.state.selection;return t?{update(r){if(r.docChanged){let h=r.changes.mapPos(r.startState.doc.line(t.line).from),d=r.state.doc.lineAt(h);t={line:d.number,col:t.col,off:Math.min(t.off,d.length)},n=n.map(r.changes)}},get(r,h,d){let y=Ws(s,r);if(!y)return n;let x=gs(s.state,t,y);return x.length?d?p.jT.create(x.concat(n.ranges)):p.jT.create(x):n}}:null}function nl(s){let e=(s==null?void 0:s.eventFilter)||(t=>t.altKey&&t.button==0);return ze.mouseSelectionStyle.of((t,n)=>e(n)?Co(t,n):null)}const oo={Alt:[18,s=>!!s.altKey],Control:[17,s=>!!s.ctrlKey],Shift:[16,s=>!!s.shiftKey],Meta:[91,s=>!!s.metaKey]},Ao={style:"cursor: crosshair"};function To(s={}){let[e,t]=oo[s.key||"Alt"],n=fi.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventObservers:{keydown(r){this.set(r.keyCode==e||t(r))},keyup(r){(r.keyCode==e||!t(r))&&this.set(!1)},mousemove(r){this.set(t(r))}}});return[n,ze.contentAttributes.of(r=>{var h;return!((h=r.plugin(n))===null||h===void 0)&&h.isDown?Ao:null})]}const ys="-10000px";class Mo{constructor(e,t,n){this.facet=t,this.createTooltipView=n,this.input=e.state.facet(t),this.tooltips=this.input.filter(r=>r),this.tooltipViews=this.tooltips.map(n)}update(e,t){var n;let r=e.state.facet(this.facet),h=r.filter(x=>x);if(r===this.input){for(let x of this.tooltipViews)x.update&&x.update(e);return!1}let d=[],y=t?[]:null;for(let x=0;x<h.length;x++){let C=h[x],A=-1;if(C){for(let W=0;W<this.tooltips.length;W++){let $=this.tooltips[W];$&&$.create==C.create&&(A=W)}if(A<0)d[x]=this.createTooltipView(C),y&&(y[x]=!!C.above);else{let W=d[x]=this.tooltipViews[A];y&&(y[x]=t[A]),W.update&&W.update(e)}}}for(let x of this.tooltipViews)d.indexOf(x)<0&&(x.dom.remove(),(n=x.destroy)===null||n===void 0||n.call(x));return t&&(y.forEach((x,C)=>t[C]=x),t.length=y.length),this.input=r,this.tooltips=h,this.tooltipViews=d,!0}}function El(s={}){return Hs.of(s)}function rl(s){let{win:e}=s;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const Hs=p.r$.define({combine:s=>{var e,t,n;return{position:b.ios?"absolute":((e=s.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=s.find(r=>r.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((n=s.find(r=>r.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||rl}}}),lo=new WeakMap,ss=fi.fromClass(class{constructor(s){this.view=s,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=s.state.facet(Hs);this.position=e.position,this.parent=e.parent,this.classes=s.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new Mo(s,ao,t=>this.createTooltip(t)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),s.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let s of this.manager.tooltipViews)this.intersectionObserver.observe(s.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(s){s.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(s,this.above);e&&this.observeIntersection();let t=e||s.geometryChanged,n=s.state.facet(Hs);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;t=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(s){let e=s.create(this.view);if(e.dom.classList.add("cm-tooltip"),s.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=ys,e.dom.style.left="0px",this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var s,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let t of this.manager.tooltipViews)t.dom.remove(),(s=t.destroy)===null||s===void 0||s.call(t);this.parent&&this.container.remove(),(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let s=this.view.dom.getBoundingClientRect(),e=1,t=1,n=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(b.gecko)n=r.offsetParent!=this.container.ownerDocument.body;else if(this.view.scaleX!=1||this.view.scaleY!=1)n=!0;else if(r.style.top==ys&&r.style.left=="0px"){let h=r.getBoundingClientRect();n=Math.abs(h.top+1e4)>1||Math.abs(h.left)>1}}if(n||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(e=r.width/this.parent.offsetWidth,t=r.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:t}=this.view.viewState);return{editor:s,parent:this.parent?this.container.getBoundingClientRect():s,pos:this.manager.tooltips.map((r,h)=>{let d=this.manager.tooltipViews[h];return d.getCoords?d.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(Hs).tooltipSpace(this.view),scaleX:e,scaleY:t,makeAbsolute:n}}writeMeasure(s){var e;if(s.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let y of this.manager.tooltipViews)y.dom.style.position="absolute"}let{editor:t,space:n,scaleX:r,scaleY:h}=s,d=[];for(let y=0;y<this.manager.tooltips.length;y++){let x=this.manager.tooltips[y],C=this.manager.tooltipViews[y],{dom:A}=C,W=s.pos[y],$=s.size[y];if(!W||W.bottom<=Math.max(t.top,n.top)||W.top>=Math.min(t.bottom,n.bottom)||W.right<Math.max(t.left,n.left)-.1||W.left>Math.min(t.right,n.right)+.1){A.style.top=ys;continue}let X=x.arrow?C.dom.querySelector(".cm-tooltip-arrow"):null,ee=X?7:0,le=$.right-$.left,ne=(e=lo.get(C))!==null&&e!==void 0?e:$.bottom-$.top,de=C.offset||ol,Ke=this.view.textDirection==j.LTR,mt=$.width>n.right-n.left?Ke?n.left:n.right-$.width:Ke?Math.min(W.left-(X?14:0)+de.x,n.right-le):Math.max(n.left,W.left-le+(X?14:0)-de.x),$e=this.above[y];!x.strictSide&&($e?W.top-($.bottom-$.top)-de.y<n.top:W.bottom+($.bottom-$.top)+de.y>n.bottom)&&$e==n.bottom-W.bottom>W.top-n.top&&($e=this.above[y]=!$e);let _e=($e?W.top-n.top:n.bottom-W.bottom)-ee;if(_e<ne&&C.resize!==!1){if(_e<this.view.defaultLineHeight){A.style.top=ys;continue}lo.set(C,ne),A.style.height=(ne=_e)/h+"px"}else A.style.height&&(A.style.height="");let Ct=$e?W.top-ne-ee-de.y:W.bottom+ee+de.y,Ti=mt+le;if(C.overlap!==!0)for(let Ui of d)Ui.left<Ti&&Ui.right>mt&&Ui.top<Ct+ne&&Ui.bottom>Ct&&(Ct=$e?Ui.top-ne-2-ee:Ui.bottom+ee+2);if(this.position=="absolute"?(A.style.top=(Ct-s.parent.top)/h+"px",A.style.left=(mt-s.parent.left)/r+"px"):(A.style.top=Ct/h+"px",A.style.left=mt/r+"px"),X){let Ui=W.left+(Ke?de.x:-de.x)-(mt+14-7);X.style.left=Ui/r+"px"}C.overlap!==!0&&d.push({left:mt,top:Ct,right:Ti,bottom:Ct+ne}),A.classList.toggle("cm-tooltip-above",$e),A.classList.toggle("cm-tooltip-below",!$e),C.positioned&&C.positioned(s.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let s of this.manager.tooltipViews)s.dom.style.top=ys}},{eventObservers:{scroll(){this.maybeMeasure()}}}),sl=ze.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),ol={x:0,y:0},ao=p.r$.define({enables:[ss,sl]}),vs=p.r$.define();class Vs{static create(e){return new Vs(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Mo(e,vs,t=>this.createHostedView(t))}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let n of this.manager.tooltipViews){let r=n[e];if(r!==void 0){if(t===void 0)t=r;else if(t!==r)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const ll=ao.compute([vs],s=>{let e=s.facet(vs).filter(t=>t);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.filter(t=>t.end!=null).map(t=>t.end)),create:Vs.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class Eo{constructor(e,t,n,r,h){this.view=e,this.source=t,this.field=n,this.setHover=r,this.hoverTime=h,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,n=e.docView.nearest(t.target);if(!n)return;let r,h=1;if(n instanceof _)r=n.posAtStart;else{if(r=e.posAtCoords(t),r==null)return;let y=e.coordsAtPos(r);if(!y||t.y<y.top||t.y>y.bottom||t.x<y.left-e.defaultCharacterWidth||t.x>y.right+e.defaultCharacterWidth)return;let x=e.bidiSpans(e.state.doc.lineAt(r)).find(A=>A.from<=r&&A.to>=r),C=x&&x.dir==j.RTL?-1:1;h=t.x<y.left?-C:C}let d=this.source(e,r,h);if(d!=null&&d.then){let y=this.pending={pos:r};d.then(x=>{this.pending==y&&(this.pending=null,x&&e.dispatch({effects:this.setHover.of(x)}))},x=>Fi(e.state,x,"hover tooltip"))}else d&&e.dispatch({effects:this.setHover.of(d)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let n=this.active;if(n&&!Do(this.lastMove.target)||this.pending){let{pos:r}=n||this.pending,h=(t=n==null?void 0:n.end)!==null&&t!==void 0?t:r;(r==h?this.view.posAtCoords(this.lastMove)!=r:!Oo(this.view,r,h,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!Do(e.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function Do(s){for(let e=s;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function Oo(s,e,t,n,r,h){let d=s.scrollDOM.getBoundingClientRect(),y=s.documentTop+s.documentPadding.top+s.contentHeight;if(d.left>n||d.right<n||d.top>r||Math.min(d.bottom,y)<r)return!1;let x=s.posAtCoords({x:n,y:r},!1);return x>=e&&x<=t}function al(s,e={}){let t=p.Py.define(),n=p.QQ.define({create(){return null},update(r,h){if(r&&(e.hideOnChange&&(h.docChanged||h.selection)||e.hideOn&&e.hideOn(h,r)))return null;if(r&&h.docChanged){let d=h.changes.mapPos(r.pos,-1,p.gc.TrackDel);if(d==null)return null;let y=Object.assign(Object.create(null),r);y.pos=d,r.end!=null&&(y.end=h.changes.mapPos(r.end)),r=y}for(let d of h.effects)d.is(t)&&(r=d.value),d.is(Sl)&&(r=null);return r},provide:r=>vs.from(r)});return[n,fi.define(r=>new Eo(r,s,n,t,e.hoverTime||300)),ll]}function wl(s,e){let t=s.plugin(ss);if(!t)return null;let n=t.manager.tooltips.indexOf(e);return n<0?null:t.manager.tooltipViews[n]}function hl(s){return s.facet(vs).some(e=>e)}const Sl=p.Py.define(),Dl=null;function Ol(s){let e=s.plugin(ss);e&&e.maybeMeasure()}const Po=p.r$.define({combine(s){let e,t;for(let n of s)e=e||n.topContainer,t=t||n.bottomContainer;return{topContainer:e,bottomContainer:t}}});function kl(s){return s?[Po.of(s)]:[]}function jr(s,e){let t=s.plugin(Zr),n=t?t.specs.indexOf(e):-1;return n>-1?t.panels[n]:null}const Zr=fi.fromClass(class{constructor(s){this.input=s.state.facet(Ro),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(s));let e=s.state.facet(Po);this.top=new bs(s,!0,e.topContainer),this.bottom=new bs(s,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(s){let e=s.state.facet(Po);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new bs(s.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new bs(s.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=s.state.facet(Ro);if(t!=this.input){let n=t.filter(x=>x),r=[],h=[],d=[],y=[];for(let x of n){let C=this.specs.indexOf(x),A;C<0?(A=x(s.view),y.push(A)):(A=this.panels[C],A.update&&A.update(s)),r.push(A),(A.top?h:d).push(A)}this.specs=n,this.panels=r,this.top.sync(h),this.bottom.sync(d);for(let x of y)x.dom.classList.add("cm-panel"),x.mount&&x.mount()}else for(let n of this.panels)n.update&&n.update(s)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:s=>ze.scrollMargins.of(e=>{let t=e.plugin(s);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class bs{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=ho(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=ho(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function ho(s){let e=s.nextSibling;return s.remove(),e}const Ro=p.r$.define({enables:Zr});class Dn extends p.uU{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Dn.prototype.elementClass="",Dn.prototype.toDOM=void 0,Dn.prototype.mapMode=p.gc.TrackBefore,Dn.prototype.startSide=Dn.prototype.endSide=-1,Dn.prototype.point=!0;const os=p.r$.define(),Bo={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>p.Xs.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Hi=p.r$.define();function Cl(s){return[Lo(),Hi.of(Object.assign(Object.assign({},Bo),s))]}const co=p.r$.define({combine:s=>s.some(e=>e)});function Lo(s){let e=[Io];return s&&s.fixed===!1&&e.push(co.of(!0)),e}const Io=fi.fromClass(class{constructor(s){this.view=s,this.prevViewport=s.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=s.state.facet(Hi).map(e=>new fl(s,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!s.state.facet(co),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),s.scrollDOM.insertBefore(this.dom,s.contentDOM)}update(s){if(this.updateGutters(s)){let e=this.prevViewport,t=s.view.viewport,n=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(n<(t.to-t.from)*.8)}s.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(co)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=s.view.viewport}syncGutters(s){let e=this.dom.nextSibling;s&&this.dom.remove();let t=p.Xs.iter(this.view.state.facet(os),this.view.viewport.from),n=[],r=this.gutters.map(h=>new cl(h,this.view.viewport,-this.view.documentPadding.top));for(let h of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(h.type)){let d=!0;for(let y of h.type)if(y.type==Xt.Text&&d){zs(t,n,y.from);for(let x of r)x.line(this.view,y,n);d=!1}else if(y.widget)for(let x of r)x.widget(this.view,y)}else if(h.type==Xt.Text){zs(t,n,h.from);for(let d of r)d.line(this.view,h,n)}else if(h.widget)for(let d of r)d.widget(this.view,h);for(let h of r)h.finish();s&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(s){let e=s.startState.facet(Hi),t=s.state.facet(Hi),n=s.docChanged||s.heightChanged||s.viewportChanged||!p.Xs.eq(s.startState.facet(os),s.state.facet(os),s.view.viewport.from,s.view.viewport.to);if(e==t)for(let r of this.gutters)r.update(s)&&(n=!0);else{n=!0;let r=[];for(let h of t){let d=e.indexOf(h);d<0?r.push(new fl(this.view,h)):(this.gutters[d].update(s),r.push(this.gutters[d]))}for(let h of this.gutters)h.dom.remove(),r.indexOf(h)<0&&h.destroy();for(let h of r)this.dom.appendChild(h.dom);this.gutters=r}return n}destroy(){for(let s of this.gutters)s.destroy();this.dom.remove()}},{provide:s=>ze.scrollMargins.of(e=>{let t=e.plugin(s);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==j.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function No(s){return Array.isArray(s)?s:[s]}function zs(s,e,t){for(;s.value&&s.from<=t;)s.from==t&&e.push(s.value),s.next()}class cl{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=p.Xs.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:r}=this,h=(t.top-this.height)/e.scaleY,d=t.height/e.scaleY;if(this.i==r.elements.length){let y=new Fo(e,d,h,n);r.elements.push(y),r.dom.appendChild(y.dom)}else r.elements[this.i].update(e,d,h,n);this.height=t.bottom,this.i++}line(e,t,n){let r=[];zs(this.cursor,r,t.from),n.length&&(r=r.concat(n));let h=this.gutter.config.lineMarker(e,t,r);h&&r.unshift(h);let d=this.gutter;r.length==0&&!d.config.renderEmptyElements||this.addElement(e,t,r)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t);n&&this.addElement(e,t,[n])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class fl{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,r=>{let h=r.target,d;if(h!=this.dom&&this.dom.contains(h)){for(;h.parentNode!=this.dom;)h=h.parentNode;let x=h.getBoundingClientRect();d=(x.top+x.bottom)/2}else d=r.clientY;let y=e.lineBlockAtHeight(d-e.documentTop);t.domEventHandlers[n](e,y,r)&&r.preventDefault()});this.markers=No(t.markers(e)),t.initialSpacer&&(this.spacer=new Fo(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=No(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let n=e.view.viewport;return!p.Xs.eq(this.markers,t,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class Fo{constructor(e,t,n,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,r)}update(e,t,n,r){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),Wo(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let n="cm-gutterElement",r=this.dom.firstChild;for(let h=0,d=0;;){let y=d,x=h<t.length?t[h++]:null,C=!1;if(x){let A=x.elementClass;A&&(n+=" "+A);for(let W=d;W<this.markers.length;W++)if(this.markers[W].compare(x)){y=W,C=!0;break}}else y=this.markers.length;for(;d<y;){let A=this.markers[d++];if(A.toDOM){A.destroy(r);let W=r.nextSibling;r.remove(),r=W}}if(!x)break;x.toDOM&&(C?r=r.nextSibling:this.dom.insertBefore(x.toDOM(e),r)),C&&d++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}}function Wo(s,e){if(s.length!=e.length)return!1;for(let t=0;t<s.length;t++)if(!s[t].compare(e[t]))return!1;return!0}const fo=p.r$.define(),xs=p.r$.define({combine(s){return(0,p.BO)(s,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let r in t){let h=n[r],d=t[r];n[r]=h?(y,x,C)=>h(y,x,C)||d(y,x,C):d}return n}})}});class Ho extends Dn{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function $s(s,e){return s.state.facet(xs).formatNumber(e,s.state)}const Vo=Hi.compute([xs],s=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(fo)},lineMarker(e,t,n){return n.some(r=>r.toDOM)?null:new Ho($s(e,e.state.doc.lineAt(t.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(xs)!=e.state.facet(xs),initialSpacer(e){return new Ho($s(e,uo(e.state.doc.lines)))},updateSpacer(e,t){let n=$s(t.view,uo(t.view.state.doc.lines));return n==e.number?e:new Ho(n)},domEventHandlers:s.facet(xs).domEventHandlers}));function ul(s={}){return[xs.of(s),Lo(),Vo]}function uo(s){let e=9;for(;e<s;)e=e*10+9;return e}const js=new class extends Dn{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Zs=os.compute(["selection"],s=>{let e=[],t=-1;for(let n of s.selection.ranges){let r=s.doc.lineAt(n.head).from;r>t&&(t=r,e.push(js.range(r)))}return p.Xs.of(e)});function Ks(){return Zs}const zo=new Map;function $o(s){let e=zo.get(s);return e||zo.set(s,e=Ge.mark({attributes:s==="	"?{class:"cm-highlightTab"}:{class:"cm-highlightSpace","data-display":s.replace(/ /g,"\xB7")}})),e}function jo(s){return fi.define(e=>({decorations:s.createDeco(e),update(t){this.decorations=s.updateDeco(t,this.decorations)}}),{decorations:e=>e.decorations})}const dl=jo(new ro({regexp:/\t| +/g,decoration:s=>$o(s[0]),boundary:/\S/}));function Al(){return dl}const pl=jo(new ro({regexp:/\s+$/g,decoration:Ge.mark({class:"cm-trailingSpace"}),boundary:/\S/}));function Tl(){return pl}const ml={HeightMap:nt,HeightOracle:$t,MeasuredHeights:dt,QueryType:we,ChangedRange:M,computeOrder:hr,moveVisually:O}},21649:(yn,Wt,Q)=>{Q.d(Wt,{Jq:()=>Ie,Lj:()=>xt,_b:()=>Ve,i9:()=>Tt,md:()=>L,mp:()=>vt,vj:()=>Je});const p=1024;let Se=0;class ue{constructor(b,D){this.from=b,this.to=D}}class L{constructor(b={}){this.id=Se++,this.perNode=!!b.perNode,this.deserialize=b.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(b){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof b!="function"&&(b=Ie.match(b)),D=>{let I=b(D);return I===void 0?null:[this,I]}}}L.closedBy=new L({deserialize:re=>re.split(" ")}),L.openedBy=new L({deserialize:re=>re.split(" ")}),L.group=new L({deserialize:re=>re.split(" ")}),L.contextHash=new L({perNode:!0}),L.lookAhead=new L({perNode:!0}),L.mounted=new L({perNode:!0});class G{constructor(b,D,I){this.tree=b,this.overlay=D,this.parser=I}static get(b){return b&&b.props&&b.props[L.mounted.id]}}const ke=Object.create(null);class Ie{constructor(b,D,I,N=0){this.name=b,this.props=D,this.id=I,this.flags=N}static define(b){let D=b.props&&b.props.length?Object.create(null):ke,I=(b.top?1:0)|(b.skipped?2:0)|(b.error?4:0)|(b.name==null?8:0),N=new Ie(b.name||"",D,b.id,I);if(b.props){for(let Z of b.props)if(Array.isArray(Z)||(Z=Z(N)),Z){if(Z[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");D[Z[0].id]=Z[1]}}return N}prop(b){return this.props[b.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(b){if(typeof b=="string"){if(this.name==b)return!0;let D=this.prop(L.group);return D?D.indexOf(b)>-1:!1}return this.id==b}static match(b){let D=Object.create(null);for(let I in b)for(let N of I.split(" "))D[N]=b[I];return I=>{for(let N=I.prop(L.group),Z=-1;Z<(N?N.length:0);Z++){let _=D[Z<0?I.name:N[Z]];if(_)return _}}}}Ie.none=new Ie("",Object.create(null),0,8);class xt{constructor(b){this.types=b;for(let D=0;D<b.length;D++)if(b[D].id!=D)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...b){let D=[];for(let I of this.types){let N=null;for(let Z of b){let _=Z(I);_&&(N||(N=Object.assign({},I.props)),N[_[0].id]=_[1])}D.push(N?new Ie(I.name,N,I.id,I.flags):I)}return new xt(D)}}const ht=new WeakMap,wt=new WeakMap;var Je;(function(re){re[re.ExcludeBuffers=1]="ExcludeBuffers",re[re.IncludeAnonymous=2]="IncludeAnonymous",re[re.IgnoreMounts=4]="IgnoreMounts",re[re.IgnoreOverlays=8]="IgnoreOverlays"})(Je||(Je={}));class vt{constructor(b,D,I,N,Z){if(this.type=b,this.children=D,this.positions=I,this.length=N,this.props=null,Z&&Z.length){this.props=Object.create(null);for(let[_,ce]of Z)this.props[typeof _=="number"?_:_.id]=ce}}toString(){let b=G.get(this);if(b&&!b.overlay)return b.tree.toString();let D="";for(let I of this.children){let N=I.toString();N&&(D&&(D+=","),D+=N)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(D.length?"("+D+")":""):D}cursor(b=0){return new ct(this.topNode,b)}cursorAt(b,D=0,I=0){let N=ht.get(this)||this.topNode,Z=new ct(N);return Z.moveTo(b,D),ht.set(this,Z._tree),Z}get topNode(){return new ot(this,0,0,null)}resolve(b,D=0){let I=li(ht.get(this)||this.topNode,b,D,!1);return ht.set(this,I),I}resolveInner(b,D=0){let I=li(wt.get(this)||this.topNode,b,D,!0);return wt.set(this,I),I}resolveStack(b,D=0){return ii(this,b,D)}iterate(b){let{enter:D,leave:I,from:N=0,to:Z=this.length}=b,_=b.mode||0,ce=(_&Je.IncludeAnonymous)>0;for(let ye=this.cursor(_|Je.IncludeAnonymous);;){let We=!1;if(ye.from<=Z&&ye.to>=N&&(!ce&&ye.type.isAnonymous||D(ye)!==!1)){if(ye.firstChild())continue;We=!0}for(;We&&I&&(ce||!ye.type.isAnonymous)&&I(ye),!ye.nextSibling();){if(!ye.parent())return;We=!0}}}prop(b){return b.perNode?this.props?this.props[b.id]:void 0:this.type.prop(b)}get propValues(){let b=[];if(this.props)for(let D in this.props)b.push([+D,this.props[D]]);return b}balance(b={}){return this.children.length<=8?this:wi(Ie.none,this.children,this.positions,0,this.children.length,0,this.length,(D,I,N)=>new vt(this.type,D,I,N,this.propValues),b.makeTree||((D,I,N)=>new vt(Ie.none,D,I,N)))}static build(b){return Dt(b)}}vt.empty=new vt(Ie.none,[],[],0);class et{constructor(b,D){this.buffer=b,this.index=D}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new et(this.buffer,this.index)}}class gt{constructor(b,D,I){this.buffer=b,this.length=D,this.set=I}get type(){return Ie.none}toString(){let b=[];for(let D=0;D<this.buffer.length;)b.push(this.childString(D)),D=this.buffer[D+3];return b.join(",")}childString(b){let D=this.buffer[b],I=this.buffer[b+3],N=this.set.types[D],Z=N.name;if(/\W/.test(Z)&&!N.isError&&(Z=JSON.stringify(Z)),b+=4,I==b)return Z;let _=[];for(;b<I;)_.push(this.childString(b)),b=this.buffer[b+3];return Z+"("+_.join(",")+")"}findChild(b,D,I,N,Z){let{buffer:_}=this,ce=-1;for(let ye=b;ye!=D&&!(hi(Z,N,_[ye+1],_[ye+2])&&(ce=ye,I>0));ye=_[ye+3]);return ce}slice(b,D,I){let N=this.buffer,Z=new Uint16Array(D-b),_=0;for(let ce=b,ye=0;ce<D;){Z[ye++]=N[ce++],Z[ye++]=N[ce++]-I;let We=Z[ye++]=N[ce++]-I;Z[ye++]=N[ce++]-b,_=Math.max(_,We)}return new gt(Z,_,this.set)}}function hi(re,b,D,I){switch(re){case-2:return D<b;case-1:return I>=b&&D<b;case 0:return D<b&&I>b;case 1:return D<=b&&I>b;case 2:return I>b;case 4:return!0}}function li(re,b,D,I){for(var N;re.from==re.to||(D<1?re.from>=b:re.from>b)||(D>-1?re.to<=b:re.to<b);){let _=!I&&re instanceof ot&&re.index<0?null:re.parent;if(!_)return re;re=_}let Z=I?0:Je.IgnoreOverlays;if(I)for(let _=re,ce=_.parent;ce;_=ce,ce=_.parent)_ instanceof ot&&_.index<0&&((N=ce.enter(b,D,Z))===null||N===void 0?void 0:N.from)!=_.from&&(re=ce);for(;;){let _=re.enter(b,D,Z);if(!_)return re;re=_}}class ge{cursor(b=0){return new ct(this,b)}getChild(b,D=null,I=null){let N=Jt(this,b,D,I);return N.length?N[0]:null}getChildren(b,D=null,I=null){return Jt(this,b,D,I)}resolve(b,D=0){return li(this,b,D,!1)}resolveInner(b,D=0){return li(this,b,D,!0)}matchContext(b){return pi(this,b)}enterUnfinishedNodesBefore(b){let D=this.childBefore(b),I=this;for(;D;){let N=D.lastChild;if(!N||N.to!=D.to)break;N.type.isError&&N.from==N.to?(I=D,D=N.prevSibling):D=N}return I}get node(){return this}get next(){return this.parent}}class ot extends ge{constructor(b,D,I,N){super(),this._tree=b,this.from=D,this.index=I,this._parent=N}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(b,D,I,N,Z=0){for(let _=this;;){for(let{children:ce,positions:ye}=_._tree,We=D>0?ce.length:-1;b!=We;b+=D){let Ee=ce[b],Xe=ye[b]+_.from;if(hi(N,I,Xe,Xe+Ee.length)){if(Ee instanceof gt){if(Z&Je.ExcludeBuffers)continue;let qe=Ee.findChild(0,Ee.buffer.length,D,I-Xe,N);if(qe>-1)return new At(new Oi(_,Ee,b,Xe),null,qe)}else if(Z&Je.IncludeAnonymous||!Ee.type.isAnonymous||St(Ee)){let qe;if(!(Z&Je.IgnoreMounts)&&(qe=G.get(Ee))&&!qe.overlay)return new ot(qe.tree,Xe,b,_);let ft=new ot(Ee,Xe,b,_);return Z&Je.IncludeAnonymous||!ft.type.isAnonymous?ft:ft.nextChild(D<0?Ee.children.length-1:0,D,I,N)}}}if(Z&Je.IncludeAnonymous||!_.type.isAnonymous||(_.index>=0?b=_.index+D:b=D<0?-1:_._parent._tree.children.length,_=_._parent,!_))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(b){return this.nextChild(0,1,b,2)}childBefore(b){return this.nextChild(this._tree.children.length-1,-1,b,-2)}enter(b,D,I=0){let N;if(!(I&Je.IgnoreOverlays)&&(N=G.get(this._tree))&&N.overlay){let Z=b-this.from;for(let{from:_,to:ce}of N.overlay)if((D>0?_<=Z:_<Z)&&(D<0?ce>=Z:ce>Z))return new ot(N.tree,N.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,b,D,I)}nextSignificantParent(){let b=this;for(;b.type.isAnonymous&&b._parent;)b=b._parent;return b}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Jt(re,b,D,I){let N=re.cursor(),Z=[];if(!N.firstChild())return Z;if(D!=null){for(;!N.type.is(D);)if(!N.nextSibling())return Z}for(;;){if(I!=null&&N.type.is(I))return Z;if(N.type.is(b)&&Z.push(N.node),!N.nextSibling())return I==null?Z:[]}}function pi(re,b,D=b.length-1){for(let I=re.parent;D>=0;I=I.parent){if(!I)return!1;if(!I.type.isAnonymous){if(b[D]&&b[D]!=I.name)return!1;D--}}return!0}class Oi{constructor(b,D,I,N){this.parent=b,this.buffer=D,this.index=I,this.start=N}}class At extends ge{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(b,D,I){super(),this.context=b,this._parent=D,this.index=I,this.type=b.buffer.set.types[b.buffer.buffer[I]]}child(b,D,I){let{buffer:N}=this.context,Z=N.findChild(this.index+4,N.buffer[this.index+3],b,D-this.context.start,I);return Z<0?null:new At(this.context,this,Z)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(b){return this.child(1,b,2)}childBefore(b){return this.child(-1,b,-2)}enter(b,D,I=0){if(I&Je.ExcludeBuffers)return null;let{buffer:N}=this.context,Z=N.findChild(this.index+4,N.buffer[this.index+3],D>0?1:-1,b-this.context.start,D);return Z<0?null:new At(this.context,this,Z)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(b){return this._parent?null:this.context.parent.nextChild(this.context.index+b,b,0,4)}get nextSibling(){let{buffer:b}=this.context,D=b.buffer[this.index+3];return D<(this._parent?b.buffer[this._parent.index+3]:b.buffer.length)?new At(this.context,this._parent,D):this.externalSibling(1)}get prevSibling(){let{buffer:b}=this.context,D=this._parent?this._parent.index+4:0;return this.index==D?this.externalSibling(-1):new At(this.context,this._parent,b.findChild(D,this.index,-1,0,4))}get tree(){return null}toTree(){let b=[],D=[],{buffer:I}=this.context,N=this.index+4,Z=I.buffer[this.index+3];if(Z>N){let _=I.buffer[this.index+1];b.push(I.slice(N,Z,_)),D.push(0)}return new vt(this.type,b,D,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function si(re){if(!re.length)return null;let b=0,D=re[0];for(let Z=1;Z<re.length;Z++){let _=re[Z];(_.from>D.from||_.to<D.to)&&(D=_,b=Z)}let I=D instanceof ot&&D.index<0?null:D.parent,N=re.slice();return I?N[b]=I:N.splice(b,1),new Ut(N,D)}class Ut{constructor(b,D){this.heads=b,this.node=D}get next(){return si(this.heads)}}function ii(re,b,D){let I=re.resolveInner(b,D),N=null;for(let Z=I instanceof ot?I:I.context.parent;Z;Z=Z.parent)if(Z.index<0){let _=Z.parent;(N||(N=[I])).push(_.resolve(b,D)),Z=_}else{let _=G.get(Z.tree);if(_&&_.overlay&&_.overlay[0].from<=b&&_.overlay[_.overlay.length-1].to>=b){let ce=new ot(_.tree,_.overlay[0].from+Z.from,-1,Z);(N||(N=[I])).push(li(ce,b,D,!1))}}return N?si(N):I}class ct{get name(){return this.type.name}constructor(b,D=0){if(this.mode=D,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,b instanceof ot)this.yieldNode(b);else{this._tree=b.context.parent,this.buffer=b.context;for(let I=b._parent;I;I=I._parent)this.stack.unshift(I.index);this.bufferNode=b,this.yieldBuf(b.index)}}yieldNode(b){return b?(this._tree=b,this.type=b.type,this.from=b.from,this.to=b.to,!0):!1}yieldBuf(b,D){this.index=b;let{start:I,buffer:N}=this.buffer;return this.type=D||N.set.types[N.buffer[b]],this.from=I+N.buffer[b+1],this.to=I+N.buffer[b+2],!0}yield(b){return b?b instanceof ot?(this.buffer=null,this.yieldNode(b)):(this.buffer=b.context,this.yieldBuf(b.index,b.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(b,D,I){if(!this.buffer)return this.yield(this._tree.nextChild(b<0?this._tree._tree.children.length-1:0,b,D,I,this.mode));let{buffer:N}=this.buffer,Z=N.findChild(this.index+4,N.buffer[this.index+3],b,D-this.buffer.start,I);return Z<0?!1:(this.stack.push(this.index),this.yieldBuf(Z))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(b){return this.enterChild(1,b,2)}childBefore(b){return this.enterChild(-1,b,-2)}enter(b,D,I=this.mode){return this.buffer?I&Je.ExcludeBuffers?!1:this.enterChild(1,b,D):this.yield(this._tree.enter(b,D,I))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Je.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let b=this.mode&Je.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(b)}sibling(b){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+b,b,0,4,this.mode)):!1;let{buffer:D}=this.buffer,I=this.stack.length-1;if(b<0){let N=I<0?0:this.stack[I]+4;if(this.index!=N)return this.yieldBuf(D.findChild(N,this.index,-1,0,4))}else{let N=D.buffer[this.index+3];if(N<(I<0?D.buffer.length:D.buffer[this.stack[I]+3]))return this.yieldBuf(N)}return I<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+b,b,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(b){let D,I,{buffer:N}=this;if(N){if(b>0){if(this.index<N.buffer.buffer.length)return!1}else for(let Z=0;Z<this.index;Z++)if(N.buffer.buffer[Z+3]<this.index)return!1;({index:D,parent:I}=N)}else({index:D,_parent:I}=this._tree);for(;I;{index:D,_parent:I}=I)if(D>-1)for(let Z=D+b,_=b<0?-1:I._tree.children.length;Z!=_;Z+=b){let ce=I._tree.children[Z];if(this.mode&Je.IncludeAnonymous||ce instanceof gt||!ce.type.isAnonymous||St(ce))return!1}return!0}move(b,D){if(D&&this.enterChild(b,0,4))return!0;for(;;){if(this.sibling(b))return!0;if(this.atLastNode(b)||!this.parent())return!1}}next(b=!0){return this.move(1,b)}prev(b=!0){return this.move(-1,b)}moveTo(b,D=0){for(;(this.from==this.to||(D<1?this.from>=b:this.from>b)||(D>-1?this.to<=b:this.to<b))&&this.parent(););for(;this.enterChild(1,b,D););return this}get node(){if(!this.buffer)return this._tree;let b=this.bufferNode,D=null,I=0;if(b&&b.context==this.buffer){e:for(let N=this.index,Z=this.stack.length;Z>=0;){for(let _=b;_;_=_._parent)if(_.index==N){if(N==this.index)return _;D=_,I=Z+1;break e}N=this.stack[--Z]}}for(let N=I;N<this.stack.length;N++)D=new At(this.buffer,D,this.stack[N]);return this.bufferNode=new At(this.buffer,D,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(b,D){for(let I=0;;){let N=!1;if(this.type.isAnonymous||b(this)!==!1){if(this.firstChild()){I++;continue}this.type.isAnonymous||(N=!0)}for(;N&&D&&D(this),N=this.type.isAnonymous,!this.nextSibling();){if(!I)return;this.parent(),I--,N=!0}}}matchContext(b){if(!this.buffer)return pi(this.node,b);let{buffer:D}=this.buffer,{types:I}=D.set;for(let N=b.length-1,Z=this.stack.length-1;N>=0;Z--){if(Z<0)return pi(this.node,b,N);let _=I[D.buffer[this.stack[Z]]];if(!_.isAnonymous){if(b[N]&&b[N]!=_.name)return!1;N--}}return!0}}function St(re){return re.children.some(b=>b instanceof gt||!b.type.isAnonymous||St(b))}function Dt(re){var b;let{buffer:D,nodeSet:I,maxBufferLength:N=p,reused:Z=[],minRepeatType:_=I.types.length}=re,ce=Array.isArray(D)?new et(D,D.length):D,ye=I.types,We=0,Ee=0;function Xe(Ge,jt,je,yt,ut,Rt){let{id:rt,start:st,end:Vt,size:Qe}=ce,Yt=Ee;for(;Qe<0;)if(ce.next(),Qe==-1){let ei=Z[rt];je.push(ei),yt.push(st-Ge);return}else if(Qe==-3){We=rt;return}else if(Qe==-4){Ee=rt;return}else throw new RangeError(`Unrecognized record size: ${Qe}`);let Pi=ye[rt],Ri,oi,Yi=st-Ge;if(Vt-st<=N&&(oi=Gt(ce.pos-jt,ut))){let ei=new Uint16Array(oi.size-oi.skip),Si=ce.pos-oi.size,ki=ei.length;for(;ce.pos>Si;)ki=Ht(oi.start,ei,ki);Ri=new gt(ei,Vt-oi.start,I),Yi=oi.start-Ge}else{let ei=ce.pos-Qe;ce.next();let Si=[],ki=[],nn=rt>=_?rt:-1,Ni=0,Bi=Vt;for(;ce.pos>ei;)nn>=0&&ce.id==nn&&ce.size>=0?(ce.end<=Bi-N&&(Qt(Si,ki,st,Ni,ce.end,Bi,nn,Yt),Ni=Si.length,Bi=ce.end),ce.next()):Rt>2500?qe(st,ei,Si,ki):Xe(st,ei,Si,ki,nn,Rt+1);if(nn>=0&&Ni>0&&Ni<Si.length&&Qt(Si,ki,st,Ni,st,Bi,nn,Yt),Si.reverse(),ki.reverse(),nn>-1&&Ni>0){let Fi=ft(Pi);Ri=wi(Pi,Si,ki,0,Si.length,0,Vt-st,Fi,Fi)}else Ri=kt(Pi,Si,ki,Vt-st,Yt-Vt)}je.push(Ri),yt.push(Yi)}function qe(Ge,jt,je,yt){let ut=[],Rt=0,rt=-1;for(;ce.pos>jt;){let{id:st,start:Vt,end:Qe,size:Yt}=ce;if(Yt>4)ce.next();else{if(rt>-1&&Vt<rt)break;rt<0&&(rt=Qe-N),ut.push(st,Vt,Qe),Rt++,ce.next()}}if(Rt){let st=new Uint16Array(Rt*4),Vt=ut[ut.length-2];for(let Qe=ut.length-3,Yt=0;Qe>=0;Qe-=3)st[Yt++]=ut[Qe],st[Yt++]=ut[Qe+1]-Vt,st[Yt++]=ut[Qe+2]-Vt,st[Yt++]=Yt;je.push(new gt(st,ut[2]-Vt,I)),yt.push(Vt-Ge)}}function ft(Ge){return(jt,je,yt)=>{let ut=0,Rt=jt.length-1,rt,st;if(Rt>=0&&(rt=jt[Rt])instanceof vt){if(!Rt&&rt.type==Ge&&rt.length==yt)return rt;(st=rt.prop(L.lookAhead))&&(ut=je[Rt]+rt.length+st)}return kt(Ge,jt,je,yt,ut)}}function Qt(Ge,jt,je,yt,ut,Rt,rt,st){let Vt=[],Qe=[];for(;Ge.length>yt;)Vt.push(Ge.pop()),Qe.push(jt.pop()+je-ut);Ge.push(kt(I.types[rt],Vt,Qe,Rt-ut,st-Rt)),jt.push(ut-je)}function kt(Ge,jt,je,yt,ut=0,Rt){if(We){let rt=[L.contextHash,We];Rt=Rt?[rt].concat(Rt):[rt]}if(ut>25){let rt=[L.lookAhead,ut];Rt=Rt?[rt].concat(Rt):[rt]}return new vt(Ge,jt,je,yt,Rt)}function Gt(Ge,jt){let je=ce.fork(),yt=0,ut=0,Rt=0,rt=je.end-N,st={size:0,start:0,skip:0};e:for(let Vt=je.pos-Ge;je.pos>Vt;){let Qe=je.size;if(je.id==jt&&Qe>=0){st.size=yt,st.start=ut,st.skip=Rt,Rt+=4,yt+=4,je.next();continue}let Yt=je.pos-Qe;if(Qe<0||Yt<Vt||je.start<rt)break;let Pi=je.id>=_?4:0,Ri=je.start;for(je.next();je.pos>Yt;){if(je.size<0)if(je.size==-3)Pi+=4;else break e;else je.id>=_&&(Pi+=4);je.next()}ut=Ri,yt+=Qe,Rt+=Pi}return(jt<0||yt==Ge)&&(st.size=yt,st.start=ut,st.skip=Rt),st.size>4?st:void 0}function Ht(Ge,jt,je){let{id:yt,start:ut,end:Rt,size:rt}=ce;if(ce.next(),rt>=0&&yt<_){let st=je;if(rt>4){let Vt=ce.pos-(rt-4);for(;ce.pos>Vt;)je=Ht(Ge,jt,je)}jt[--je]=st,jt[--je]=Rt-Ge,jt[--je]=ut-Ge,jt[--je]=yt}else rt==-3?We=yt:rt==-4&&(Ee=yt);return je}let _t=[],Ft=[];for(;ce.pos>0;)Xe(re.start||0,re.bufferStart||0,_t,Ft,-1,0);let Xt=(b=re.length)!==null&&b!==void 0?b:_t.length?Ft[0]+_t[0].length:0;return new vt(ye[re.topID],_t.reverse(),Ft.reverse(),Xt)}const Mi=new WeakMap;function mi(re,b){if(!re.isAnonymous||b instanceof gt||b.type!=re)return 1;let D=Mi.get(b);if(D==null){D=1;for(let I of b.children){if(I.type!=re||!(I instanceof vt)){D=1;break}D+=mi(re,I)}Mi.set(b,D)}return D}function wi(re,b,D,I,N,Z,_,ce,ye){let We=0;for(let Qt=I;Qt<N;Qt++)We+=mi(re,b[Qt]);let Ee=Math.ceil(We*1.5/8),Xe=[],qe=[];function ft(Qt,kt,Gt,Ht,_t){for(let Ft=Gt;Ft<Ht;){let Xt=Ft,Ge=kt[Ft],jt=mi(re,Qt[Ft]);for(Ft++;Ft<Ht;Ft++){let je=mi(re,Qt[Ft]);if(jt+je>=Ee)break;jt+=je}if(Ft==Xt+1){if(jt>Ee){let je=Qt[Xt];ft(je.children,je.positions,0,je.children.length,kt[Xt]+_t);continue}Xe.push(Qt[Xt])}else{let je=kt[Ft-1]+Qt[Ft-1].length-Ge;Xe.push(wi(re,Qt,kt,Xt,Ft,Ge,je,null,ye))}qe.push(Ge+_t-Z)}}return ft(b,D,I,N,0),(ce||ye)(Xe,qe,_)}class Ue{constructor(){this.map=new WeakMap}setBuffer(b,D,I){let N=this.map.get(b);N||this.map.set(b,N=new Map),N.set(D,I)}getBuffer(b,D){let I=this.map.get(b);return I&&I.get(D)}set(b,D){b instanceof At?this.setBuffer(b.context.buffer,b.index,D):b instanceof ot&&this.map.set(b.tree,D)}get(b){return b instanceof At?this.getBuffer(b.context.buffer,b.index):b instanceof ot?this.map.get(b.tree):void 0}cursorSet(b,D){b.buffer?this.setBuffer(b.buffer.buffer,b.index,D):this.map.set(b.tree,D)}cursorGet(b){return b.buffer?this.getBuffer(b.buffer.buffer,b.index):this.map.get(b.tree)}}class Tt{constructor(b,D,I,N,Z=!1,_=!1){this.from=b,this.to=D,this.tree=I,this.offset=N,this.open=(Z?1:0)|(_?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(b,D=[],I=!1){let N=[new Tt(0,b.length,b,0,!1,I)];for(let Z of D)Z.to>b.length&&N.push(Z);return N}static applyChanges(b,D,I=128){if(!D.length)return b;let N=[],Z=1,_=b.length?b[0]:null;for(let ce=0,ye=0,We=0;;ce++){let Ee=ce<D.length?D[ce]:null,Xe=Ee?Ee.fromA:1e9;if(Xe-ye>=I)for(;_&&_.from<Xe;){let qe=_;if(ye>=qe.from||Xe<=qe.to||We){let ft=Math.max(qe.from,ye)-We,Qt=Math.min(qe.to,Xe)-We;qe=ft>=Qt?null:new Tt(ft,Qt,qe.tree,qe.offset+We,ce>0,!!Ee)}if(qe&&N.push(qe),_.to>Xe)break;_=Z<b.length?b[Z++]:null}if(!Ee)break;ye=Ee.toA,We=Ee.toA-Ee.toB}return N}}class Ve{startParse(b,D,I){return typeof b=="string"&&(b=new oe(b)),I=I?I.length?I.map(N=>new ue(N.from,N.to)):[new ue(0,0)]:[new ue(0,b.length)],this.createParse(b,D||[],I)}parse(b,D,I){let N=this.startParse(b,D,I);for(;;){let Z=N.advance();if(Z)return Z}}}class oe{constructor(b){this.string=b}get length(){return this.string.length}chunk(b){return this.string.slice(b)}get lineChunks(){return!1}read(b,D){return this.string.slice(b,D)}}function Te(re){return(b,D,I,N)=>new Ot(b,re,D,I,N)}class ve{constructor(b,D,I,N,Z){this.parser=b,this.parse=D,this.overlay=I,this.target=N,this.from=Z}}function tt(re){if(!re.length||re.some(b=>b.from>=b.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(re))}class Me{constructor(b,D,I,N,Z,_,ce){this.parser=b,this.predicate=D,this.mounts=I,this.index=N,this.start=Z,this.target=_,this.prev=ce,this.depth=0,this.ranges=[]}}const it=new L({perNode:!0});class Ot{constructor(b,D,I,N,Z){this.nest=D,this.input=I,this.fragments=N,this.ranges=Z,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=b}advance(){if(this.baseParse){let I=this.baseParse.advance();if(!I)return null;if(this.baseParse=null,this.baseTree=I,this.startInner(),this.stoppedAt!=null)for(let N of this.inner)N.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let I=this.baseTree;return this.stoppedAt!=null&&(I=new vt(I.type,I.children,I.positions,I.length,I.propValues.concat([[it,this.stoppedAt]]))),I}let b=this.inner[this.innerDone],D=b.parse.advance();if(D){this.innerDone++;let I=Object.assign(Object.create(null),b.target.props);I[L.mounted.id]=new G(D,b.overlay,b.parser),b.target.props=I}return null}get parsedPos(){if(this.baseParse)return 0;let b=this.input.length;for(let D=this.innerDone;D<this.inner.length;D++)this.inner[D].from<b&&(b=Math.min(b,this.inner[D].parse.parsedPos));return b}stopAt(b){if(this.stoppedAt=b,this.baseParse)this.baseParse.stopAt(b);else for(let D=this.innerDone;D<this.inner.length;D++)this.inner[D].parse.stopAt(b)}startInner(){let b=new Pt(this.fragments),D=null,I=null,N=new ct(new ot(this.baseTree,this.ranges[0].from,0,null),Je.IncludeAnonymous|Je.IgnoreMounts);e:for(let Z,_;;){let ce=!0,ye;if(this.stoppedAt!=null&&N.from>=this.stoppedAt)ce=!1;else if(b.hasNode(N)){if(D){let We=D.mounts.find(Ee=>Ee.frag.from<=N.from&&Ee.frag.to>=N.to&&Ee.mount.overlay);if(We)for(let Ee of We.mount.overlay){let Xe=Ee.from+We.pos,qe=Ee.to+We.pos;Xe>=N.from&&qe<=N.to&&!D.ranges.some(ft=>ft.from<qe&&ft.to>Xe)&&D.ranges.push({from:Xe,to:qe})}}ce=!1}else if(I&&(_=ci(I.ranges,N.from,N.to)))ce=_!=2;else if(!N.type.isAnonymous&&(Z=this.nest(N,this.input))&&(N.from<N.to||!Z.overlay)){N.tree||Lt(N);let We=b.findMounts(N.from,Z.parser);if(typeof Z.overlay=="function")D=new Me(Z.parser,Z.overlay,We,this.inner.length,N.from,N.tree,D);else{let Ee=gi(this.ranges,Z.overlay||(N.from<N.to?[new ue(N.from,N.to)]:[]));Ee.length&&tt(Ee),(Ee.length||!Z.overlay)&&this.inner.push(new ve(Z.parser,Ee.length?Z.parser.startParse(this.input,Xi(We,Ee),Ee):Z.parser.startParse(""),Z.overlay?Z.overlay.map(Xe=>new ue(Xe.from-N.from,Xe.to-N.from)):null,N.tree,Ee.length?Ee[0].from:N.from)),Z.overlay?Ee.length&&(I={ranges:Ee,depth:0,prev:I}):ce=!1}}else D&&(ye=D.predicate(N))&&(ye===!0&&(ye=new ue(N.from,N.to)),ye.from<ye.to&&D.ranges.push(ye));if(ce&&N.firstChild())D&&D.depth++,I&&I.depth++;else for(;!N.nextSibling();){if(!N.parent())break e;if(D&&!--D.depth){let We=gi(this.ranges,D.ranges);We.length&&(tt(We),this.inner.splice(D.index,0,new ve(D.parser,D.parser.startParse(this.input,Xi(D.mounts,We),We),D.ranges.map(Ee=>new ue(Ee.from-D.start,Ee.to-D.start)),D.target,We[0].from))),D=D.prev}I&&!--I.depth&&(I=I.prev)}}}}function ci(re,b,D){for(let I of re){if(I.from>=D)break;if(I.to>b)return I.from<=b&&I.to>=D?2:1}return 0}function Et(re,b,D,I,N,Z){if(b<D){let _=re.buffer[b+1];I.push(re.slice(b,D,_)),N.push(_-Z)}}function Lt(re){let{node:b}=re,D=[];do D.push(re.index),re.parent();while(!re.tree);let I=0,N=re.tree,Z=0;for(;Z=N.positions[I]+re.from,!(Z<=b.from&&Z+N.children[I].length>=b.to);I++);let _=N.children[I],ce=_.buffer,ye=[I];function We(Ee,Xe,qe,ft,Qt,kt){let Gt=D[kt],Ht=[],_t=[];Et(_,Ee,Gt,Ht,_t,ft);let Ft=ce[Gt+1],Xt=ce[Gt+2];ye.push(Ht.length);let Ge=kt?We(Gt+4,ce[Gt+3],_.set.types[ce[Gt]],Ft,Xt-Ft,kt-1):b.toTree();return Ht.push(Ge),_t.push(Ft-ft),Et(_,ce[Gt+3],Xe,Ht,_t,ft),new vt(qe,Ht,_t,Qt)}N.children[I]=We(0,ce.length,Ie.none,0,_.length,D.length-1);for(let Ee of ye){let Xe=re.tree.children[Ee],qe=re.tree.positions[Ee];re.yield(new ot(Xe,qe+re.from,Ee,re._tree))}}class Nt{constructor(b,D){this.offset=D,this.done=!1,this.cursor=b.cursor(Je.IncludeAnonymous|Je.IgnoreMounts)}moveTo(b){let{cursor:D}=this,I=b-this.offset;for(;!this.done&&D.from<I;)D.to>=b&&D.enter(I,1,Je.IgnoreOverlays|Je.ExcludeBuffers)||D.next(!1)||(this.done=!0)}hasNode(b){if(this.moveTo(b.from),!this.done&&this.cursor.from+this.offset==b.from&&this.cursor.tree)for(let D=this.cursor.tree;;){if(D==b.tree)return!0;if(D.children.length&&D.positions[0]==0&&D.children[0]instanceof vt)D=D.children[0];else break}return!1}}class Pt{constructor(b){var D;if(this.fragments=b,this.curTo=0,this.fragI=0,b.length){let I=this.curFrag=b[0];this.curTo=(D=I.tree.prop(it))!==null&&D!==void 0?D:I.to,this.inner=new Nt(I.tree,-I.offset)}else this.curFrag=this.inner=null}hasNode(b){for(;this.curFrag&&b.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=b.from&&this.curTo>=b.to&&this.inner.hasNode(b)}nextFrag(){var b;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let D=this.curFrag=this.fragments[this.fragI];this.curTo=(b=D.tree.prop(it))!==null&&b!==void 0?b:D.to,this.inner=new Nt(D.tree,-D.offset)}}findMounts(b,D){var I;let N=[];if(this.inner){this.inner.cursor.moveTo(b,1);for(let Z=this.inner.cursor.node;Z;Z=Z.parent){let _=(I=Z.tree)===null||I===void 0?void 0:I.prop(L.mounted);if(_&&_.parser==D)for(let ce=this.fragI;ce<this.fragments.length;ce++){let ye=this.fragments[ce];if(ye.from>=Z.to)break;ye.tree==this.curFrag.tree&&N.push({frag:ye,pos:Z.from-ye.offset,mount:_})}}}return N}}function gi(re,b){let D=null,I=b;for(let N=1,Z=0;N<re.length;N++){let _=re[N-1].to,ce=re[N].from;for(;Z<I.length;Z++){let ye=I[Z];if(ye.from>=ce)break;ye.to<=_||(D||(I=D=b.slice()),ye.from<_?(D[Z]=new ue(ye.from,_),ye.to>ce&&D.splice(Z+1,0,new ue(ce,ye.to))):ye.to>ce?D[Z--]=new ue(ce,ye.to):D.splice(Z--,1))}}return I}function Vi(re,b,D,I){let N=0,Z=0,_=!1,ce=!1,ye=-1e9,We=[];for(;;){let Ee=N==re.length?1e9:_?re[N].to:re[N].from,Xe=Z==b.length?1e9:ce?b[Z].to:b[Z].from;if(_!=ce){let qe=Math.max(ye,D),ft=Math.min(Ee,Xe,I);qe<ft&&We.push(new ue(qe,ft))}if(ye=Math.min(Ee,Xe),ye==1e9)break;Ee==ye&&(_?(_=!1,N++):_=!0),Xe==ye&&(ce?(ce=!1,Z++):ce=!0)}return We}function Xi(re,b){let D=[];for(let{pos:I,mount:N,frag:Z}of re){let _=I+(N.overlay?N.overlay[0].from:0),ce=_+N.tree.length,ye=Math.max(Z.from,_),We=Math.min(Z.to,ce);if(N.overlay){let Ee=N.overlay.map(qe=>new ue(qe.from+I,qe.to+I)),Xe=Vi(b,Ee,ye,We);for(let qe=0,ft=ye;;qe++){let Qt=qe==Xe.length,kt=Qt?We:Xe[qe].from;if(kt>ft&&D.push(new Tt(ft,kt,N.tree,-_,Z.from>=ft||Z.openStart,Z.to<=kt||Z.openEnd)),Qt)break;ft=Xe[qe].to}}else D.push(new Tt(ye,We,N.tree,-_,Z.from>=_||Z.openStart,Z.to<=ce||Z.openEnd))}return D}},86253:(yn,Wt,Q)=>{Q.d(Wt,{Gv:()=>xt,QR:()=>Je,bW:()=>et,pJ:()=>Ue});var p=Q(21649);let Se=0;class ue{constructor(oe,Te,ve){this.set=oe,this.base=Te,this.modified=ve,this.id=Se++}static define(oe){if(oe!=null&&oe.base)throw new Error("Can not derive from a modified tag");let Te=new ue([],null,[]);if(Te.set.push(Te),oe)for(let ve of oe.set)Te.set.push(ve);return Te}static defineModifier(){let oe=new G;return Te=>Te.modified.indexOf(oe)>-1?Te:G.get(Te.base||Te,Te.modified.concat(oe).sort((ve,tt)=>ve.id-tt.id))}}let L=0;class G{constructor(){this.instances=[],this.id=L++}static get(oe,Te){if(!Te.length)return oe;let ve=Te[0].instances.find(Ot=>Ot.base==oe&&ke(Te,Ot.modified));if(ve)return ve;let tt=[],Me=new ue(tt,oe,Te);for(let Ot of Te)Ot.instances.push(Me);let it=Ie(Te);for(let Ot of oe.set)if(!Ot.modified.length)for(let ci of it)tt.push(G.get(Ot,ci));return Me}}function ke(Ve,oe){return Ve.length==oe.length&&Ve.every((Te,ve)=>Te==oe[ve])}function Ie(Ve){let oe=[[]];for(let Te=0;Te<Ve.length;Te++)for(let ve=0,tt=oe.length;ve<tt;ve++)oe.push(oe[ve].concat(Ve[Te]));return oe.sort((Te,ve)=>ve.length-Te.length)}function xt(Ve){let oe=Object.create(null);for(let Te in Ve){let ve=Ve[Te];Array.isArray(ve)||(ve=[ve]);for(let tt of Te.split(" "))if(tt){let Me=[],it=2,Ot=tt;for(let Nt=0;;){if(Ot=="..."&&Nt>0&&Nt+3==tt.length){it=1;break}let Pt=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(Ot);if(!Pt)throw new RangeError("Invalid path: "+tt);if(Me.push(Pt[0]=="*"?"":Pt[0][0]=='"'?JSON.parse(Pt[0]):Pt[0]),Nt+=Pt[0].length,Nt==tt.length)break;let gi=tt[Nt++];if(Nt==tt.length&&gi=="!"){it=0;break}if(gi!="/")throw new RangeError("Invalid path: "+tt);Ot=tt.slice(Nt)}let ci=Me.length-1,Et=Me[ci];if(!Et)throw new RangeError("Invalid path: "+tt);let Lt=new wt(ve,it,ci>0?Me.slice(0,ci):null);oe[Et]=Lt.sort(oe[Et])}}return ht.add(oe)}const ht=new p.md;class wt{constructor(oe,Te,ve,tt){this.tags=oe,this.mode=Te,this.context=ve,this.next=tt}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(oe){return!oe||oe.depth<this.depth?(this.next=oe,this):(oe.next=this.sort(oe.next),oe)}get depth(){return this.context?this.context.length:0}}wt.empty=new wt([],2,null);function Je(Ve,oe){let Te=Object.create(null);for(let Me of Ve)if(!Array.isArray(Me.tag))Te[Me.tag.id]=Me.class;else for(let it of Me.tag)Te[it.id]=Me.class;let{scope:ve,all:tt=null}=oe||{};return{style:Me=>{let it=tt;for(let Ot of Me)for(let ci of Ot.set){let Et=Te[ci.id];if(Et){it=it?it+" "+Et:Et;break}}return it},scope:ve}}function vt(Ve,oe){let Te=null;for(let ve of Ve){let tt=ve.style(oe);tt&&(Te=Te?Te+" "+tt:tt)}return Te}function et(Ve,oe,Te,ve=0,tt=Ve.length){let Me=new hi(ve,Array.isArray(oe)?oe:[oe],Te);Me.highlightRange(Ve.cursor(),ve,tt,"",Me.highlighters),Me.flush(tt)}function gt(Ve,oe,Te,ve,tt,Me=0,it=Ve.length){let Ot=Me;function ci(Et,Lt){if(!(Et<=Ot)){for(let Nt=Ve.slice(Ot,Et),Pt=0;;){let gi=Nt.indexOf(`
`,Pt),Vi=gi<0?Nt.length:gi;if(Vi>Pt&&ve(Nt.slice(Pt,Vi),Lt),gi<0)break;tt(),Pt=gi+1}Ot=Et}}et(oe,Te,(Et,Lt,Nt)=>{ci(Et,""),ci(Lt,Nt)},Me,it),ci(it,"")}class hi{constructor(oe,Te,ve){this.at=oe,this.highlighters=Te,this.span=ve,this.class=""}startSpan(oe,Te){Te!=this.class&&(this.flush(oe),oe>this.at&&(this.at=oe),this.class=Te)}flush(oe){oe>this.at&&this.class&&this.span(this.at,oe,this.class)}highlightRange(oe,Te,ve,tt,Me){let{type:it,from:Ot,to:ci}=oe;if(Ot>=ve||ci<=Te)return;it.isTop&&(Me=this.highlighters.filter(gi=>!gi.scope||gi.scope(it)));let Et=tt,Lt=li(oe)||wt.empty,Nt=vt(Me,Lt.tags);if(Nt&&(Et&&(Et+=" "),Et+=Nt,Lt.mode==1&&(tt+=(tt?" ":"")+Nt)),this.startSpan(Math.max(Te,Ot),Et),Lt.opaque)return;let Pt=oe.tree&&oe.tree.prop(p.md.mounted);if(Pt&&Pt.overlay){let gi=oe.node.enter(Pt.overlay[0].from+Ot,1),Vi=this.highlighters.filter(re=>!re.scope||re.scope(Pt.tree.type)),Xi=oe.firstChild();for(let re=0,b=Ot;;re++){let D=re<Pt.overlay.length?Pt.overlay[re]:null,I=D?D.from+Ot:ci,N=Math.max(Te,b),Z=Math.min(ve,I);if(N<Z&&Xi)for(;oe.from<Z&&(this.highlightRange(oe,N,Z,tt,Me),this.startSpan(Math.min(Z,oe.to),Et),!(oe.to>=I||!oe.nextSibling())););if(!D||I>ve)break;b=D.to+Ot,b>Te&&(this.highlightRange(gi.cursor(),Math.max(Te,D.from+Ot),Math.min(ve,b),"",Vi),this.startSpan(Math.min(ve,b),Et))}Xi&&oe.parent()}else if(oe.firstChild()){Pt&&(tt="");do if(!(oe.to<=Te)){if(oe.from>=ve)break;this.highlightRange(oe,Te,ve,tt,Me),this.startSpan(Math.min(ve,oe.to),Et)}while(oe.nextSibling());oe.parent()}}}function li(Ve){let oe=Ve.type.prop(ht);for(;oe&&oe.context&&!Ve.matchContext(oe.context);)oe=oe.next;return oe||null}const ge=ue.define,ot=ge(),Jt=ge(),pi=ge(Jt),Oi=ge(Jt),At=ge(),si=ge(At),Ut=ge(At),ii=ge(),ct=ge(ii),St=ge(),Dt=ge(),Mi=ge(),mi=ge(Mi),wi=ge(),Ue={comment:ot,lineComment:ge(ot),blockComment:ge(ot),docComment:ge(ot),name:Jt,variableName:ge(Jt),typeName:pi,tagName:ge(pi),propertyName:Oi,attributeName:ge(Oi),className:ge(Jt),labelName:ge(Jt),namespace:ge(Jt),macroName:ge(Jt),literal:At,string:si,docString:ge(si),character:ge(si),attributeValue:ge(si),number:Ut,integer:ge(Ut),float:ge(Ut),bool:ge(At),regexp:ge(At),escape:ge(At),color:ge(At),url:ge(At),keyword:St,self:ge(St),null:ge(St),atom:ge(St),unit:ge(St),modifier:ge(St),operatorKeyword:ge(St),controlKeyword:ge(St),definitionKeyword:ge(St),moduleKeyword:ge(St),operator:Dt,derefOperator:ge(Dt),arithmeticOperator:ge(Dt),logicOperator:ge(Dt),bitwiseOperator:ge(Dt),compareOperator:ge(Dt),updateOperator:ge(Dt),definitionOperator:ge(Dt),typeOperator:ge(Dt),controlOperator:ge(Dt),punctuation:Mi,separator:ge(Mi),bracket:mi,angleBracket:ge(mi),squareBracket:ge(mi),paren:ge(mi),brace:ge(mi),content:ii,heading:ct,heading1:ge(ct),heading2:ge(ct),heading3:ge(ct),heading4:ge(ct),heading5:ge(ct),heading6:ge(ct),contentSeparator:ge(ii),list:ge(ii),quote:ge(ii),emphasis:ge(ii),strong:ge(ii),link:ge(ii),monospace:ge(ii),strikethrough:ge(ii),inserted:ge(),deleted:ge(),changed:ge(),invalid:ge(),meta:wi,documentMeta:ge(wi),annotation:ge(wi),processingInstruction:ge(wi),definition:ue.defineModifier(),constant:ue.defineModifier(),function:ue.defineModifier(),standard:ue.defineModifier(),local:ue.defineModifier(),special:ue.defineModifier()},Tt=Je([{tag:Ue.link,class:"tok-link"},{tag:Ue.heading,class:"tok-heading"},{tag:Ue.emphasis,class:"tok-emphasis"},{tag:Ue.strong,class:"tok-strong"},{tag:Ue.keyword,class:"tok-keyword"},{tag:Ue.atom,class:"tok-atom"},{tag:Ue.bool,class:"tok-bool"},{tag:Ue.url,class:"tok-url"},{tag:Ue.labelName,class:"tok-labelName"},{tag:Ue.inserted,class:"tok-inserted"},{tag:Ue.deleted,class:"tok-deleted"},{tag:Ue.literal,class:"tok-literal"},{tag:Ue.string,class:"tok-string"},{tag:Ue.number,class:"tok-number"},{tag:[Ue.regexp,Ue.escape,Ue.special(Ue.string)],class:"tok-string2"},{tag:Ue.variableName,class:"tok-variableName"},{tag:Ue.local(Ue.variableName),class:"tok-variableName tok-local"},{tag:Ue.definition(Ue.variableName),class:"tok-variableName tok-definition"},{tag:Ue.special(Ue.variableName),class:"tok-variableName2"},{tag:Ue.definition(Ue.propertyName),class:"tok-propertyName tok-definition"},{tag:Ue.typeName,class:"tok-typeName"},{tag:Ue.namespace,class:"tok-namespace"},{tag:Ue.className,class:"tok-className"},{tag:Ue.macroName,class:"tok-macroName"},{tag:Ue.propertyName,class:"tok-propertyName"},{tag:Ue.operator,class:"tok-operator"},{tag:Ue.comment,class:"tok-comment"},{tag:Ue.meta,class:"tok-meta"},{tag:Ue.invalid,class:"tok-invalid"},{tag:Ue.punctuation,class:"tok-punctuation"}])},37207:(yn,Wt,Q)=>{Q.d(Wt,{V:()=>G});const p="\u037C",Se=typeof Symbol=="undefined"?"__"+p:Symbol.for(p),ue=typeof Symbol=="undefined"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),L=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};class G{constructor(ht,wt){this.rules=[];let{finish:Je}=wt||{};function vt(gt){return/^@/.test(gt)?[gt]:gt.split(/,\s*/)}function et(gt,hi,li,ge){let ot=[],Jt=/^@(\w+)\b/.exec(gt[0]),pi=Jt&&Jt[1]=="keyframes";if(Jt&&hi==null)return li.push(gt[0]+";");for(let Oi in hi){let At=hi[Oi];if(/&/.test(Oi))et(Oi.split(/,\s*/).map(si=>gt.map(Ut=>si.replace(/&/,Ut))).reduce((si,Ut)=>si.concat(Ut)),At,li);else if(At&&typeof At=="object"){if(!Jt)throw new RangeError("The value of a property ("+Oi+") should be a primitive value.");et(vt(Oi),At,ot,pi)}else At!=null&&ot.push(Oi.replace(/_.*/,"").replace(/[A-Z]/g,si=>"-"+si.toLowerCase())+": "+At+";")}(ot.length||pi)&&li.push((Je&&!Jt&&!ge?gt.map(Je):gt).join(", ")+" {"+ot.join(" ")+"}")}for(let gt in ht)et(vt(gt),ht[gt],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let ht=L[Se]||1;return L[Se]=ht+1,p+ht.toString(36)}static mount(ht,wt,Je){let vt=ht[ue],et=Je&&Je.nonce;vt?et&&vt.setNonce(et):vt=new Ie(ht,et),vt.mount(Array.isArray(wt)?wt:[wt])}}let ke=new Map;class Ie{constructor(ht,wt){let Je=ht.ownerDocument||ht,vt=Je.defaultView;if(!ht.head&&ht.adoptedStyleSheets&&vt.CSSStyleSheet){let et=ke.get(Je);if(et)return ht.adoptedStyleSheets=[et.sheet,...ht.adoptedStyleSheets],ht[ue]=et;this.sheet=new vt.CSSStyleSheet,ht.adoptedStyleSheets=[this.sheet,...ht.adoptedStyleSheets],ke.set(Je,this)}else{this.styleTag=Je.createElement("style"),wt&&this.styleTag.setAttribute("nonce",wt);let et=ht.head||ht;et.insertBefore(this.styleTag,et.firstChild)}this.modules=[],ht[ue]=this}mount(ht){let wt=this.sheet,Je=0,vt=0;for(let et=0;et<ht.length;et++){let gt=ht[et],hi=this.modules.indexOf(gt);if(hi<vt&&hi>-1&&(this.modules.splice(hi,1),vt--,hi=-1),hi==-1){if(this.modules.splice(vt++,0,gt),wt)for(let li=0;li<gt.rules.length;li++)wt.insertRule(gt.rules[li],Je++)}else{for(;vt<hi;)Je+=this.modules[vt++].rules.length;Je+=gt.rules.length,vt++}}if(!wt){let et="";for(let gt=0;gt<this.modules.length;gt++)et+=this.modules[gt].getRules()+`
`;this.styleTag.textContent=et}}setNonce(ht){this.styleTag&&this.styleTag.getAttribute("nonce")!=ht&&this.styleTag.setAttribute("nonce",ht)}}}}]);})();

//# sourceMappingURL=3235.e5598b8d.chunk.js.map